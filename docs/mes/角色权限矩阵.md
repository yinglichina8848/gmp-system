# MES子系统（生产执行系统）角色权限矩阵

## 文档信息
- **版本号**: v1.0.0-draft
- **创建日期**: 2024年
- **审核状态**: 待审核
- **保密级别**: 内部使用

## 目录
- [文档信息](#文档信息)
- [概述](#概述)
  - [文档目的](#文档目的)
  - [术语定义](#术语定义)
- [角色定义](#角色定义)
- [功能权限矩阵](#功能权限矩阵)
- [数据权限矩阵](#数据权限矩阵)
- [权限管理流程](#权限管理流程)
- [权限审计与监控](#权限审计与监控)
- [附录](#附录)
  - [术语定义](#术语定义-1)
  - [参考文档](#参考文档)
  - [联系方式](#联系方式)

## 概述

### 文档目的
本文档定义了MES子系统中各角色的权限矩阵，明确了不同角色对系统功能和数据的访问权限。通过规范化的权限管理，确保系统操作符合GMP要求，保障数据安全和完整性，同时满足最小权限原则。

### 术语定义
- **MES**: 生产执行系统(Manufacturing Execution System)，用于管理药品生产的全生命周期
- **GMP**: 药品生产质量管理规范(Good Manufacturing Practice)，确保药品质量的一系列标准和规范
- **最小权限原则**: 系统设计原则，确保用户只能访问完成其工作所必需的信息和功能
- **权限矩阵**: 描述不同角色对系统功能和数据的访问权限的表格
- **审计追踪**: 记录系统中所有操作的过程，用于合规性和安全管理

## 角色定义

| 角色ID | 角色名称 | 角色描述 |
|-------|---------|----------|
| R001 | 系统管理员 | 负责系统的整体配置、维护和管理，具有最高权限 |
| R002 | 生产主管 | 负责生产任务的下发、监控和审批，管理生产团队 |
| R003 | 操作员 | 执行具体生产工序，记录生产参数和设备状态 |
| R004 | 质量控制员 | 执行过程质量检查，审核批次记录，处理质量偏差 |
| R005 | 设备维护员 | 负责设备的维护、保养和故障处理 |
| R006 | 仓库管理员 | 管理物料的收发、存储和库存监控 |
| R007 | 生产计划员 | 制定生产计划，跟踪生产进度和资源分配 |
| R008 | 质量经理 | 管理质量体系，审批质量相关文档和处理重大质量问题 |
| R009 | 数据分析师 | 负责生产数据的分析和报表生成 |
| R010 | 审计人员 | 负责系统操作的审计和合规性检查 |

## 功能权限矩阵

### 生产订单管理

| 功能 | 系统管理员 | 生产主管 | 操作员 | 质量控制员 | 设备维护员 | 仓库管理员 | 生产计划员 | 质量经理 | 数据分析师 | 审计人员 |
|-----|-----------|---------|-------|-----------|-----------|-----------|-----------|---------|-----------|----------|
| 创建生产订单 | ✔️ | ❌ | ❌ | ❌ | ❌ | ❌ | ✔️ | ❌ | ❌ | ❌ |
| 修改生产订单 | ✔️ | ❌ | ❌ | ❌ | ❌ | ❌ | ✔️ | ❌ | ❌ | ❌ |
| 审批生产订单 | ✔️ | ✔️ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ |
| 下发生产订单 | ✔️ | ✔️ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ |
| 取消生产订单 | ✔️ | ✔️ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ |
| 查看生产订单 | ✔️ | ✔️ | ✔️ | ❌ | ❌ | ✔️ | ✔️ | ❌ | ✔️ | ✔️ |
| 生产订单报表 | ✔️ | ✔️ | ❌ | ❌ | ❌ | ❌ | ✔️ | ❌ | ✔️ | ✔️ |

### 批次执行管理

| 功能 | 系统管理员 | 生产主管 | 操作员 | 质量控制员 | 设备维护员 | 仓库管理员 | 生产计划员 | 质量经理 | 数据分析师 | 审计人员 |
|-----|-----------|---------|-------|-----------|-----------|-----------|-----------|---------|-----------|----------|
| 创建生产批次 | ✔️ | ✔️ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ |
| 启动生产批次 | ✔️ | ✔️ | ✔️ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ |
| 执行工序操作 | ✔️ | ❌ | ✔️ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ |
| 记录生产参数 | ✔️ | ❌ | ✔️ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ |
| 质量检查录入 | ✔️ | ❌ | ✔️ | ✔️ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ |
| 批次异常处理 | ✔️ | ✔️ | ✔️ | ✔️ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ |
| 关闭生产批次 | ✔️ | ✔️ | ❌ | ✔️ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ |
| 审核批次记录 | ✔️ | ✔️ | ❌ | ✔️ | ❌ | ❌ | ❌ | ✔️ | ❌ | ✔️ |
| 查看批次记录 | ✔️ | ✔️ | ✔️ | ✔️ | ❌ | ❌ | ✔️ | ✔️ | ✔️ | ✔️ |

### 设备状态监控

| 功能 | 系统管理员 | 生产主管 | 操作员 | 质量控制员 | 设备维护员 | 仓库管理员 | 生产计划员 | 质量经理 | 数据分析师 | 审计人员 |
|-----|-----------|---------|-------|-----------|-----------|-----------|-----------|---------|-----------|----------|
| 设备参数配置 | ✔️ | ❌ | ❌ | ❌ | ✔️ | ❌ | ❌ | ❌ | ❌ | ❌ |
| 设备状态查看 | ✔️ | ✔️ | ✔️ | ❌ | ✔️ | ❌ | ✔️ | ❌ | ✔️ | ✔️ |
| 设备故障报告 | ✔️ | ✔️ | ✔️ | ❌ | ✔️ | ❌ | ❌ | ❌ | ❌ | ❌ |
| 设备维护记录 | ✔️ | ❌ | ❌ | ❌ | ✔️ | ❌ | ❌ | ❌ | ❌ | ❌ |
| 设备利用率分析 | ✔️ | ✔️ | ❌ | ❌ | ✔️ | ❌ | ✔️ | ❌ | ✔️ | ✔️ |

### 物料追溯管理

| 功能 | 系统管理员 | 生产主管 | 操作员 | 质量控制员 | 设备维护员 | 仓库管理员 | 生产计划员 | 质量经理 | 数据分析师 | 审计人员 |
|-----|-----------|---------|-------|-----------|-----------|-----------|-----------|---------|-----------|----------|
| 物料信息录入 | ✔️ | ❌ | ❌ | ❌ | ❌ | ✔️ | ❌ | ❌ | ❌ | ❌ |
| 物料批次关联 | ✔️ | ❌ | ✔️ | ❌ | ❌ | ✔️ | ❌ | ❌ | ❌ | ❌ |
| 物料消耗记录 | ✔️ | ❌ | ✔️ | ❌ | ❌ | ✔️ | ❌ | ❌ | ❌ | ❌ |
| 物料追溯查询 | ✔️ | ✔️ | ❌ | ✔️ | ❌ | ✔️ | ❌ | ✔️ | ✔️ | ✔️ |
| 物料平衡分析 | ✔️ | ✔️ | ❌ | ✔️ | ❌ | ❌ | ❌ | ✔️ | ✔️ | ✔️ |

### 生产报告管理

| 功能 | 系统管理员 | 生产主管 | 操作员 | 质量控制员 | 设备维护员 | 仓库管理员 | 生产计划员 | 质量经理 | 数据分析师 | 审计人员 |
|-----|-----------|---------|-------|-----------|-----------|-----------|-----------|---------|-----------|----------|
| 生成生产报告 | ✔️ | ✔️ | ❌ | ❌ | ❌ | ❌ | ✔️ | ❌ | ✔️ | ❌ |
| 查看生产报告 | ✔️ | ✔️ | ❌ | ❌ | ❌ | ❌ | ✔️ | ✔️ | ✔️ | ✔️ |
| 导出生产报告 | ✔️ | ✔️ | ❌ | ❌ | ❌ | ❌ | ✔️ | ✔️ | ✔️ | ✔️ |
| 自定义报表 | ✔️ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ✔️ | ❌ |

### 系统管理与配置

| 功能 | 系统管理员 | 生产主管 | 操作员 | 质量控制员 | 设备维护员 | 仓库管理员 | 生产计划员 | 质量经理 | 数据分析师 | 审计人员 |
|-----|-----------|---------|-------|-----------|-----------|-----------|-----------|---------|-----------|----------|
| 用户管理 | ✔️ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ |
| 角色管理 | ✔️ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ |
| 权限配置 | ✔️ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ |
| 系统参数设置 | ✔️ | ❌ | ❌ | ❌ | ✔️ | ❌ | ❌ | ❌ | ❌ | ❌ |
| 审批流程配置 | ✔️ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ✔️ | ❌ | ❌ |
| 审计日志查看 | ✔️ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ✔️ |

## 数据权限矩阵

### 数据访问范围

| 数据类别 | 系统管理员 | 生产主管 | 操作员 | 质量控制员 | 设备维护员 | 仓库管理员 | 生产计划员 | 质量经理 | 数据分析师 | 审计人员 |
|---------|-----------|---------|-------|-----------|-----------|-----------|-----------|---------|-----------|----------|
| 生产订单数据 | ✔️ | ✔️ | 部分 | ❌ | ❌ | 部分 | ✔️ | ❌ | ✔️ | ✔️ |
| 批次记录数据 | ✔️ | ✔️ | 仅自己 | ✔️ | ❌ | ❌ | 部分 | ✔️ | ✔️ | ✔️ |
| 设备状态数据 | ✔️ | ✔️ | 部分 | ❌ | ✔️ | ❌ | 部分 | ❌ | ✔️ | ✔️ |
| 物料追溯数据 | ✔️ | ✔️ | ❌ | ✔️ | ❌ | ✔️ | ❌ | ✔️ | ✔️ | ✔️ |
| 质量检查数据 | ✔️ | 部分 | 仅自己 | ✔️ | ❌ | ❌ | ❌ | ✔️ | ✔️ | ✔️ |
| 生产报告数据 | ✔️ | ✔️ | ❌ | 部分 | ❌ | ❌ | ✔️ | ✔️ | ✔️ | ✔️ |
| 系统配置数据 | ✔️ | ❌ | ❌ | ❌ | 部分 | ❌ | ❌ | 部分 | ❌ | ✔️ |
| 审计日志数据 | ✔️ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ✔️ |

### 数据操作权限

| 操作类型 | 系统管理员 | 生产主管 | 操作员 | 质量控制员 | 设备维护员 | 仓库管理员 | 生产计划员 | 质量经理 | 数据分析师 | 审计人员 |
|---------|-----------|---------|-------|-----------|-----------|-----------|-----------|---------|-----------|----------|
| 创建数据 | ✔️ | 部分 | 部分 | 部分 | 部分 | 部分 | 部分 | 部分 | ❌ | ❌ |
| 读取数据 | ✔️ | 部分 | 部分 | 部分 | 部分 | 部分 | 部分 | 部分 | ✔️ | ✔️ |
| 更新数据 | ✔️ | 部分 | 部分 | 部分 | 部分 | 部分 | 部分 | 部分 | ❌ | ❌ |
| 删除数据 | ✔️ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ |
| 导出数据 | ✔️ | 部分 | ❌ | 部分 | 部分 | 部分 | 部分 | 部分 | ✔️ | ✔️ |
| 打印数据 | ✔️ | 部分 | 部分 | 部分 | 部分 | 部分 | 部分 | 部分 | ✔️ | ✔️ |
| 批量操作 | ✔️ | 部分 | ❌ | 部分 | 部分 | 部分 | 部分 | 部分 | ✔️ | ❌ |

## 权限管理流程

### 1. 权限申请流程
1. **申请发起**：用户向其直接主管提交权限申请表
2. **部门审核**：部门主管审核申请的合理性和必要性
3. **安全审核**：信息安全专员审核权限申请是否符合最小权限原则
4. **系统配置**：系统管理员根据批准的申请在系统中配置相应权限
5. **权限通知**：系统通知用户权限已更新
6. **记录归档**：权限申请和审批记录存档备查

### 2. 权限变更流程
1. **变更申请**：用户或部门主管提出权限变更需求
2. **变更评估**：系统管理员评估变更的影响和必要性
3. **变更审批**：信息安全负责人审批重要权限变更
4. **执行变更**：系统管理员在系统中更新权限配置
5. **变更通知**：相关人员收到权限变更通知
6. **审计记录**：权限变更操作被记录在审计日志中

### 3. 权限定期审查流程
1. **审查计划**：安全团队制定权限审查计划
2. **数据收集**：系统生成当前权限配置报告
3. **权限分析**：分析权限分配是否符合最小权限原则
4. **不合规处理**：识别并标记不合规权限配置
5. **权限调整**：根据审查结果调整权限配置
6. **审查报告**：生成权限审查报告并归档

### 4. 紧急权限授予流程
1. **紧急申请**：部门主管提交紧急权限授予申请
2. **快速审批**：信息安全负责人进行快速审批
3. **临时授权**：系统管理员授予临时权限
4. **权限监控**：加强对临时权限使用的监控
5. **权限回收**：紧急情况结束后及时回收临时权限
6. **事后评审**：对紧急权限授予进行事后评审

## 权限审计与监控

### 审计范围
1. **用户操作审计**：记录用户对系统的所有操作，包括生产记录、参数录入等
2. **权限变更审计**：记录所有权限授予、变更和撤销操作
3. **系统管理审计**：记录系统配置变更和管理操作
4. **异常行为审计**：监控并记录可疑或异常的访问行为

### 监控机制
1. **实时监控**：对关键操作进行实时监控和告警
2. **定期报告**：生成定期权限使用和审计报告
3. **异常检测**：自动检测异常访问模式和可疑行为
4. **合规检查**：定期检查权限配置是否符合GMP和公司政策要求

### 审计要求
1. **不可篡改性**：审计日志应确保不可篡改，保证其完整性和可靠性
2. **保留期限**：审计记录应至少保留5年，满足GMP合规要求
3. **访问控制**：审计日志本身应具有严格的访问控制，防止未授权访问
4. **可追溯性**：审计记录应能够追溯到具体的用户、时间、操作和结果

## 附录

### 术语定义
- **MES**: 生产执行系统(Manufacturing Execution System)，用于管理药品生产的全生命周期
- **GMP**: 药品生产质量管理规范(Good Manufacturing Practice)，确保药品质量的一系列标准和规范
- **批次**: 指在规定条件下，制造或加工的一定数量的产品
- **工序**: 生产过程中一个独立的操作步骤
- **追溯性**: 能够追踪产品、物料或过程的历史、应用情况或位置的能力
- **审计追踪**: 记录系统中所有操作的过程，用于合规性和安全管理
- **最小权限原则**: 系统设计原则，确保用户只能访问完成其工作所必需的信息和功能

### 参考文档
- 《药品生产质量管理规范》(GMP)
- 《数据安全管理规范》
- 《访问控制与权限管理标准》
- [MES总体需求文档](总体需求.md)
- [MES架构设计文档](架构设计.md)
- [MES详细需求文档](详细需求.md)

### 联系方式
- **系统管理员**: [系统管理员姓名] - [邮箱]
- **生产管理部门**: [生产主管姓名] - [邮箱]
- **IT支持**: [IT支持联系人] - [邮箱]