# MES子系统详细需求规格说明书

## 1. 文档信息

- **文档名称**：MES子系统详细需求规格说明书
- **版本**：v1.1.0
- **创建日期**：2023-07-15
- **最后更新**：2025-11-27
- **状态**：审核中
- **作者**：MES需求分析团队

## 2. 引言

### 2.1 文档目的

本文档详细描述了生产执行系统（MES）的功能需求、非功能需求、数据需求和接口需求。文档旨在为开发团队、测试团队和业务用户提供清晰、完整的系统需求说明，作为系统设计、开发、测试和验收的依据。

本文档特别增强了对中药生产特色的支持，包括中药材炮制、提取、干燥等中药特有工艺过程的管理。

### 2.2 术语定义

| 术语 | 解释 |
|------|------|
| MES | 制造执行系统 (Manufacturing Execution System)，用于监控和控制生产过程的信息系统 |
| GMP | 良好生产规范 (Good Manufacturing Practice)，确保产品质量和安全的生产管理规范 |
| BOM | 物料清单 (Bill of Materials)，制造产品所需的原材料、组件和半成品的清单 |
| 批次 | 一次性生产的产品集合，具有相同的生产条件和质量特性 |
| 工单 | 授权执行特定生产任务的文档或电子记录 |
| 工序 | 生产过程中的一个具体操作步骤 |
| 工艺路线 | 产品制造所需的一系列工序及其顺序 |
| OEE | 设备综合效率 (Overall Equipment Efficiency)，衡量设备生产效率的指标 |
| HACCP | 危害分析与关键控制点 (Hazard Analysis and Critical Control Points)，食品安全管理体系 |
| SCADA | 数据采集与监控系统 (Supervisory Control and Data Acquisition)，用于工业过程监控和控制 |
| ERP | 企业资源计划 (Enterprise Resource Planning)，集成企业管理功能的信息系统 |
| 中药炮制 | 按照传统工艺对中药材进行加工处理，以改变药性、增强疗效或降低毒性 |
| 提取工艺 | 利用溶剂将中药材中的有效成分分离出来的工艺过程 |
| 干燥工艺 | 通过加热或其他方式去除物料中水分的工艺过程 |

## 3. 功能需求

### 3.1 生产计划管理

#### 3.1.1 生产订单管理
- **功能描述**：创建、编辑、查询和管理生产订单
- **输入**：订单编码、产品信息、数量、交付日期、优先级等
- **输出**：生产订单记录
- **业务规则**：
  - 生产订单必须包含唯一编码
  - 生产订单状态包括：草稿、已审核、执行中、已完成、已取消
  - 订单取消必须记录原因并审批
  - 中药生产订单需标注药材属性和炮制要求

#### 3.1.2 生产排程
- **功能描述**：根据资源可用性、优先级等因素自动或手动排程生产订单
- **输入**：生产订单、资源信息、约束条件
- **输出**：生产排程计划
- **业务规则**：
  - 支持中药特色工艺的排程优化（如炮制、提取、干燥等）
  - 考虑中药材的季节性供应特点
  - 支持紧急插单处理机制

### 3.2 工艺管理

#### 3.2.1 工艺路线管理
- **功能描述**：定义和管理产品的生产工艺路线
- **输入**：产品信息、工序信息、工艺参数、设备要求
- **输出**：工艺路线定义
- **业务规则**：
  - 支持中药炮制工艺路线定义（净制、切制、炒制、炙制等）
  - 支持中药提取工艺路线定义（煎煮、回流、渗漉、超声等）
  - 支持中药干燥工艺路线定义（晒干、阴干、烘干、冷冻干燥等）
  - 工艺路线需与质量标准关联

#### 3.2.2 工序管理
- **功能描述**：定义和管理工作工序
- **输入**：工序编码、工序名称、操作描述、标准工时、质量要求
- **输出**：工序定义
- **业务规则**：
  - 支持中药特色工序定义（如酒炙、醋炙、蜜炙、盐炙等炮制工序）
  - 支持中药提取工序定义（如煎煮、浓缩、醇沉等）
  - 支持中药干燥工序定义（如晒干、烘干、阴干等）
  - 工序需关联标准操作程序(SOP)

#### 3.2.3 中药炮制工艺管理
- **功能描述**：专门管理中药材炮制工艺过程
- **输入**：药材信息、炮制方法、辅料信息、工艺参数
- **输出**：炮制工艺定义和执行记录
- **业务规则**：
  - 支持传统炮制方法的数字化管理（清炒、加辅料炒、炙制、煅制等）
  - 支持炮制工艺参数管理（温度、时间、火力、辅料比例等）
  - 支持炮制过程的质量控制点设置
  - 支持炮制效果的评估和记录

#### 3.2.4 中药提取工艺管理
- **功能描述**：管理中药材提取工艺过程
- **输入**：药材信息、提取方法、溶剂信息、工艺参数
- **输出**：提取工艺定义和执行记录
- **业务规则**：
  - 支持多种提取方法管理（煎煮、回流、渗漉、超声、微波等）
  - 支持提取工艺参数管理（温度、压力、时间、溶剂比等）
  - 支持提取过程的质量控制点设置
  - 支持提取液浓缩、醇沉等后续工艺管理

#### 3.2.5 中药干燥工艺管理
- **功能描述**：管理中药材及中间体的干燥工艺过程
- **输入**：物料信息、干燥方法、工艺参数
- **输出**：干燥工艺定义和执行记录
- **业务规则**：
  - 支持多种干燥方法管理（晒干、阴干、烘干、冷冻干燥等）
  - 支持干燥工艺参数管理（温度、湿度、风速、时间等）
  - 支持干燥过程的质量控制点设置
  - 支持干燥效果的评估和记录

### 3.3 生产执行管理

#### 3.3.1 工单执行
- **功能描述**：执行生产工单，记录生产过程数据
- **输入**：工单信息、操作人员、设备信息、物料信息
- **输出**：工单执行记录
- **业务规则**：
  - 支持中药炮制过程的执行记录（火候控制、辅料添加、外观变化等）
  - 支持中药提取过程的执行记录（温度控制、浓度监测、颜色变化等）
  - 支持中药干燥过程的执行记录（温度控制、水分测定、外观变化等）
  - 执行过程需与质量检验结果关联

#### 3.3.2 工序执行
- **功能描述**：执行具体工序，记录工序执行数据
- **输入**：工序信息、操作参数、质量数据
- **输出**：工序执行记录
- **业务规则**：
  - 支持中药特色工序的执行记录
  - 工序执行需符合标准操作程序(SOP)
  - 工序执行数据需实时记录和存储
  - 工序执行异常需及时报警和处理

#### 3.3.3 物料批次管理
- **功能描述**：管理生产过程中的物料批次信息
- **输入**：物料信息、批次号、数量、状态
- **输出**：物料批次记录
- **业务规则**：
  - 支持中药材批次管理（产地、采收期、初加工方式等）
  - 支持炮制后药材批次管理（炮制方法、辅料、炮制时间等）
  - 支持提取中间体批次管理（浓度、体积、固含量等）
  - 物料批次需与质量检验结果关联

#### 3.3.4 在制品管理
- **功能描述**：管理生产过程中的在制品信息
- **输入**：在制品信息、状态、位置、数量
- **输出**：在制品记录
- **业务规则**：
  - 支持中药材在制品管理（净制、切制等中间状态）
  - 支持炮制在制品管理（炒制、炙制等中间状态）
  - 支持提取在制品管理（提取液、浓缩液等中间状态）
  - 在制品状态需实时更新和跟踪

### 3.4 质量管理

#### 3.4.1 质量控制点管理
- **功能描述**：定义和管理生产过程中的质量控制点
- **输入**：控制点信息、质量标准、检测方法
- **输出**：质量控制点定义
- **业务规则**：
  - 支持中药炮制过程质量控制点定义（外观、气味、水分等）
  - 支持中药提取过程质量控制点定义（浓度、密度、pH值等）
  - 支持中药干燥过程质量控制点定义（水分、外观、粉碎度等）
  - 质量控制点需与检验结果关联

#### 3.4.2 质量检验管理
- **功能描述**：管理生产过程中的质量检验活动
- **输入**：检验任务、检验项目、检验结果
- **输出**：质量检验记录
- **业务规则**：
  - 支持中药特色检验项目管理（性状、鉴别、检查、含量测定等）
  - 检验结果需与质量标准进行比对
  - 不合格品需启动偏差处理流程
  - 检验数据需实时记录和存储

#### 3.4.3 不合格品管理
- **功能描述**：管理生产过程中的不合格品
- **输入**：不合格品信息、原因分析、处理措施
- **输出**：不合格品处理记录
- **业务规则**：
  - 不合格品需隔离存放并标识
  - 需进行原因分析并制定纠正措施
  - 处理过程需记录并审批
  - 与质量管理系统(QMS)集成

### 3.5 设备管理

#### 3.5.1 设备状态监控
- **功能描述**：实时监控设备运行状态和性能
- **输入**：设备运行数据、故障信息
- **输出**：设备状态报告、性能分析
- **业务规则**：
  - 设备异常状态必须及时报警
  - 记录设备运行时间和停机时间
  - 支持中药专用设备状态监控（炒药机、提取罐、干燥设备等）

#### 3.5.2 维护计划管理
- **功能描述**：制定和管理设备维护计划
- **输入**：设备信息、维护类型、维护周期、维护内容
- **输出**：维护计划、维护提醒
- **业务规则**：
  - 维护计划必须基于设备使用情况和制造商建议
  - 关键设备必须有预防性维护计划
  - 中药专用设备需制定专项维护计划

#### 3.5.3 维护执行记录
- **功能描述**：记录设备维护活动和结果
- **输入**：维护时间、维护内容、维护人员、更换部件、维护结果
- **输出**：维护记录、设备状态更新
- **业务规则**：
  - 维护记录必须详细记录所有维护活动
  - 维护后设备必须经过验证才能投入使用
  - 中药专用设备维护需符合GMP要求

### 3.6 人员管理

#### 3.6.1 人员主数据管理
- **功能描述**：维护人员基本信息和工作信息
- **输入**：人员ID、姓名、部门、职位、联系方式
- **输出**：人员主数据记录
- **业务规则**：
  - 人员ID必须唯一
  - 关键岗位人员需要记录资质信息
  - 中药炮制等特殊岗位需记录专业技能信息

#### 3.6.2 培训管理
- **功能描述**：记录和管理人员培训情况
- **输入**：培训课程、培训时间、培训结果、有效期
- **输出**：培训记录、资质证书
- **业务规则**：
  - 关键岗位人员必须经过培训并合格
  - 培训记录必须包含详细的培训内容和考核结果
  - 中药炮制等特殊岗位需定期接受技能培训和考核

#### 3.6.3 排班管理
- **功能描述**：管理人员工作排班
- **输入**：人员信息、班次、日期、工作区域
- **输出**：排班表、考勤记录
- **业务规则**：
  - 排班必须考虑人员技能和可用性
  - 关键工序必须有足够的授权人员
  - 中药炮制等特殊工序需安排具备资质的人员

### 3.7 数据采集与分析

#### 3.7.1 实时数据采集
- **功能描述**：采集设备和生产过程的实时数据
- **输入**：设备数据、工艺参数、质量数据
- **输出**：实时数据记录、数据可视化
- **业务规则**：
  - 数据采集频率必须满足监控需求
  - 数据必须包含时间戳和来源标识
  - 中药特色工艺参数需专项采集和记录

#### 3.7.2 数据统计分析
- **功能描述**：对生产数据进行统计和分析
- **输入**：生产数据、分析维度、分析指标
- **输出**：统计报表、分析图表
- **业务规则**：
  - 支持多维度数据钻取和分析
  - 提供趋势分析和对比分析功能
  - 支持中药特色指标的统计分析

#### 3.7.3 报表生成
- **功能描述**：根据需求生成各类报表
- **输入**：报表类型、查询条件、数据范围
- **输出**：标准报表、自定义报表
- **业务规则**：
  - 报表必须符合数据准确性和完整性要求
  - 支持报表导出和共享
  - 支持中药特色报表生成（炮制报表、提取报表等）

## 4. 非功能需求

### 4.1 性能需求

- **响应时间**：普通页面响应时间≤2秒，复杂查询响应时间≤5秒
- **并发用户数**：支持100个并发用户同时操作
- **数据处理能力**：每日可处理10,000条生产记录
- **批处理性能**：夜间批处理任务必须在4小时内完成
- **中药特色性能**：支持中药材大批量数据的快速处理和分析

### 4.2 可用性需求

- **系统可用性**：系统正常运行时间≥99.9%
- **故障恢复时间**：系统故障恢复时间≤1小时
- **数据备份频率**：关键数据每小时备份一次，完整备份每天执行一次
- **灾难恢复**：支持异地备份和灾难恢复
- **中药数据保护**：中药材特有数据的专项保护机制

### 4.3 安全性需求

- **身份认证**：采用基于JWT的身份认证机制，支持多因素认证
- **授权控制**：基于RBAC模型的细粒度权限控制
- **数据加密**：敏感数据传输和存储必须加密
- **审计日志**：记录所有关键操作的详细审计日志
- **安全漏洞管理**：定期进行安全评估和漏洞扫描
- **中药数据安全**：中药材特有数据的安全保护措施

### 4.4 可扩展性需求

- **架构扩展性**：系统架构支持水平扩展
- **模块扩展性**：支持功能模块的独立开发和部署
- **接口扩展性**：提供标准API接口，支持第三方系统集成
- **数据扩展性**：支持数据模型的灵活扩展
- **中药特色扩展**：支持中药材特色功能的灵活扩展

### 4.5 兼容性需求

- **浏览器兼容性**：支持Chrome 90+、Firefox 88+、Safari 14+、Edge 90+
- **操作系统兼容性**：支持Windows、macOS、Linux操作系统
- **数据库兼容性**：支持PostgreSQL 13+
- **中药系统兼容**：与中药材检验子系统、中药质量管理系统等兼容

## 5. 数据需求

### 5.1 数据模型

- **实体关系**：产品、订单、工单、批次、工序、物料、设备、人员、质量记录等
- **主数据管理**：产品主数据、物料主数据、设备主数据、人员主数据
- **事务数据**：生产执行数据、质量检验数据、设备维护数据
- **配置数据**：系统参数、业务规则、权限配置
- **中药特色数据**：中药材信息、炮制工艺数据、提取工艺数据、干燥工艺数据

### 5.2 数据质量要求

- **准确性**：数据必须准确反映实际业务情况
- **完整性**：所有必要的数据字段必须完整
- **一致性**：不同模块和系统之间的数据必须保持一致
- **时效性**：数据必须及时更新和反映最新状态
- **可追溯性**：所有数据变更必须可追溯
- **中药数据要求**：中药材特有数据的专项质量要求

### 5.3 数据存储需求

- **存储容量**：系统初始设计支持5年的数据存储
- **数据归档**：支持历史数据归档和查询
- **存储性能**：满足高并发读写和复杂查询需求
- **中药数据存储**：中药材特有数据的专项存储方案

## 6. 接口需求

### 6.1 内部接口

- **与认证子系统接口**：用户认证、授权、会话管理
- **与其他子系统接口**：数据交换、业务协同
- **与QMS系统接口**：质量事件处理、偏差管理、CAPA跟踪
- **与LIMS系统接口**：检验任务下发、检验结果接收
- **与EDMS系统接口**：文档管理、SOP查阅
- **与WMS系统接口**：物料配送、库存更新
- **与中药材检验子系统接口**：原料检验数据交换、质量标准共享

### 6.2 外部接口

- **与ERP系统接口**：订单同步、库存同步、财务数据交换
- **与设备控制系统接口**：设备数据采集、设备控制指令下发
- **与SCADA系统接口**：实时数据采集、生产监控
- **与质量管理系统接口**：检验数据交换、质量报告生成

### 6.3 接口规范

- **接口类型**：REST API、WebSocket、消息队列
- **数据格式**：JSON、XML
- **安全机制**：API密钥、OAuth2.0、数据加密
- **性能要求**：接口响应时间≤1秒，支持异步调用
- **中药特色接口**：支持中药材特有数据的接口规范

## 7. 验收标准

### 7.1 功能验收标准

- 所有功能需求必须100%实现
- 功能操作符合用户操作习惯和业务流程
- 界面设计符合UI/UX设计规范
- 系统错误处理合理，用户提示友好
- 中药特色功能满足中药材生产管理要求

### 7.2 性能验收标准

- 系统响应时间满足性能需求
- 并发用户数满足业务高峰期需求
- 数据处理能力满足日常业务量需求
- 中药特色性能满足中药材生产业务需求

### 7.3 安全验收标准

- 通过安全漏洞扫描，无高危安全漏洞
- 敏感数据正确加密存储和传输
- 审计日志完整记录所有关键操作
- 中药数据安全符合专项保护要求

### 7.4 GMP合规性验收标准

- 系统符合GMP数据完整性要求
- 支持电子记录和电子签名
- 提供完整的生产批次记录和追溯功能
- 支持数据审计和系统验证
- 中药特色功能符合中药材GMP生产管理要求

## 8. 附录

### 8.1 参考文档

- GMP法规（2010版）
- ISA-95标准
- 中国药品生产质量管理规范
- 企业ERP系统文档
- 设备控制系统接口规范
- 中药材炮制规范
- 中药提取技术规范

### 8.2 版本历史

| 版本 | 修改日期 | 修改内容 | 修改人 |
|------|---------|---------|--------|
| v1.0.0 | 2023-07-15 | 初始版本 | MES需求分析团队 |
| v1.0.0 | 2023-07-20 | 更新功能需求和非功能需求 | MES需求分析团队 |
| v1.1.0 | 2025-11-27 | 增加中药特色生产管理功能 | 系统分析师 |