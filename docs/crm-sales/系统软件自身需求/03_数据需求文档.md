# CRM销售管理子系统数据需求文档

## 1. 引言

### 1.1 文档目的

本文档详细描述CRM销售管理子系统的数据需求，包括数据实体、数据结构、数据关系、数据字典、数据存储和数据处理等方面。该文档为系统设计、数据库设计和数据访问层实现提供重要依据，确保系统能够正确、高效地管理销售业务相关的数据。

### 1.2 术语定义

| 术语 | 解释 |
|------|------|
| CRM | Customer Relationship Management，客户关系管理 |
| GMP | Good Manufacturing Practice，良好生产规范 |
| 数据实体 | 系统中需要管理的业务对象，如客户、销售线索、订单等 |
| 数据属性 | 数据实体的特征描述，如客户的姓名、地址等 |
| 数据关系 | 数据实体之间的关联，如一对多、多对多等 |
| 数据字典 | 对数据元素的定义和描述，包括数据类型、长度、约束等 |
| 数据完整性 | 确保数据的准确性和一致性的机制 |
| 数据安全 | 保护数据免受未授权访问、修改和破坏的措施 |

## 2. 数据实体

### 2.1 核心数据实体

#### 2.1.1 客户（Customer）

- **描述**：与企业有业务往来或潜在业务往来的组织或个人
- **主要属性**：客户ID、客户名称、客户类型、联系人、联系电话、邮箱、地址、客户等级、行业、规模、创建时间、创建人、最后更新时间、状态
- **特殊属性**：客户编码、信用额度、账期、区域、来源渠道、客户标签

#### 2.1.2 联系人（Contact）

- **描述**：客户组织中的具体联系人员
- **主要属性**：联系人ID、客户ID、姓名、职位、联系电话、邮箱、性别、生日、偏好、备注、创建时间、创建人
- **特殊属性**：职位级别、部门、主要负责业务、上次联系时间

#### 2.1.3 销售线索（Lead）

- **描述**：潜在的销售机会，尚未转化为客户
- **主要属性**：线索ID、线索名称、来源渠道、联系人、联系电话、邮箱、线索阶段、潜在价值、负责人、创建时间、最后更新时间、状态
- **特殊属性**：行业、地区、备注、线索来源详情、转化状态

#### 2.1.4 销售机会（Opportunity）

- **描述**：有明确购买意向的客户需求，处于销售流程中的特定阶段
- **主要属性**：机会ID、客户ID、机会名称、产品/服务类型、预计金额、预计成交时间、销售阶段、负责人、创建时间、最后更新时间、状态
- **特殊属性**：竞争对手、成功概率、赢率分析、销售计划、备注

#### 2.1.5 销售报价（Quote）

- **描述**：向客户提供的产品或服务价格方案
- **主要属性**：报价ID、客户ID、机会ID、报价编号、报价日期、有效期、总价、税率、负责人、状态、创建时间
- **特殊属性**：报价详情、折扣信息、审批状态、报价版本

#### 2.1.6 销售订单（Order）

- **描述**：客户正式确认的购买请求，包含产品/服务、数量和价格等信息
- **主要属性**：订单ID、订单编号、客户ID、机会ID、报价ID、订单日期、总金额、税率、交货日期、支付方式、负责人、状态、创建时间
- **特殊属性**：订单明细、物流信息、发票信息、付款状态、审批状态

#### 2.1.7 销售拜访（Visit）

- **描述**：销售团队对客户的实地访问或线上沟通活动
- **主要属性**：拜访ID、客户ID、联系人ID、拜访日期、拜访方式、拜访目的、拜访内容、负责人、创建时间、状态
- **特殊属性**：拜访结果、后续跟进、附件、地点、时长

#### 2.1.8 销售活动（Activity）

- **描述**：销售团队开展的各类销售相关活动，如电话沟通、邮件往来等
- **主要属性**：活动ID、关联对象ID（客户/机会/线索）、活动类型、活动名称、开始时间、结束时间、负责人、状态、内容摘要
- **特殊属性**：优先级、提醒设置、参与人员、附件、结果记录

#### 2.1.9 产品（Product）

- **描述**：企业销售的产品或提供的服务
- **主要属性**：产品ID、产品编码、产品名称、产品类别、规格型号、单位、单价、库存、描述、创建时间、状态
- **特殊属性**：产品图片、详细描述、成本价、售价区间、适用客户群

#### 2.1.10 销售报表（Report）

- **描述**：销售数据的统计和分析结果
- **主要属性**：报表ID、报表名称、报表类型、生成时间、生成人、报表内容、参数设置
- **特殊属性**：数据来源、刷新频率、共享设置、导出格式

### 2.2 辅助数据实体

#### 2.2.1 用户（User）

- **描述**：系统用户，主要是销售团队成员
- **主要属性**：用户ID、用户名、密码、姓名、职位、部门、电话、邮箱、角色ID、状态、创建时间

#### 2.2.2 角色（Role）

- **描述**：用户在系统中的角色，决定权限范围
- **主要属性**：角色ID、角色名称、描述、创建时间

#### 2.2.3 部门（Department）

- **描述**：企业内部的部门结构
- **主要属性**：部门ID、部门名称、上级部门ID、描述、负责人ID

#### 2.2.4 客户类型（CustomerType）

- **描述**：客户的分类，如企业客户、个人客户等
- **主要属性**：类型ID、类型名称、描述

#### 2.2.5 行业（Industry）

- **描述**：客户所在的行业分类
- **主要属性**：行业ID、行业名称、描述

#### 2.2.6 区域（Region）

- **描述**：地理区域划分
- **主要属性**：区域ID、区域名称、父区域ID、描述

#### 2.2.7 销售阶段（SalesStage）

- **描述**：销售流程中的各个阶段
- **主要属性**：阶段ID、阶段名称、阶段顺序、赢率、描述

## 3. 数据关系

### 3.1 实体关系图

```
+-----------+      1:N      +-----------+
|  Customer |---------------|  Contact  |
+-----------+               +-----------+
      |
      | 1:N
      v
+-----------+      1:N      +-----------+
|   Lead    |---------------| Opportunity|
+-----------+               +-----------+
                                |
                                | 1:N
                                v
                     +----------+-----------+
                     |                      |
                     v                      v
              +-----------+          +-----------+
              |   Quote   |----------|   Order   |
              +-----------+          +-----------+
                     |
                     | 1:N
                     v
              +-----------+
              |  OrderItem|--N:1--+  Product   +
              +-----------+       +-----------+

+-----------+      1:N      +-----------+
|   User    |---------------|  Visit    |
+-----------+               +-----------+
      |                          |
      | 1:N                      | N:1
      v                          v
+-----------+               +-----------+
|  Activity |---------------|  Customer |
+-----------+               +-----------+

+-----------+      N:M      +-----------+
|   User    |---------------|   Role    |
+-----------+               +-----------+
      |
      | 1:N
      v
+-----------+
|Department |
+-----------+
```

### 3.2 主要关系说明

- **客户与联系人**：一对多关系，一个客户可以有多个联系人
- **客户与销售机会**：一对多关系，一个客户可以有多个销售机会
- **线索与销售机会**：一对多关系，一个线索可以转化为多个销售机会
- **销售机会与报价**：一对多关系，一个销售机会可以有多个报价
- **报价与订单**：一对多关系，一个报价可以生成多个订单
- **订单与订单明细**：一对多关系，一个订单包含多个订单明细
- **订单明细与产品**：多对一关系，多个订单明细可以对应同一个产品
- **用户与销售拜访**：一对多关系，一个用户可以创建多个销售拜访
- **用户与销售活动**：一对多关系，一个用户可以创建多个销售活动
- **销售拜访与客户**：多对一关系，多个销售拜访可以针对同一个客户
- **销售活动与客户/机会/线索**：多对多关系，销售活动可以关联多个业务对象
- **用户与角色**：多对多关系，一个用户可以有多个角色，一个角色可以分配给多个用户
- **用户与部门**：多对一关系，多个用户可以属于同一个部门

## 4. 数据字典

### 4.1 核心实体数据字典

#### 4.1.1 客户（Customer）

| 字段名 | 数据类型 | 长度 | 约束 | 描述 |
|-------|---------|------|------|------|
| customer_id | VARCHAR | 36 | PRIMARY KEY | 客户唯一标识（UUID） |
| customer_code | VARCHAR | 20 | UNIQUE NOT NULL | 客户编码 |
| customer_name | VARCHAR | 100 | NOT NULL | 客户名称 |
| customer_type | VARCHAR | 20 | NOT NULL | 客户类型（企业/个人） |
| primary_contact_id | VARCHAR | 36 | FOREIGN KEY | 主要联系人ID |
| phone | VARCHAR | 20 | | 联系电话 |
| email | VARCHAR | 100 | | 电子邮箱 |
| address | VARCHAR | 200 | | 详细地址 |
| customer_level | VARCHAR | 20 | | 客户等级（A/B/C/D） |
| industry_id | VARCHAR | 36 | FOREIGN KEY | 行业ID |
| company_size | VARCHAR | 20 | | 公司规模 |
| credit_limit | DECIMAL | 18,2 | | 信用额度 |
| payment_terms | VARCHAR | 50 | | 付款条件 |
| region_id | VARCHAR | 36 | FOREIGN KEY | 区域ID |
| source_channel | VARCHAR | 50 | | 来源渠道 |
| tags | TEXT | | | 客户标签（JSON格式） |
| status | VARCHAR | 20 | NOT NULL | 状态（活跃/停用/潜在） |
| created_by | VARCHAR | 36 | FOREIGN KEY | 创建人ID |
| created_time | DATETIME | | NOT NULL | 创建时间 |
| updated_by | VARCHAR | 36 | FOREIGN KEY | 最后更新人ID |
| updated_time | DATETIME | | NOT NULL | 最后更新时间 |
| description | TEXT | | | 备注说明 |

#### 4.1.2 联系人（Contact）

| 字段名 | 数据类型 | 长度 | 约束 | 描述 |
|-------|---------|------|------|------|
| contact_id | VARCHAR | 36 | PRIMARY KEY | 联系人唯一标识（UUID） |
| customer_id | VARCHAR | 36 | FOREIGN KEY NOT NULL | 所属客户ID |
| name | VARCHAR | 50 | NOT NULL | 联系人姓名 |
| position | VARCHAR | 50 | | 职位 |
| department | VARCHAR | 50 | | 部门 |
| level | VARCHAR | 20 | | 职位级别 |
| phone | VARCHAR | 20 | | 联系电话 |
| mobile | VARCHAR | 20 | | 手机号码 |
| email | VARCHAR | 100 | | 电子邮箱 |
| gender | VARCHAR | 10 | | 性别 |
| birthday | DATE | | | 生日 |
| preferences | TEXT | | | 偏好信息（JSON格式） |
| last_contact_time | DATETIME | | | 上次联系时间 |
| is_primary | BOOLEAN | | | 是否主要联系人 |
| status | VARCHAR | 20 | NOT NULL | 状态（活跃/离职） |
| created_by | VARCHAR | 36 | FOREIGN KEY | 创建人ID |
| created_time | DATETIME | | NOT NULL | 创建时间 |
| updated_by | VARCHAR | 36 | FOREIGN KEY | 最后更新人ID |
| updated_time | DATETIME | | NOT NULL | 最后更新时间 |
| description | TEXT | | | 备注说明 |

#### 4.1.3 销售线索（Lead）

| 字段名 | 数据类型 | 长度 | 约束 | 描述 |
|-------|---------|------|------|------|
| lead_id | VARCHAR | 36 | PRIMARY KEY | 线索唯一标识（UUID） |
| lead_name | VARCHAR | 100 | NOT NULL | 线索名称 |
| source | VARCHAR | 50 | NOT NULL | 线索来源 |
| source_detail | TEXT | | | 来源详情 |
| contact_name | VARCHAR | 50 | | 联系人姓名 |
| phone | VARCHAR | 20 | | 联系电话 |
| email | VARCHAR | 100 | | 电子邮箱 |
| company | VARCHAR | 100 | | 公司名称 |
| industry_id | VARCHAR | 36 | FOREIGN KEY | 行业ID |
| region_id | VARCHAR | 36 | FOREIGN KEY | 区域ID |
| lead_stage | VARCHAR | 20 | NOT NULL | 线索阶段 |
| potential_value | DECIMAL | 18,2 | | 潜在价值 |
| assigned_to | VARCHAR | 36 | FOREIGN KEY | 负责人ID |
| conversion_status | VARCHAR | 20 | | 转化状态 |
| converted_customer_id | VARCHAR | 36 | FOREIGN KEY | 已转化客户ID |
| status | VARCHAR | 20 | NOT NULL | 状态（活跃/已转化/已放弃） |
| created_by | VARCHAR | 36 | FOREIGN KEY | 创建人ID |
| created_time | DATETIME | | NOT NULL | 创建时间 |
| updated_by | VARCHAR | 36 | FOREIGN KEY | 最后更新人ID |
| updated_time | DATETIME | | NOT NULL | 最后更新时间 |
| description | TEXT | | | 备注说明 |

#### 4.1.4 销售机会（Opportunity）

| 字段名 | 数据类型 | 长度 | 约束 | 描述 |
|-------|---------|------|------|------|
| opportunity_id | VARCHAR | 36 | PRIMARY KEY | 机会唯一标识（UUID） |
| opportunity_name | VARCHAR | 100 | NOT NULL | 机会名称 |
| customer_id | VARCHAR | 36 | FOREIGN KEY NOT NULL | 客户ID |
| lead_id | VARCHAR | 36 | FOREIGN KEY | 关联线索ID |
| product_type | VARCHAR | 50 | | 产品/服务类型 |
| estimated_amount | DECIMAL | 18,2 | NOT NULL | 预计金额 |
| expected_close_date | DATE | | | 预计成交日期 |
| sales_stage_id | VARCHAR | 36 | FOREIGN KEY NOT NULL | 销售阶段ID |
| win_probability | INT | | | 赢率（百分比） |
| assigned_to | VARCHAR | 36 | FOREIGN KEY NOT NULL | 负责人ID |
| competitors | TEXT | | | 竞争对手信息（JSON格式） |
| sales_plan | TEXT | | | 销售计划 |
| status | VARCHAR | 20 | NOT NULL | 状态（进行中/赢单/输单） |
| created_by | VARCHAR | 36 | FOREIGN KEY | 创建人ID |
| created_time | DATETIME | | NOT NULL | 创建时间 |
| updated_by | VARCHAR | 36 | FOREIGN KEY | 最后更新人ID |
| updated_time | DATETIME | | NOT NULL | 最后更新时间 |
| description | TEXT | | | 备注说明 |

#### 4.1.5 销售订单（Order）

| 字段名 | 数据类型 | 长度 | 约束 | 描述 |
|-------|---------|------|------|------|
| order_id | VARCHAR | 36 | PRIMARY KEY | 订单唯一标识（UUID） |
| order_number | VARCHAR | 50 | UNIQUE NOT NULL | 订单编号 |
| customer_id | VARCHAR | 36 | FOREIGN KEY NOT NULL | 客户ID |
| opportunity_id | VARCHAR | 36 | FOREIGN KEY | 关联机会ID |
| quote_id | VARCHAR | 36 | FOREIGN KEY | 关联报价ID |
| order_date | DATE | | NOT NULL | 订单日期 |
| total_amount | DECIMAL | 18,2 | NOT NULL | 订单总金额 |
| tax_rate | DECIMAL | 5,2 | | 税率 |
| tax_amount | DECIMAL | 18,2 | | 税额 |
| shipping_address | VARCHAR | 200 | | 收货地址 |
| expected_delivery_date | DATE | | | 预计交货日期 |
| payment_terms | VARCHAR | 50 | | 付款条件 |
| payment_status | VARCHAR | 20 | | 付款状态 |
| order_status | VARCHAR | 20 | NOT NULL | 订单状态（草稿/已提交/已审批/已发货/已完成/已取消） |
| assigned_to | VARCHAR | 36 | FOREIGN KEY | 负责人ID |
| approval_status | VARCHAR | 20 | | 审批状态 |
| created_by | VARCHAR | 36 | FOREIGN KEY | 创建人ID |
| created_time | DATETIME | | NOT NULL | 创建时间 |
| updated_by | VARCHAR | 36 | FOREIGN KEY | 最后更新人ID |
| updated_time | DATETIME | | NOT NULL | 最后更新时间 |
| description | TEXT | | | 备注说明 |

## 5. 数据存储需求

### 5.1 数据库选择

- **主要数据库**：MySQL 8.0+
- **缓存数据库**：Redis 6.0+
- **全文搜索**：Elasticsearch 7.0+（可选）

### 5.2 数据量估算

- **客户数据**：预计初始数据量10,000条，年增长率20%
- **联系人数据**：预计初始数据量20,000条，年增长率25%
- **销售线索**：预计初始数据量5,000条，年增长率50%
- **销售机会**：预计初始数据量3,000条，年增长率40%
- **销售订单**：预计初始数据量10,000条，年增长率30%
- **销售活动**：预计初始数据量20,000条，年增长率60%
- **用户数据**：预计初始数据量200条，年增长率10%

### 5.3 存储策略

- **热数据**：最近1年的数据，存储在主数据库中
- **温数据**：1-3年的数据，存储在主数据库，可考虑分区存储
- **冷数据**：3年以上的数据，考虑归档存储或转移至数据仓库

### 5.4 备份策略

- **全量备份**：每日凌晨进行一次全量备份
- **增量备份**：每6小时进行一次增量备份
- **事务日志备份**：每小时进行一次事务日志备份
- **备份保留期**：
  - 本地备份：保留7天
  - 远程备份：保留30天
  - 归档备份：保留1年

## 6. 数据处理需求

### 6.1 数据输入

- **手动输入**：支持用户通过界面手动录入数据
- **批量导入**：支持Excel/CSV格式的数据批量导入
- **系统集成**：支持与其他系统（如ERP、OA等）的数据集成
- **外部接口**：提供API接口接收外部系统数据

### 6.2 数据处理

- **数据验证**：输入数据的格式、完整性和业务规则验证
- **数据转换**：不同系统间数据格式的转换和映射
- **数据清洗**：重复数据识别和清洗，数据标准化处理
- **数据关联**：实体间数据的关联和关系维护
- **业务逻辑处理**：根据业务规则进行数据计算和处理

### 6.3 数据输出

- **数据查询**：支持多条件组合查询、模糊查询、高级搜索
- **数据报表**：支持各类销售报表的生成和导出
- **数据导出**：支持Excel/CSV/PDF等格式的数据导出
- **数据共享**：支持数据的内部共享和外部共享
- **数据接口**：提供API接口供外部系统获取数据

### 6.4 数据安全

- **数据加密**：敏感数据（如客户联系方式）加密存储
- **访问控制**：基于角色的细粒度数据访问控制
- **操作审计**：关键数据操作的日志记录和审计跟踪
- **数据脱敏**：根据用户权限进行数据脱敏处理
- **传输安全**：数据传输过程中的加密和安全保障

## 7. 数据完整性要求

### 7.1 实体完整性

- 所有实体必须具有唯一标识符（主键）
- 主键值不得为空且必须唯一
- 实体间的引用完整性必须通过外键约束保证

### 7.2 域完整性

- 所有字段必须满足数据类型、长度和格式要求
- 关键字段必须设置非空约束
- 数据值必须满足业务规则和合理性要求
- 唯一性约束确保关键字段的值不重复

### 7.3 引用完整性

- 外键必须引用有效的主键值
- 支持级联操作（级联更新、级联删除）的明确定义
- 对于可能破坏引用完整性的操作必须进行限制

### 7.4 业务完整性

- 满足行业特定的业务规则和数据要求
- 符合GMP合规的数据管理要求
- 确保数据在业务流程中的一致性和准确性
- 支持业务规则的动态配置和更新

## 8. 性能需求

### 8.1 查询性能

- 简单查询响应时间：≤2秒
- 复杂查询（多表关联）响应时间：≤5秒
- 报表生成响应时间：≤10秒（标准报表），≤30秒（复杂报表）
- 全文搜索响应时间：≤3秒

### 8.2 写入性能

- 单条数据插入响应时间：≤1秒
- 批量数据导入速度：≥1000条/分钟
- 数据更新响应时间：≤1秒
- 数据删除响应时间：≤1秒

### 8.3 并发性能

- 支持100个并发用户的正常操作
- 支持50个并发的写入操作
- 支持100个并发的查询操作
- 在高并发情况下系统性能下降不超过30%

## 9. 数据管理需求

### 9.1 数据生命周期管理

- **数据创建**：提供数据录入和导入的标准化流程
- **数据维护**：支持数据的更新、修改和完善
- **数据归档**：对历史数据进行归档管理
- **数据销毁**：对不再需要的数据进行安全销毁

### 9.2 数据质量管理

- **数据清洗**：定期进行数据清洗，提高数据质量
- **数据校验**：建立数据质量校验机制
- **数据监控**：实时监控数据质量状况
- **数据修复**：提供数据问题的修复机制

### 9.3 数据治理

- **数据标准**：建立统一的数据标准和规范
- **数据责任**：明确数据管理的责任分工
- **数据策略**：制定数据管理的相关策略和制度
- **数据审计**：定期进行数据管理审计

## 10. 验收标准

### 10.1 数据模型验收

- 数据模型覆盖所有业务实体和关系
- 数据模型设计符合范式要求
- 数据字段定义完整、准确
- 数据关系定义正确，能够支持业务操作

### 10.2 数据存储验收

- 数据库设计符合性能和扩展性要求
- 存储策略满足数据访问和管理需求
- 备份策略有效，数据可恢复
- 数据安全措施有效实施

### 10.3 数据处理验收

- 数据输入功能正常，支持多种输入方式
- 数据处理逻辑正确，符合业务规则
- 数据输出功能正常，支持多种输出格式
- 数据查询和报表生成性能满足要求

### 10.4 数据完整性验收

- 实体完整性约束有效
- 域完整性约束有效
- 引用完整性约束有效
- 业务完整性规则正确实施

## 11. 风险评估

| 风险项 | 影响程度 | 可能性 | 缓解措施 |
|-------|--------|-------|--------|
| 数据量增长超预期 | 高 | 中 | 设计可扩展的数据模型，实施数据分区和归档策略 |
| 数据质量问题 | 高 | 高 | 加强数据验证，实施数据清洗和质量监控 |
| 数据安全风险 | 高 | 中 | 实施全面的数据安全措施，定期进行安全审计 |
| 性能瓶颈 | 中 | 中 | 优化数据库设计，实施缓存机制，定期进行性能优化 |
| 系统集成复杂性 | 中 | 高 | 设计标准化的数据接口，实施数据转换和映射机制 |

## 12. 参考资料

- GMP法规文档
- 系统软件需求规约
- 行业数据标准
- 相关数据管理最佳实践

## 13. 文档变更记录

| 版本号 | 修改日期 | 修改人 | 修改内容 |
|-------|---------|--------|--------|
| 1.0.0 | 2023-11-27 | 系统开发团队 | 初始版本 |