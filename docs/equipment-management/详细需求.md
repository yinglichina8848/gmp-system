# 设备管理系统详细需求分析

## 1. 设备基础管理模块 (Equipment Master Data)

### 1.1 功能需求

#### 1.1.1 设备台账管理
- **设备信息录入**：
  - 设备编号 (EQ-YYYY-MMDD-001)
  - 设备名称和型号规格
  - 制造商和供应商信息
  - 采购日期、安装日期
  - 设备位置和负责人

#### 1.1.2 设备分类管理
- **设备类型**：生产设备、检测设备、动力设备、辅助设备
- **设备状态**：在用、停用、维修中、报废、闲置
- **设备等级**：关键设备、一般设备、低值设备

### 1.2 数据模型

#### 1.2.1 设备主表 (equipment)
```sql
CREATE TABLE equipment (
    id BIGSERIAL PRIMARY KEY,
    equipment_code VARCHAR(50) UNIQUE NOT NULL,
    equipment_name VARCHAR(200) NOT NULL,
    equipment_type VARCHAR(50),
    model VARCHAR(100),
    serial_number VARCHAR(100),
    manufacturer VARCHAR(100),
    supplier VARCHAR(100),
    purchase_date DATE,
    installation_date DATE,
    location VARCHAR(200),
    department VARCHAR(100),
    status VARCHAR(20) DEFAULT 'IDLE',
    criticality VARCHAR(20) DEFAULT 'NORMAL', -- CRITICAL, HIGH, NORMAL, LOW
    description TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

## 2. 设备维护管理模块 (Maintenance Management)

### 2.1 功能需求

#### 2.1.1 预防性维护计划
- **维护周期设置**：按时间/使用时数设定维护周期
- **维护标准制定**：维护项目、步骤、标准、耗材
- **自动提醒**：到期前7天开始提醒
- **维护工单生成**：自动生成维护任务

#### 2.1.2 故障维修管理
- **故障报告**：设备故障分类分级记录
- **维修流程**：维修申请→审批→分配→执行→验证→关闭
- **备件管理**：维修中备件领用记录
- **费用统计**：维修成本跟踪分析

### 2.2 数据模型

#### 2.2.1 维护计划表 (maintenance_plan)
```sql
CREATE TABLE maintenance_plan (
    id BIGSERIAL PRIMARY KEY,
    equipment_id BIGINT REFERENCES equipment(id),
    plan_name VARCHAR(200) NOT NULL,
    maintenance_type VARCHAR(50) NOT NULL, -- PREVENTIVE, CORRECTIVE, PREDICTIVE
    frequency_type VARCHAR(20), -- TIME, USAGE_HOURS, PRODUCTION_BATCHES
    frequency_value INTEGER,
    last_maintenance TIMESTAMP,
    next_maintenance TIMESTAMP,
    technician VARCHAR(100),
    estimated_duration INTEGER, -- minutes
    instructions TEXT,
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### 2.2.2 维护记录表 (maintenance_records)
```sql
CREATE TABLE maintenance_records (
    id BIGSERIAL PRIMARY KEY,
    equipment_id BIGINT REFERENCES equipment(id),
    maintenance_plan_id BIGINT REFERENCES maintenance_plan(id),
    technician VARCHAR(100) NOT NULL,
    start_time TIMESTAMP,
    end_time TIMESTAMP,
    findings TEXT,
    work_performed TEXT,
    parts_used JSONB,
    costs DECIMAL(10,2),
    status VARCHAR(20) DEFAULT 'COMPLETED',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

## 3. API接口设计

### 3.1 设备管理接口

#### 3.1.1 创建设备
```
POST /api/equipment
{
    "equipmentCode": "EQ-2024-0101-001",
    "equipmentName": "混合制药反应釜",
    "equipmentType": "REACTOR",
    "model": "RP-500L",
    "manufacturer": "ABC Pharma Equipment Co.",
    "location": "提取车间A线",
    "criticality": "CRITICAL"
}
```

#### 3.1.2 查询设备列表
```
GET /api/equipment?page=0&size=20&status=ACTIVE&type=REACTOR&location=提取车间
```

---

**文档信息：**
- 版本：v1.0
- 编制人员：详细需求分析团队
- 状态：Draft
