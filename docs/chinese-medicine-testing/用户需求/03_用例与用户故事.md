# 中药材检验子系统 - 用例与用户故事

## 1. 引言

### 1.1 文档目的

本文档详细描述了中药材检验子系统的用例和用户故事，旨在从用户的角度出发，描述系统的功能需求和交互场景，为系统设计和开发提供指导。

### 1.2 术语定义

| 术语 | 解释 |
|-----|------|
| 用例 | 描述系统与外部用户（角色）之间的交互，以实现特定目标的行为序列 |
| 用户故事 | 从用户视角描述系统功能的简短描述，通常采用"作为[角色]，我希望[功能]，以便[价值]"的格式 |
| 参与者 | 与系统交互的人或外部系统 |
| 角色 | 系统中具有特定权限和职责的用户类型 |
| 主场景 | 用例的典型执行流程 |
| 备选场景 | 用例的非典型执行流程 |
| 前置条件 | 用例执行前必须满足的条件 |
| 后置条件 | 用例执行后系统所处的状态 |

## 2. 系统角色定义

### 2.1 主要角色

| 角色名称 | 职责描述 |
|---------|---------|
| 系统管理员 | 负责系统的配置、维护和用户管理 |
| 质量管理部经理 | 负责检验计划的审批、检验报告的最终审核等 |
| 检验员 | 执行检验任务、录入检验数据、生成检验报告等 |
| 样品管理员 | 负责样品的接收、登记、存储管理等 |
| 质量标准管理员 | 负责质量标准的制定、更新和维护 |
| 审核员 | 负责检验报告的审核工作 |
| 采购人员 | 提交样品检验申请，查询检验结果等 |
| 仓库管理员 | 处理检验后的样品入库或销毁等 |

## 3. 用例图

### 3.1 系统整体用例图

![系统整体用例图](系统整体用例图.png)

### 3.2 主要用例详述

#### 3.2.1 样品接收与登记

**用例名称**：样品接收与登记

**参与者**：样品管理员

**前置条件**：
- 样品管理员已登录系统
- 待接收的中药材样品已到达

**主场景**：
1. 样品管理员选择"样品接收"功能
2. 系统显示样品接收表单
3. 样品管理员录入样品信息（名称、来源、批次号、数量等）
4. 系统自动生成样品编号
5. 样品管理员确认样品信息无误
6. 系统保存样品信息，更新样品状态为"已接收"
7. 系统提示样品接收成功

**备选场景**：
- 样品信息不完整：系统提示必填项缺失，要求补充信息
- 批次号重复：系统提示批次号已存在，要求确认或修改

**后置条件**：
- 样品信息已保存到系统
- 样品状态为"已接收"

#### 3.2.2 检验计划制定

**用例名称**：检验计划制定

**参与者**：质量管理部经理

**前置条件**：
- 质量管理部经理已登录系统
- 有待检验的样品

**主场景**：
1. 质量管理部经理选择"制定检验计划"功能
2. 系统显示待检验样品列表
3. 质量管理部经理选择需要检验的样品
4. 系统显示检验计划表单
5. 质量管理部经理设置检验计划名称、检验项目、计划执行时间等信息
6. 质量管理部经理保存检验计划
7. 系统生成检验计划编号，更新检验计划状态为"待审批"
8. 系统提示检验计划创建成功

**备选场景**：
- 没有待检验样品：系统提示无可用样品，建议先接收样品
- 未选择样品：系统提示请选择要检验的样品

**后置条件**：
- 检验计划已保存到系统
- 检验计划状态为"待审批"

#### 3.2.3 检验任务执行

**用例名称**：检验任务执行

**参与者**：检验员

**前置条件**：
- 检验员已登录系统
- 有分配给该检验员的待执行检验任务
- 检验所需的设备和试剂已准备就绪

**主场景**：
1. 检验员查看"我的任务"列表
2. 系统显示分配给该检验员的检验任务
3. 检验员选择一个待执行的任务，点击"开始检验"
4. 系统显示检验任务详情和检验项目列表
5. 检验员按照标准操作规范执行检验
6. 检验员录入检验数据和结果
7. 检验员完成所有检验项目后，点击"提交结果"
8. 系统自动根据质量标准判定检验结果是否合格
9. 系统更新任务状态为"已完成"
10. 系统提示检验任务执行完成

**备选场景**：
- 检验过程中出现异常：检验员记录异常情况，请求协助
- 检验结果超差：系统标记异常结果，提醒检验员复核

**后置条件**：
- 检验数据已保存到系统
- 检验任务状态为"已完成"
- 样品状态更新为"已检验"

#### 3.2.4 检验报告生成与审核

**用例名称**：检验报告生成与审核

**参与者**：检验员、审核员、质量管理部经理

**前置条件**：
- 检验任务已完成
- 检验数据已录入系统

**主场景**：
1. 检验员选择"生成检验报告"功能
2. 系统根据检验数据自动生成检验报告草稿
3. 检验员确认报告内容无误后提交审核
4. 审核员收到报告审核通知
5. 审核员查看检验报告内容和原始数据
6. 审核员进行审核，签署电子签名
7. 如果审核通过，报告提交给质量管理部经理进行最终审批
8. 质量管理部经理进行最终审批，签署电子签名
9. 系统更新报告状态为"已批准"
10. 系统提示报告生成和审核完成

**备选场景**：
- 审核不通过：审核员填写审核意见，报告退回给检验员修改
- 数据异常：审核员要求检验员重新检验或说明情况

**后置条件**：
- 检验报告已生成并审核通过
- 报告状态为"已批准"

#### 3.2.5 质量标准管理

**用例名称**：质量标准管理

**参与者**：质量标准管理员

**前置条件**：
- 质量标准管理员已登录系统
- 有权限管理质量标准

**主场景**：
1. 质量标准管理员选择"质量标准管理"功能
2. 系统显示当前有效的质量标准列表
3. 质量标准管理员选择"新增标准"或"修改标准"
4. 系统显示质量标准编辑表单
5. 质量标准管理员录入或修改标准内容，包括标准编号、中药材名称、检验项目、限值要求等
6. 质量标准管理员保存标准信息
7. 系统更新质量标准版本，设置生效日期
8. 系统提示质量标准保存成功

**备选场景**：
- 新增标准：系统自动生成标准编号和初始版本
- 修改现有标准：系统创建新版本，保留历史版本

**后置条件**：
- 质量标准已保存到系统
- 新的质量标准已生效或计划生效

## 4. 用户故事

### 4.1 样品管理相关用户故事

| ID | 用户故事 | 验收标准 |
|----|---------|--------|
| US-001 | 作为样品管理员，我希望快速登记收到的中药材样品，以便及时安排检验 | 能够在5分钟内完成一个样品的接收登记；系统自动生成唯一的样品编号；可以打印样品标签 |
| US-002 | 作为样品管理员，我希望查询和跟踪样品的流转状态，以便了解样品当前位置和检验进度 | 可以通过样品编号、名称、批次等多条件查询样品；可以查看样品的完整流转历史；能够导出样品清单 |
| US-003 | 作为样品管理员，我希望管理样品的存储位置，以确保样品安全存放和易于查找 | 可以记录样品的具体存储位置；可以批量更新样品存储信息；系统提示样品存储时间预警 |

### 4.2 检验计划相关用户故事

| ID | 用户故事 | 验收标准 |
|----|---------|--------|
| US-004 | 作为质量管理部经理，我希望根据待检验样品情况制定检验计划，以便合理安排检验资源 | 可以查看待检验样品清单；可以批量选择样品创建检验计划；可以设置检验优先级和截止日期 |
| US-005 | 作为质量管理部经理，我希望审批检验计划，以确保检验工作符合质量控制要求 | 可以查看检验计划详情和样品信息；可以批准或驳回检验计划；可以查看检验计划的执行进度 |
| US-006 | 作为检验员，我希望查看分配给我的检验任务，以便按照计划执行检验工作 | 可以查看个人任务列表和优先级；可以筛选和排序任务；可以查看任务的详细要求和标准 |

### 4.3 检验执行相关用户故事

| ID | 用户故事 | 验收标准 |
|----|---------|--------|
| US-007 | 作为检验员，我希望方便地录入检验数据，以确保数据的准确性和完整性 | 提供直观的数据录入界面；支持批量数据导入；自动计算检验结果；提供数据校验和异常提示 |
| US-008 | 作为检验员，我希望系统能够根据质量标准自动判定检验结果，以减少人为错误 | 系统能够根据预设的质量标准自动判定检验结果；可以查看判定依据；对于异常结果有明显提示 |
| US-009 | 作为检验员，我希望记录检验过程中的异常情况，以便追溯和分析问题 | 可以添加异常情况描述和处理记录；可以上传异常情况相关照片或文件；异常记录与检验数据关联 |

### 4.4 报告管理相关用户故事

| ID | 用户故事 | 验收标准 |
|----|---------|--------|
| US-010 | 作为检验员，我希望系统能够自动生成检验报告，以提高工作效率和报告质量 | 基于检验数据自动生成报告；报告格式符合规范要求；可以预览和编辑报告内容；支持多种导出格式 |
| US-011 | 作为审核员，我希望能够方便地审核检验报告，以确保报告的准确性和合规性 | 可以查看报告详情和原始检验数据；可以添加审核意见；支持电子签名；可以追踪审核历史 |
| US-012 | 作为采购人员，我希望能够及时查询到中药材的检验报告，以便决定是否接收货物 | 可以通过样品编号、批次等查询报告；可以查看报告摘要和判定结果；可以下载完整报告 |

### 4.5 质量标准相关用户故事

| ID | 用户故事 | 验收标准 |
|----|---------|--------|
| US-013 | 作为质量标准管理员，我希望能够方便地录入和维护中药材质量标准，以确保标准的及时更新 | 可以添加、修改、删除质量标准；支持版本管理；可以导入标准文档；可以设置标准的生效和失效日期 |
| US-014 | 作为质量标准管理员，我希望能够查询和检索特定中药材的质量标准，以便快速获取所需信息 | 可以通过中药材名称、标准编号等多条件查询；支持模糊搜索；可以查看标准的历史版本 |
| US-015 | 作为检验员，我希望在执行检验时能够快速查看相关质量标准，以便准确执行检验操作 | 在检验任务界面可以直接查看相关质量标准；标准内容清晰易读；可以搜索标准中的特定项目 |

### 4.6 不合格品处理相关用户故事

| ID | 用户故事 | 验收标准 |
|----|---------|--------|
| US-016 | 作为检验员，我希望系统能够自动识别不合格品并提示处理流程，以便及时处理质量问题 | 系统自动标记不合格项和样品；提示后续处理流程；记录不合格原因和详细信息 |
| US-017 | 作为质量管理部经理，我希望能够对不合格品进行评审和处理决策，以确保质量问题得到妥善处理 | 可以查看不合格品详情和检验数据；可以组织评审会议；可以制定处理措施；可以追踪处理进度 |
| US-018 | 作为仓库管理员，我希望能够按照处理决定对不合格品进行处理，以确保库存的准确性和合规性 | 可以查看不合格品的处理决定；可以记录处理过程；可以更新样品状态；可以生成处理报告 |

### 4.7 系统管理相关用户故事

| ID | 用户故事 | 验收标准 |
|----|---------|--------|
| US-019 | 作为系统管理员，我希望能够管理系统用户和权限，以确保系统的安全访问 | 可以添加、修改、删除用户；可以分配角色和权限；可以禁用用户账号；可以查看用户登录记录 |
| US-020 | 作为系统管理员，我希望能够配置系统参数和规则，以适应不同的业务需求 | 可以设置检验流程参数；可以配置报告模板；可以定义数据校验规则；可以自定义系统提醒 |
| US-021 | 作为系统管理员，我希望能够监控系统运行状态和用户操作日志，以便及时发现和解决问题 | 可以查看系统运行状态；可以查询用户操作日志；可以导出日志记录；可以设置异常告警 |

## 5. 用例与用户故事映射关系

| 用例名称 | 对应的用户故事ID |
|---------|----------------|
| 样品接收与登记 | US-001, US-003 |
| 样品查询与跟踪 | US-002 |
| 检验计划制定 | US-004, US-005 |
| 检验任务查看 | US-006 |
| 检验任务执行 | US-007, US-008, US-009 |
| 检验报告生成 | US-010 |
| 检验报告审核 | US-011 |
| 检验报告查询 | US-012 |
| 质量标准管理 | US-013, US-014 |
| 质量标准查询 | US-015 |
| 不合格品识别 | US-016 |
| 不合格品评审与处理 | US-017 |
| 不合格品处理执行 | US-018 |
| 用户与权限管理 | US-019 |
| 系统参数配置 | US-020 |
| 系统监控与日志 | US-021 |

## 6. 附录

### 6.1 参考文档
- GMP系统总体需求文档
- 中药材检验标准操作规程
- 相关法规和标准要求

### 6.2 用例图索引
- 系统整体用例图
- 样品管理用例图
- 检验计划与执行用例图
- 报告管理用例图
- 质量标准管理用例图
- 不合格品处理用例图