# GMP系统认证子系统用例图和用例描述

## 文档信息
- **文档版本**: v1.0
- **创建日期**: 2025-11-22
- **最后更新**: 2025-11-22
- **作者**: 系统分析师
- **审核人**: 产品经理

## 目录
1. [概述](#概述)
2. [用例图](#用例图)
3. [用例描述](#用例描述)
4. [GMP特殊要求](#gmp特殊要求)

---

## 概述

### 文档目的
本文档详细描述了GMP系统认证子系统的用例图和各用例的详细描述，为系统设计和开发提供清晰的功能需求说明。

### 用例图说明
用例图展示了系统功能与外部参与者之间的交互关系，是系统功能需求的图形化表示。

### 参与者定义
- **用户**: 系统的所有使用者
- **系统管理员**: 负责系统维护和管理的人员
- **安全管理员**: 负责安全管理的人员
- **外部系统**: 与认证系统集成的其他系统

---

## 用例图

### 认证子系统用例图
```
                         +-----------------+
                         |   外部系统      |
                         +-----------------+
                                  |
                                  | 验证令牌
                                  |
+----------+              +-----------------+
| 系统管理员|------------->|                 |
+----------+   管理用户   |                 |
                         |                 |
+----------+   管理角色   |                 |
| 安全管理员|------------->| 认证子系统      |
+----------+   管理权限   |                 |
                         |                 |
+----------+   用户登录   |                 |
|   用户   |------------->|                 |
+----------+   修改密码   |                 |
             \----------->|                 |
                查看信息  +-----------------+
```

---

## 用例描述

### UC-01: 用户登录

#### 简要说明
允许已注册用户通过用户名和密码登录系统

#### 参与者
- 主要参与者: 用户
- 次要参与者: 无

#### 前置条件
- 用户已在系统中注册
- 用户账户处于激活状态

#### 后置条件
- 用户成功登录系统
- 系统生成并返回访问令牌
- 记录登录日志

#### 基本流程
1. 用户访问登录页面
2. 系统显示登录表单
3. 用户输入用户名和密码
4. 用户提交登录请求
5. 系统验证用户凭据
6. 系统生成JWT访问令牌
7. 系统返回登录成功响应，包含访问令牌
8. 用户进入系统主页

#### 替代流程
- 5a. 用户凭据无效:
  1. 系统返回登录失败信息
  2. 用户可重新输入凭据或选择密码重置

- 5b. 用户账户被锁定:
  1. 系统返回账户锁定信息
  2. 用例结束

#### 特殊需求
- 密码需加密传输
- 登录失败需记录日志
- 连续失败需触发账户锁定机制

#### 扩展点
- 支持多因子认证

### UC-02: 用户登出

#### 简要说明
允许已登录用户安全退出系统

#### 参与者
- 主要参与者: 用户
- 次要参与者: 无

#### 前置条件
- 用户已成功登录系统

#### 后置条件
- 用户会话被终止
- 访问令牌失效

#### 基本流程
1. 用户点击登出按钮
2. 系统使当前访问令牌失效
3. 系统清除用户会话信息
4. 系统重定向到登录页面
5. 用例结束

#### 替代流程
- 无

#### 特殊需求
- 确保令牌完全失效
- 清除所有会话相关数据

#### 扩展点
- 自动登出超时机制

### UC-03: 修改密码

#### 简要说明
允许用户修改自己的登录密码

#### 参与者
- 主要参与者: 用户
- 次要参与者: 无

#### 前置条件
- 用户已成功登录系统

#### 后置条件
- 用户密码更新为新密码
- 记录密码变更日志

#### 基本流程
1. 用户进入个人设置页面
2. 用户选择修改密码选项
3. 系统显示密码修改表单
4. 用户输入当前密码和新密码
5. 用户提交密码修改请求
6. 系统验证当前密码
7. 系统更新用户密码
8. 系统返回修改成功信息
9. 用例结束

#### 替代流程
- 6a. 当前密码验证失败:
  1. 系统返回验证失败信息
  2. 用户可重新输入当前密码

- 7a. 新密码不符合安全要求:
  1. 系统返回密码强度不足信息
  2. 用户需输入符合要求的新密码

#### 特殊需求
- 新密码需满足复杂度要求
- 密码变更需记录审计日志
- 密码需加密存储

#### 扩展点
- 密码复杂度策略配置

### UC-04: 管理用户

#### 简要说明
允许系统管理员管理用户账户信息

#### 参与者
- 主要参与者: 系统管理员
- 次要参与者: 用户

#### 前置条件
- 系统管理员已登录系统
- 系统管理员具有用户管理权限

#### 后置条件
- 用户信息按要求更新
- 操作记录在审计日志中

#### 基本流程
1. 系统管理员进入用户管理页面
2. 系统显示用户列表
3. 系统管理员选择操作（创建/修改/删除/查询用户）
4. 系统显示相应操作表单
5. 系统管理员填写用户信息
6. 系统管理员提交操作请求
7. 系统处理操作请求
8. 系统返回操作结果
9. 用例结束

#### 替代流程
- 7a. 操作失败:
  1. 系统返回操作失败信息
  2. 系统管理员可重新尝试操作

#### 特殊需求
- 所有操作需记录审计日志
- 敏感操作需二次确认
- 用户删除需软删除机制

#### 扩展点
- 批量用户操作
- 用户导入导出功能

### UC-05: 管理角色

#### 简要说明
允许安全管理员管理系统角色信息

#### 参与者
- 主要参与者: 安全管理员
- 次要参与者: 无

#### 前置条件
- 安全管理员已登录系统
- 安全管理员具有角色管理权限

#### 后置条件
- 角色信息按要求更新
- 操作记录在审计日志中

#### 基本流程
1. 安全管理员进入角色管理页面
2. 系统显示角色列表
3. 安全管理员选择操作（创建/修改/删除/查询角色）
4. 系统显示相应操作表单
5. 安全管理员填写角色信息
6. 安全管理员提交操作请求
7. 系统处理操作请求
8. 系统返回操作结果
9. 用例结束

#### 替代流程
- 7a. 操作失败:
  1. 系统返回操作失败信息
  2. 安全管理员可重新尝试操作

#### 特殊需求
- 所有操作需记录审计日志
- 角色删除前需检查关联用户
- 关键角色不可删除

#### 扩展点
- 角色继承机制
- 角色模板功能

### UC-06: 管理权限

#### 简要说明
允许安全管理员管理权限信息

#### 参与者
- 主要参与者: 安全管理员
- 次要参与者: 无

#### 前置条件
- 安全管理员已登录系统
- 安全管理员具有权限管理权限

#### 后置条件
- 权限信息按要求更新
- 操作记录在审计日志中

#### 基本流程
1. 安全管理员进入权限管理页面
2. 系统显示权限列表
3. 安全管理员选择操作（创建/修改/删除/查询权限）
4. 系统显示相应操作表单
5. 安全管理员填写权限信息
6. 安全管理员提交操作请求
7. 系统处理操作请求
8. 系统返回操作结果
9. 用例结束

#### 替代流程
- 7a. 操作失败:
  1. 系统返回操作失败信息
  2. 安全管理员可重新尝试操作

#### 特殊需求
- 所有操作需记录审计日志
- 权限删除前需检查关联角色
- 关键权限不可删除

#### 扩展点
- 权限分组管理
- 权限继承机制

### UC-07: 验证令牌

#### 简要说明
允许外部系统验证访问令牌的有效性

#### 参与者
- 主要参与者: 外部系统
- 次要参与者: 无

#### 前置条件
- 外部系统持有访问令牌
- 外部系统具有令牌验证权限

#### 后置条件
- 返回令牌验证结果
- 记录验证日志

#### 基本流程
1. 外部系统发送令牌验证请求
2. 系统接收并解析验证请求
3. 系统验证令牌有效性
4. 系统返回验证结果
5. 用例结束

#### 替代流程
- 3a. 令牌无效:
  1. 系统返回验证失败信息

#### 特殊需求
- 验证过程需高效
- 验证失败需记录日志
- 防止令牌重放攻击

#### 扩展点
- 令牌刷新机制
- 令牌黑名单管理

---

## GMP特殊要求

### 合规性要求
- 所有认证操作必须符合GMP法规要求
- 关键操作必须支持完整的审计追踪
- 用户身份必须经过严格验证

### 安全性要求
- 密码必须加密存储和传输
- 访问令牌必须具有时效性
- 敏感操作必须实施职责分离

### 可追溯性要求
- 所有用户操作必须记录审计日志
- 审计日志必须防篡改
- 关键操作必须记录详细信息