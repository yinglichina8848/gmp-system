# 人事子系统维护手册

## 📋 文档信息

| 属性 | 值 |
|------|---|
| 文档标题 | 人事子系统维护手册 |
| 版本号 | v1.0.0 |
| 发布日期 | 2025年11月 |
| 编制人 | IT运维团队 |
| 审核人 | IT总监：李刚 |
| 文档状态 | 正式版 |

## 1️⃣ 手册说明

### 1.1 文档目的

本文档旨在为GMP环境下人事管理子系统的维护人员提供详细的系统维护操作指南，确保维护工作符合规范要求，保障系统稳定运行，满足GMP合规性要求。维护人员应严格按照本手册的要求执行日常维护、故障处理、系统优化等工作，确保维护工作的质量和效率。

### 1.2 适用范围

- **适用对象**：系统管理员、数据库管理员、网络管理员、应用开发工程师、技术支持工程师等维护人员
- **适用系统**：GMP环境下人事管理子系统
- **适用环境**：生产环境、测试环境、开发环境

### 1.3 使用说明

- 维护人员在执行维护工作前，应仔细阅读相关章节，了解操作步骤和注意事项
- 重要操作前，应备份相关数据和配置，做好回滚准备
- 维护操作应在规定的维护窗口内执行，避免影响业务运行
- 维护过程中应认真记录操作内容和结果，及时更新相关文档
- 发现问题应立即报告，并按照故障处理流程进行处理

### 1.4 术语定义

| 术语 | 解释说明 |
|------|----------|
| GMP | 药品生产质量管理规范（Good Manufacturing Practice） |
| 系统维护 | 为确保系统正常运行而进行的检查、维修、更新等工作 |
| 预防性维护 | 定期对系统进行检查和维护，预防故障发生 |
| 纠正性维护 | 系统出现故障后进行的修复工作 |
| 灾难恢复 | 在系统遭受重大损坏后，恢复系统正常运行的过程 |
| 电子记录 | 以电子形式存在的各类业务和系统记录 |
| 电子签名 | 用于识别签名者身份并表明其对电子记录内容认可的电子数据 |
| 审计跟踪 | 记录系统活动的日志，用于追踪谁在何时做了什么操作 |
| 数据完整性 | 确保数据在整个生命周期内保持完整、准确、一致和可追溯的特性 |
| 变更管理 | 管理和控制系统变更的流程和方法 |

## 2️⃣ 系统概述

### 2.1 系统架构

#### 2.1.1 整体架构

人事子系统采用三层架构设计，包括数据层、应用层和表示层。系统基于Java EE平台开发，使用Oracle数据库存储数据，WebLogic作为应用服务器。系统架构图如下：

```
表示层（Presentation Layer）
┌─────────────────────────────────────────────────────────────┐
│  Web浏览器客户端  │  移动应用客户端  │  集成接口客户端      │
└──────────────────────────────┬──────────────────────────────┘
                               │
                               ▼
应用层（Application Layer）
┌─────────────────────────────────────────────────────────────┐
│  Web服务器 (Apache/Nginx)                                   │
└───────────────────────┬─────────────────────────────────────┘
                        │
                        ▼
┌─────────────────────────────────────────────────────────────┐
│  应用服务器集群 (WebLogic)                                  │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐         │
│  │  应用实例1  │  │  应用实例2  │  │  应用实例3  │         │
│  └─────────────┘  └─────────────┘  └─────────────┘         │
└──────────────────────────────┬──────────────────────────────┘
                               │
                               ▼
数据层（Data Layer）
┌─────────────────────────────────────────────────────────────┐
│  数据库集群 (Oracle RAC)                                    │
│  ┌─────────────┐  ┌─────────────┐                           │
│  │  主数据库   │  │  备用数据库 │                           │
│  └─────────────┘  └─────────────┘                           │
└───────────────────────┬─────────────────────────────────────┘
                        │
                        ▼
┌─────────────────────────────────────────────────────────────┐
│  存储系统 (SAN/NAS)                                         │
└─────────────────────────────────────────────────────────────┘
```

#### 2.1.2 关键组件说明

| 组件名称 | 版本/型号 | 功能描述 | 配置要求 |
|----------|-----------|----------|----------|
| **WebLogic应用服务器** | 14c | 运行Java应用程序，提供应用服务 | 32核CPU，128GB内存，2TB SSD |
| **Oracle数据库** | 19c RAC | 存储和管理系统数据 | 64核CPU，256GB内存，4TB SSD |
| **Apache Web服务器** | 2.4 | 处理Web请求，提供负载均衡 | 8核CPU，32GB内存，500GB SSD |
| **网络存储** | SAN存储阵列 | 存储数据和备份 | 40TB存储空间，RAID 6配置 |
| **备份系统** | NetBackup 8.3 | 数据备份和恢复 | 专用备份服务器，磁带库 |
| **监控系统** | Zabbix 6.0 | 系统和网络监控 | 专用监控服务器 |

### 2.2 系统功能模块

#### 2.2.1 核心功能模块

| 模块名称 | 主要功能 | 关键表/文件 | 维护要点 |
|----------|----------|-------------|----------|
| **员工信息管理** | 员工基本信息管理、组织架构管理、岗位管理 | EMPLOYEE, DEPARTMENT, POSITION | 数据完整性维护，索引优化 |
| **考勤管理** | 考勤记录管理、排班管理、请假管理、加班管理 | ATTENDANCE, SCHEDULE, LEAVE, OVERTIME | 数据准确性检查，报表性能优化 |
| **薪资管理** | 薪资结构管理、薪资计算、薪资发放、薪资报表 | SALARY_STRUCTURE, PAYROLL, TAX_DEDUCTION | 计算逻辑验证，数据安全性保护 |
| **绩效管理** | 绩效计划制定、绩效评估、绩效反馈、绩效分析 | PERFORMANCE_PLAN, PERFORMANCE_REVIEW | 评估流程维护，数据分析优化 |
| **培训管理** | 培训计划制定、培训执行、培训评估、培训记录 | TRAINING_PLAN, TRAINING_EXECUTION, TRAINING_RECORD | 培训记录完整性检查 |
| **权限管理** | 用户管理、角色管理、权限分配、访问控制 | USER, ROLE, PERMISSION, USER_ROLE | 权限审计，安全配置维护 |
| **系统管理** | 系统参数配置、日志管理、备份管理、审计跟踪 | SYSTEM_PARAMS, AUDIT_LOG, BACKUP_CONFIG | 配置参数验证，日志清理维护 |

#### 2.2.2 集成接口

| 接口名称 | 功能描述 | 连接方式 | 维护要点 |
|----------|----------|----------|----------|
| **ERP系统接口** | 与ERP系统交换员工、部门、薪资等数据 | Web Service/REST | 接口监控，数据同步验证 |
| **考勤设备接口** | 从考勤设备导入考勤数据 | 数据库直连/文件传输 | 数据格式转换，错误处理 |
| **财务系统接口** | 向财务系统提供薪资数据 | 文件传输/数据库视图 | 数据准确性验证，传输加密 |
| **OA系统接口** | 与OA系统交换请假、加班等申请数据 | Web Service | 流程状态同步，错误重试机制 |

### 2.3 系统配置概述

#### 2.3.1 应用服务器配置

| 配置项 | 配置路径 | 关键参数 | 推荐值 |
|--------|----------|----------|--------|
| **JVM配置** | $DOMAIN_HOME/bin/setDomainEnv.sh | JAVA_OPTS | -Xms8g -Xmx8g -XX:MetaspaceSize=256m -XX:MaxMetaspaceSize=512m |
| **连接池配置** | $DOMAIN_HOME/config/config.xml | maxCapacity | 100 |
| **线程池配置** | $DOMAIN_HOME/config/config.xml | ThreadCount | 50 |
| **日志配置** | $DOMAIN_HOME/config/config.xml | FileCount, FileMinSize | 10, 50MB |
| **安全配置** | $DOMAIN_HOME/config/config.xml | SecurityMode | SSL3 |

#### 2.3.2 数据库配置

| 配置项 | 配置文件 | 关键参数 | 推荐值 |
|--------|----------|----------|--------|
| **内存配置** | $ORACLE_HOME/dbs/initORCL.ora | SGA_SIZE, PGA_AGGREGATE_TARGET | 128G, 64G |
| **进程配置** | $ORACLE_HOME/dbs/initORCL.ora | PROCESSES | 1000 |
| **连接配置** | $ORACLE_HOME/network/admin/listener.ora | LISTENER_PORT | 1521 |
| **归档配置** | $ORACLE_HOME/dbs/initORCL.ora | LOG_ARCHIVE_DEST_1 | /archivelog |
| **参数文件** | $ORACLE_HOME/dbs/spfileORCL.ora | 各种系统参数 | 根据实际情况调整 |

#### 2.3.3 Web服务器配置

| 配置项 | 配置文件 | 关键参数 | 推荐值 |
|--------|----------|----------|--------|
| **工作进程** | /etc/httpd/conf/httpd.conf | ServerLimit, MaxClients | 16, 256 |
| **超时设置** | /etc/httpd/conf/httpd.conf | Timeout, KeepAliveTimeout | 60, 15 |
| **日志配置** | /etc/httpd/conf/httpd.conf | LogLevel, ErrorLog | warn, /var/log/httpd/error_log |
| **SSL配置** | /etc/httpd/conf.d/ssl.conf | SSLCertificateFile | /etc/ssl/certs/hr_system.crt |

## 3️⃣ 日常维护

### 3.1 每日维护

#### 3.1.1 系统状态检查

1. **服务器状态检查**
   - 使用以下命令检查服务器CPU、内存、磁盘使用率：
     ```bash
     top -n 1
     free -h
     df -h
     ```
   - 检查服务器运行温度和电源状态
   - 检查网络连接状态：
     ```bash
     ping -c 4 <网关IP>
     netstat -an | grep ESTABLISHED
     ```

2. **应用服务器状态检查**
   - 检查WebLogic应用服务器状态：
     ```bash
     $WL_HOME/common/bin/wlst.sh $DOMAIN_HOME/scripts/check_server.py
     ```
   - 检查应用实例日志是否有错误：
     ```bash
     tail -n 100 $DOMAIN_HOME/servers/server1/logs/server1.out | grep ERROR
     ```
   - 检查Web服务器状态：
     ```bash
     systemctl status httpd
     ```

3. **数据库状态检查**
   - 检查Oracle数据库实例状态：
     ```sql
     SELECT instance_name, status FROM v$instance;
     ```
   - 检查数据库连接数：
     ```sql
     SELECT count(*) FROM v$session;
     ```
   - 检查表空间使用率：
     ```sql
     SELECT tablespace_name, sum(bytes)/1024/1024/1024 "Size (GB)", 
            sum(bytes - free_bytes)/1024/1024/1024 "Used (GB)",
            (sum(bytes - free_bytes)/sum(bytes))*100 "Used %"
     FROM dba_tablespaces t, (SELECT tablespace_name, sum(bytes) free_bytes
                           FROM dba_free_space GROUP BY tablespace_name) f
     WHERE t.tablespace_name = f.tablespace_name(+)
     GROUP BY tablespace_name;
     ```

4. **备份状态检查**
   - 检查前一天备份是否成功完成
   - 验证备份日志中是否有错误信息
   - 检查备份存储容量是否充足

#### 3.1.2 性能监控

1. **系统性能监控**
   - 使用Zabbix监控系统查看系统性能指标
   - 记录并分析CPU、内存、磁盘I/O、网络流量等性能数据
   - 识别性能异常，及时进行处理

2. **应用性能监控**
   - 检查应用响应时间
   - 监控事务处理速度
   - 分析慢响应页面和接口

3. **数据库性能监控**
   - 监控慢查询SQL：
     ```sql
     SELECT sql_id, plan_hash_value, executions, elapsed_time/1000000 "Elapsed Time (s)",
            buffer_gets, disk_reads, rows_processed,
            sql_text
     FROM v$sql
     WHERE elapsed_time > 10000000
     ORDER BY elapsed_time DESC;
     ```
   - 检查锁等待情况：
     ```sql
     SELECT blocking_session, sid, serial#, wait_class, seconds_in_wait,
            state, event
     FROM v$session
     WHERE blocking_session IS NOT NULL;
     ```

#### 3.1.3 日志审查

1. **应用日志审查**
   - 审查应用服务器日志中的错误和警告信息
   - 分析日志中的异常模式
   - 记录并追踪重复出现的错误

2. **数据库日志审查**
   - 审查Oracle数据库告警日志：
     ```bash
     tail -n 200 $ORACLE_BASE/diag/rdbms/orcl/orcl/alert/log.xml | grep -i error
     ```
   - 检查数据库审计日志

3. **安全日志审查**
   - 检查系统安全日志
   - 审查认证和授权日志
   - 识别可疑活动和安全事件

### 3.2 每周维护

#### 3.2.1 系统健康检查

1. **全面系统检查**
   - 执行系统健康检查脚本
   - 生成系统健康状态报告
   - 分析系统健康趋势

2. **应用健康检查**
   - 检查应用功能完整性
   - 验证所有接口连接状态
   - 测试关键业务流程

3. **数据库健康检查**
   - 执行数据库健康检查脚本
   - 检查数据库对象状态：
     ```sql
     SELECT owner, object_name, object_type, status
     FROM dba_objects
     WHERE status != 'VALID';
     ```
   - 检查数据一致性

#### 3.2.2 数据库维护

1. **索引维护**
   - 分析索引使用情况
   - 重建或重组低效索引：
     ```sql
     ALTER INDEX hr.employee_pk REBUILD;
     ```
   - 收集索引统计信息：
     ```sql
     EXEC DBMS_STATS.GATHER_INDEX_STATS('HR', 'EMPLOYEE_PK');
     ```

2. **统计信息更新**
   - 更新表和索引的统计信息：
     ```sql
     EXEC DBMS_STATS.GATHER_SCHEMA_STATS('HR', CASCADE => TRUE);
     ```
   - 验证统计信息是否准确

3. **临时表和日志清理**
   - 清理临时表中的数据
   - 归档并清理应用日志文件
   - 清理审计日志文件（保留必要的历史记录）

#### 3.2.3 安全更新检查

1. **操作系统更新检查**
   - 检查操作系统安全补丁更新
   - 计划并应用重要安全补丁

2. **应用程序更新检查**
   - 检查应用程序安全更新和漏洞修复
   - 与开发团队协调更新计划

3. **病毒和恶意软件扫描**
   - 在所有服务器上运行病毒扫描
   - 检查恶意软件感染情况
   - 更新防病毒软件定义

### 3.3 月度维护

#### 3.3.1 系统全面评估

1. **性能评估**
   - 分析系统性能趋势
   - 识别性能瓶颈
   - 制定性能优化计划

2. **容量规划评估**
   - 评估系统资源使用趋势
   - 预测未来容量需求
   - 制定容量扩展计划

3. **安全评估**
   - 执行全面的安全扫描
   - 进行安全漏洞评估
   - 制定安全加固计划

#### 3.3.2 数据维护

1. **数据完整性检查**
   - 执行数据一致性检查
   - 验证主外键约束
   - 修复发现的数据问题

2. **数据归档**
   - 归档不常用的历史数据
   - 更新数据访问统计信息
   - 优化数据存储结构

3. **数据库优化**
   - 优化数据库参数配置
   - 调整内存分配
   - 优化查询执行计划

#### 3.3.3 备份与恢复测试

1. **备份验证**
   - 验证备份数据的完整性
   - 测试备份恢复流程
   - 记录恢复时间和成功率

2. **灾难恢复演练**
   - 执行灾难恢复演练
   - 测试备用系统的可用性
   - 评估恢复点目标(RPO)和恢复时间目标(RTO)达成情况

## 4️⃣ 故障处理

### 4.1 故障分类与优先级

#### 4.1.1 故障分类

| 故障类型 | 描述 | 示例 |
|----------|------|------|
| **硬件故障** | 服务器、存储、网络设备等硬件组件故障 | 硬盘故障、电源故障、网络中断 |
| **软件故障** | 操作系统、数据库、应用程序等软件组件故障 | 数据库崩溃、应用服务无法启动、内存泄漏 |
| **网络故障** | 网络连接、路由、安全设备等问题 | 网络拥塞、防火墙配置错误、DNS解析失败 |
| **数据故障** | 数据丢失、损坏、不一致等问题 | 数据库损坏、数据文件丢失、数据不一致 |
| **配置故障** | 系统配置错误导致的问题 | 参数配置错误、权限设置不当、连接池配置不合理 |
| **安全事件** | 安全漏洞、入侵、攻击等问题 | 未授权访问、恶意软件感染、数据泄露 |

#### 4.1.2 优先级划分

| 优先级 | 定义 | 响应时间 | 解决时间 |
|--------|------|----------|----------|
| **P1（紧急）** | 系统完全不可用，核心业务流程中断 | 30分钟内 | 2小时内 |
| **P2（高）** | 系统部分功能不可用，但有替代方案 | 2小时内 | 8小时内 |
| **P3（中）** | 系统功能可用，但性能严重下降或有明显错误 | 4小时内 | 24小时内 |
| **P4（低）** | 系统功能和性能基本正常，有轻微问题或改进需求 | 24小时内 | 5个工作日内 |

### 4.2 常见故障处理流程

#### 4.2.1 应用服务器故障

1. **故障症状**
   - Web页面无法访问
   - 应用服务未运行
   - 应用响应缓慢或超时

2. **诊断步骤**
   - 检查WebLogic服务状态：
     ```bash
     $WL_HOME/common/bin/wlst.sh $DOMAIN_HOME/scripts/check_server.py
     ```
   - 检查应用日志中的错误信息：
     ```bash
     tail -n 500 $DOMAIN_HOME/servers/server1/logs/server1.out | grep -i error
     ```
   - 检查服务器资源使用情况（CPU、内存、磁盘）
   - 检查网络连接状态

3. **恢复步骤**
   - 重启WebLogic服务：
     ```bash
     $DOMAIN_HOME/bin/stopWebLogic.sh
     $DOMAIN_HOME/bin/startWebLogic.sh
     ```
   - 如果重启无效，检查并修复配置问题
   - 如果是资源不足，增加资源或优化应用
   - 必要时回滚到最近的稳定版本

#### 4.2.2 数据库故障

1. **故障症状**
   - 数据库连接失败
   - 查询执行缓慢或超时
   - 数据库实例崩溃

2. **诊断步骤**
   - 检查数据库实例状态：
     ```sql
     SELECT instance_name, status FROM v$instance;
     ```
   - 检查数据库告警日志：
     ```bash
     tail -n 500 $ORACLE_BASE/diag/rdbms/orcl/orcl/alert/log.xml
     ```
   - 检查数据库资源使用情况
   - 检查表空间使用率和磁盘空间

3. **恢复步骤**
   - 启动数据库实例：
     ```sql
     STARTUP;
     ```
   - 恢复损坏的数据文件：
     ```sql
     RECOVER DATAFILE '/u01/app/oracle/oradata/ORCL/emp01.dbf';
     ```
   - 扩展表空间：
     ```sql
     ALTER TABLESPACE users ADD DATAFILE '/u01/app/oracle/oradata/ORCL/users02.dbf' SIZE 10G AUTOEXTEND ON;
     ```
   - 优化问题SQL

#### 4.2.3 网络故障

1. **故障症状**
   - 无法访问Web界面
   - 系统间数据同步失败
   - 网络连接间歇性中断

2. **诊断步骤**
   - 检查网络连接：
     ```bash
     ping <目标IP>
     traceroute <目标IP>
     ```
   - 检查网络设备状态（交换机、路由器、防火墙）
   - 检查网络配置和路由表
   - 检查防火墙规则

3. **恢复步骤**
   - 重启网络设备
   - 修复网络配置错误
   - 调整防火墙规则
   - 联系网络服务提供商（如果是外部网络问题）

#### 4.2.4 数据问题故障

1. **故障症状**
   - 数据显示不正确
   - 报表计算错误
   - 数据完整性约束违反

2. **诊断步骤**
   - 验证数据一致性
   - 检查数据输入日志
   - 分析错误记录
   - 检查最近的数据导入或更新操作

3. **恢复步骤**
   - 从备份恢复数据：
     ```sql
     RESTORE DATABASE;
     RECOVER DATABASE;
     ```
   - 修复数据错误（使用UPDATE语句）
   - 重建损坏的索引
   - 验证修复后的数据完整性

### 4.3 故障记录与报告

#### 4.3.1 故障记录内容

每次故障处理后，应记录以下信息：

1. **故障基本信息**
   - 故障编号和发生时间
   - 故障类型和优先级
   - 影响范围和程度
   - 报告人和联系方式

2. **故障处理过程**
   - 故障诊断步骤和发现
   - 尝试的解决方案
   - 最终解决方案
   - 参与处理的人员

3. **故障根因分析**
   - 根本原因
   - 触发条件
   - 预防措施

4. **经验总结**
   - 处理过程中的经验教训
   - 可以改进的地方
   - 相关文档的更新建议

#### 4.3.2 故障报告模板

```
故障报告
==========

基本信息
--------
- 故障编号: GMP-HR-202511XX-XXX
- 报告日期: YYYY-MM-DD
- 故障开始时间: YYYY-MM-DD HH:MM:SS
- 故障结束时间: YYYY-MM-DD HH:MM:SS
- 故障持续时间: X小时Y分钟
- 故障类型: [硬件/软件/网络/数据/配置/安全]
- 优先级: [P1/P2/P3/P4]
- 报告人: 姓名/部门
- 联系方式: 电话/邮箱

故障描述
--------
[详细描述故障现象和影响范围]

处理过程
--------
1. [诊断步骤1及结果]
2. [诊断步骤2及结果]
3. [尝试的解决方案1及结果]
4. [尝试的解决方案2及结果]
5. [最终解决方案及实施过程]

根本原因
--------
[详细分析故障的根本原因]

预防措施
--------
1. [具体的预防措施1]
2. [具体的预防措施2]
3. [相关文档或流程的更新建议]

经验教训
--------
[总结处理过程中的经验和教训]

处理人员
--------
- 主要处理人: [姓名/部门]
- 协助处理人: [姓名/部门, ...]

附件
--------
[相关日志、截图、分析报告等]
```

## 5️⃣ 系统备份与恢复

### 5.1 备份策略

#### 5.1.1 备份类型

| 备份类型 | 描述 | 频率 | 保留期限 |
|----------|------|------|----------|
| **全量备份** | 备份数据库的完整副本 | 每周一次（周日） | 30天 |
| **增量备份** | 备份上次备份后发生变化的数据 | 每天一次 | 7天 |
| **事务日志备份** | 备份数据库事务日志 | 每小时一次 | 3天 |
| **文件系统备份** | 备份应用程序和配置文件 | 每周一次（周六） | 14天 |
| **归档备份** | 长期保存的备份 | 每月一次 | 1年 |

#### 5.1.2 备份介质

- **磁盘备份**：主备份存储在高速磁盘阵列上，用于快速恢复
- **磁带备份**：将备份数据复制到磁带上，用于长期保存和灾难恢复
- **异地备份**：将关键备份数据复制到异地存储，防止本地灾难

### 5.2 备份操作流程

#### 5.2.1 数据库备份

1. **全量备份操作**
   - 使用RMAN执行全量备份：
     ```sql
     RMAN>
     CONNECT TARGET sys/password@orcl;
     RUN {
       ALLOCATE CHANNEL c1 DEVICE TYPE DISK;
       BACKUP AS COMPRESSED BACKUPSET DATABASE PLUS ARCHIVELOG;
       DELETE OBSOLETE;
       RELEASE CHANNEL c1;
     }
     ```
   - 验证备份完整性：
     ```sql
     RMAN>
     CONNECT TARGET sys/password@orcl;
     VALIDATE BACKUPSET 123;
     ```

2. **增量备份操作**
   - 使用RMAN执行增量备份：
     ```sql
     RMAN>
     CONNECT TARGET sys/password@orcl;
     RUN {
       ALLOCATE CHANNEL c1 DEVICE TYPE DISK;
       BACKUP INCREMENTAL LEVEL 1 DATABASE PLUS ARCHIVELOG;
       DELETE OBSOLETE;
       RELEASE CHANNEL c1;
     }
     ```

3. **事务日志备份操作**
   - 使用RMAN执行事务日志备份：
     ```sql
     RMAN>
     CONNECT TARGET sys/password@orcl;
     BACKUP ARCHIVELOG ALL NOT BACKED UP;
     ```

#### 5.2.2 文件系统备份

1. **应用服务器备份**
   - 使用rsync进行文件系统备份：
     ```bash
     rsync -avz /u01/app/oracle/user_projects/domains/hr_domain/ /backup/app_backup/$(date +%Y%m%d)/
     ```

2. **配置文件备份**
   - 备份关键配置文件：
     ```bash
     tar -czvf /backup/config_backup/$(date +%Y%m%d)_config.tar.gz /etc/httpd/ /etc/oratab /etc/ssh/ /etc/security/
     ```

### 5.3 恢复操作流程

#### 5.3.1 数据库恢复

1. **完全恢复**
   - 使用RMAN执行完全恢复：
     ```sql
     RMAN>
     CONNECT TARGET sys/password@orcl;
     STARTUP MOUNT;
     RUN {
       ALLOCATE CHANNEL c1 DEVICE TYPE DISK;
       RESTORE DATABASE;
       RECOVER DATABASE;
       RELEASE CHANNEL c1;
     }
     ALTER DATABASE OPEN;
     ```

2. **时间点恢复**
   - 使用RMAN执行时间点恢复：
     ```sql
     RMAN>
     CONNECT TARGET sys/password@orcl;
     STARTUP MOUNT;
     RUN {
       ALLOCATE CHANNEL c1 DEVICE TYPE DISK;
       RESTORE DATABASE;
       RECOVER DATABASE UNTIL TIME "TO_DATE('2025-11-20 14:30:00', 'YYYY-MM-DD HH24:MI:SS')";
       RELEASE CHANNEL c1;
     }
     ALTER DATABASE OPEN RESETLOGS;
     ```

3. **表空间恢复**
   - 使用RMAN执行表空间恢复：
     ```sql
     RMAN>
     CONNECT TARGET sys/password@orcl;
     ALTER TABLESPACE hr_data OFFLINE;
     RUN {
       ALLOCATE CHANNEL c1 DEVICE TYPE DISK;
       RESTORE TABLESPACE hr_data;
       RECOVER TABLESPACE hr_data;
       RELEASE CHANNEL c1;
     }
     ALTER TABLESPACE hr_data ONLINE;
     ```

#### 5.3.2 应用服务器恢复

1. **WebLogic恢复**
   - 停止WebLogic服务
   - 恢复WebLogic域配置：
     ```bash
     rm -rf /u01/app/oracle/user_projects/domains/hr_domain/
     rsync -avz /backup/app_backup/20251120/ /u01/app/oracle/user_projects/domains/hr_domain/
     ```
   - 启动WebLogic服务

2. **Web服务器恢复**
   - 停止Web服务器
   - 恢复Web服务器配置：
     ```bash
     cp /backup/config_backup/20251120_config.tar.gz /tmp/
     cd /tmp
     tar -xzvf 20251120_config.tar.gz
     cp -r etc/httpd/* /etc/httpd/
     ```
   - 启动Web服务器

### 5.4 备份验证与测试

1. **备份验证方法**
   - 检查备份日志，确认备份操作成功完成
   - 验证备份文件是否存在且大小合理
   - 定期执行备份恢复测试，确保备份可用

2. **恢复测试计划**
   - 每月执行一次全量恢复测试
   - 每季度执行一次灾难恢复演练
   - 记录恢复时间和成功率
   - 根据测试结果优化备份策略

## 6️⃣ GMP合规性维护

### 6.1 电子记录维护

#### 6.1.1 记录管理要求

- **完整性**：确保所有电子记录的创建、修改、删除均被记录，防止数据丢失或篡改
- **准确性**：确保电子记录准确反映实际业务活动和数据
- **可追溯性**：确保电子记录可以追溯到相关的业务流程和责任人
- **安全性**：确保电子记录的安全存储和传输

#### 6.1.2 记录维护操作

1. **记录定期审查**
   - 定期审查电子记录的完整性和准确性
   - 检查记录是否符合GMP要求
   - 识别并处理异常记录

2. **记录存储管理**
   - 确保记录存储在安全、可靠的存储介质中
   - 实施适当的数据保护措施（加密、访问控制等）
   - 定期验证存储的记录是否可访问和可读

3. **记录检索管理**
   - 建立电子记录检索系统，确保记录可及时检索
   - 记录所有记录检索活动
   - 定期测试检索系统的性能和准确性

### 6.2 电子签名维护

#### 6.2.1 签名管理要求

- **唯一性**：确保电子签名与签名者身份唯一关联
- **不可否认性**：确保签名者无法否认其已签署的记录
- **完整性**：确保电子签名的完整性，防止伪造或篡改
- **安全性**：确保电子签名的安全使用和管理

#### 6.2.2 签名维护操作

1. **签名验证**
   - 定期验证电子签名系统的功能和安全性
   - 测试电子签名在各种情况下的表现
   - 确保签名验证机制正常工作

2. **签名审计**
   - 定期审计电子签名的使用情况
   - 检查签名是否符合GMP要求
   - 识别并处理异常签名活动

3. **签名系统维护**
   - 定期更新电子签名系统的安全补丁
   - 监控签名系统的性能和可用性
   - 维护签名系统的配置和参数

### 6.3 审计跟踪维护

#### 6.3.1 审计跟踪要求

- **完整性**：确保审计跟踪记录完整，不被篡改或删除
- **准确性**：确保审计跟踪记录准确反映系统活动
- **及时性**：确保审计跟踪记录及时生成和保存
- **可访问性**：确保审计跟踪记录可及时检索和审查

#### 6.3.2 审计跟踪维护操作

1. **审计跟踪配置**
   - 配置审计跟踪参数，确保记录所有关键操作和事件
   - 确保审计跟踪记录包含必要的信息（时间、用户、操作、结果等）
   - 验证审计跟踪配置是否符合GMP要求

2. **审计跟踪存储**
   - 确保审计跟踪记录存储在安全、不可篡改的存储介质中
   - 实施适当的数据保护措施
   - 定期备份审计跟踪记录

3. **审计跟踪审查**
   - 定期审查审计跟踪记录，识别异常活动
   - 分析审计跟踪数据，发现潜在问题
   - 生成审计报告，记录审查结果和发现

### 6.4 合规性检查与验证

#### 6.4.1 定期合规性检查

1. **检查内容**
   - 电子记录管理的合规性
   - 电子签名系统的合规性
   - 审计跟踪机制的合规性
   - 数据完整性控制的合规性
   - 系统维护流程的合规性

2. **检查频率**
   - 内部合规性检查：每月一次
   - 全面合规性检查：每季度一次
   - 外部合规性审计：每年一次

#### 6.4.2 合规性验证方法

1. **文档审查**
   - 审查系统维护文档和记录
   - 验证文档的完整性和准确性
   - 确保文档符合GMP要求

2. **系统测试**
   - 测试系统功能和性能
   - 验证电子记录和电子签名的功能
   - 测试审计跟踪机制的有效性

3. **流程验证**
   - 验证系统维护流程的执行情况
   - 检查流程是否符合规定要求
   - 识别并纠正流程中的问题

## 7️⃣ 系统升级与变更

### 7.1 变更管理流程

#### 7.1.1 变更申请

1. **变更申请内容**
   - 变更描述和目的
   - 变更范围和影响
   - 变更实施计划和时间
   - 回滚计划和风险评估

2. **变更申请表单**
   - 变更编号：HR-CHANGE-YYYYMMDD-XXX
   - 变更类型：功能增强/缺陷修复/性能优化/安全更新/配置变更
   - 变更提出人：姓名/部门
   - 变更审批人：IT运维总监/IT总监

#### 7.1.2 变更审批

1. **审批流程**
   - 低风险变更：系统管理员审批
   - 中风险变更：IT部门经理审批
   - 高风险变更：IT总监或CIO审批

2. **审批标准**
   - 变更必要性和合理性
   - 变更影响范围和风险
   - 变更实施计划的可行性
   - 回滚计划的完整性

#### 7.1.3 变更实施

1. **实施前准备**
   - 在测试环境验证变更
   - 制定详细的实施步骤和时间计划
   - 准备回滚方案和应急措施
   - 通知相关人员变更计划

2. **实施过程**
   - 在计划的维护窗口执行变更
   - 记录实施过程和结果
   - 执行验证测试，确保变更成功
   - 监控系统状态，及时处理问题

3. **实施后活动**
   - 更新系统文档和配置记录
   - 通知相关人员变更完成情况
   - 收集反馈，评估变更效果
   - 总结经验教训

### 7.2 系统升级流程

#### 7.2.1 升级准备

1. **升级评估**
   - 评估升级的必要性和风险
   - 分析升级对系统功能和性能的影响
   - 确定升级范围和内容

2. **升级计划**
   - 制定详细的升级计划和时间安排
   - 准备升级所需的资源和工具
   - 制定回滚计划和应急措施

3. **测试环境升级**
   - 在测试环境执行升级
   - 验证升级后的系统功能和性能
   - 修复测试过程中发现的问题

#### 7.2.2 升级实施

1. **升级前准备**
   - 执行完整的系统备份
   - 停止相关服务和应用
   - 准备升级安装包和脚本

2. **升级步骤**
   - 应用服务器升级
     ```bash
     $WL_HOME/common/bin/wlst.sh $DOMAIN_HOME/scripts/upgrade_app.py
     ```
   - 数据库升级
     ```sql
     @/path/to/upgrade_scripts/upgrade_db.sql
     ```
   - 配置文件更新
     ```bash
     cp /path/to/new_config/* /etc/app_config/
     ```

3. **升级验证**
   - 启动系统服务和应用
   - 执行功能和性能测试
   - 验证数据完整性
   - 检查系统日志，确认无错误

### 7.3 配置管理

#### 7.3.1 配置变更控制

1. **配置变更流程**
   - 提交配置变更申请
   - 评估配置变更的影响
   - 审批配置变更
   - 实施配置变更
   - 验证配置变更效果

2. **配置版本控制**
   - 记录所有配置变更
   - 维护配置版本历史
   - 确保配置版本可追溯

#### 7.3.2 配置备份与恢复

1. **配置备份**
   - 定期备份系统配置文件
   - 记录配置变更
   - 确保备份配置的完整性

2. **配置恢复**
   - 从备份恢复配置
   - 验证恢复后的配置
   - 确保系统使用正确的配置

## 8️⃣ 性能优化

### 8.1 系统性能监控

#### 8.1.1 监控指标

| 监控对象 | 关键指标 | 告警阈值 | 监控频率 |
|----------|----------|----------|----------|
| **服务器** | CPU使用率 | >80% | 实时 |
|  | 内存使用率 | >85% | 实时 |
|  | 磁盘I/O等待时间 | >200ms | 实时 |
|  | 磁盘空间使用率 | >85% | 每小时 |
| **应用服务器** | JVM堆内存使用率 | >85% | 实时 |
|  | 线程池使用率 | >90% | 实时 |
|  | 连接池使用率 | >90% | 实时 |
|  | 响应时间 | >5秒 | 实时 |
| **数据库** | 缓冲池命中率 | <95% | 每小时 |
|  | 锁等待数 | >10 | 每小时 |
|  | 长时间运行的查询 | >30秒 | 每小时 |
|  | 表空间使用率 | >90% | 每小时 |
| **网络** | 网络流量 | >带宽的80% | 实时 |
|  | 网络延迟 | >100ms | 实时 |
|  | 连接错误率 | >1% | 实时 |

#### 8.1.2 监控工具配置

1. **Zabbix监控配置**
   - 配置服务器、网络、应用监控项
   - 设置告警阈值和通知方式
   - 配置监控图表和报告

2. **应用性能监控(APM)配置**
   - 安装和配置APM代理
   - 设置应用性能监控参数
   - 配置性能数据收集和分析

### 8.2 性能调优方法

#### 8.2.1 服务器调优

1. **CPU调优**
   - 识别和优化CPU密集型进程
   - 调整进程优先级
   - 考虑增加CPU资源

2. **内存调优**
   - 调整操作系统内存分配
   - 优化应用程序内存使用
   - 考虑增加内存资源

3. **磁盘I/O调优**
   - 优化文件系统参数
   - 调整I/O调度器
   - 考虑使用更快的存储设备

#### 8.2.2 应用服务器调优

1. **JVM调优**
   - 调整堆内存大小和分配
   - 优化垃圾回收策略
   - 调整线程池和连接池大小

2. **WebLogic调优**
   - 调整WebLogic配置参数
   - 优化应用部署设置
   - 调整会话管理参数

#### 8.2.3 数据库调优

1. **查询优化**
   - 识别和优化慢查询
   - 调整SQL语句结构
   - 创建合适的索引

2. **索引优化**
   - 分析索引使用情况
   - 创建、修改或删除索引
   - 重建或重组索引

3. **参数调优**
   - 调整数据库内存参数
   - 优化缓冲区和缓存设置
   - 调整并发连接参数

4. **表结构优化**
   - 调整表分区策略
   - 优化表存储参数
   - 考虑表空间重组

### 8.3 性能问题诊断

#### 8.3.1 常见性能瓶颈分析

1. **CPU瓶颈分析**
   - 使用top、mpstat等工具识别CPU密集型进程
   - 分析应用程序CPU使用情况
   - 考虑负载均衡或增加资源

2. **内存瓶颈分析**
   - 使用free、vmstat等工具分析内存使用情况
   - 检查内存泄漏
   - 优化内存分配

3. **磁盘I/O瓶颈分析**
   - 使用iostat、sar等工具分析磁盘I/O性能
   - 识别I/O密集型操作
   - 优化文件系统和存储配置

4. **数据库瓶颈分析**
   - 使用Oracle AWR报告分析数据库性能
   - 识别慢查询和锁竞争
   - 优化数据库参数和SQL语句

#### 8.3.2 性能诊断工具

| 工具名称 | 用途 | 使用方法 |
|----------|------|----------|
| **top** | 实时监控系统资源使用情况 | `top -c` |
| **vmstat** | 监控系统虚拟内存、进程、CPU活动 | `vmstat 1 10` |
| **iostat** | 监控磁盘I/O性能 | `iostat -x 1 10` |
| **netstat** | 监控网络连接和统计信息 | `netstat -anp` |
| **Oracle AWR** | 生成数据库性能报告 | `@$ORACLE_HOME/rdbms/admin/awrrpt.sql` |
| **Oracle ADDM** | 自动诊断数据库性能问题 | `@$ORACLE_HOME/rdbms/admin/addmrpt.sql` |
| **WebLogic Console** | 监控WebLogic服务器状态和性能 | 通过浏览器访问 |
| **JConsole** | 监控JVM性能和内存使用情况 | `jconsole <进程ID>` |

## 9️⃣ 安全维护

### 9.1 安全策略管理

#### 9.1.1 访问控制管理

1. **用户管理**
   - 定期审查用户账户和权限
   - 删除或禁用未使用的账户
   - 确保最小权限原则的实施

2. **密码管理**
   - 实施强密码策略（长度、复杂度、过期时间）
   - 定期强制用户更改密码
   - 监控密码使用情况

3. **权限审查**
   - 定期审查用户权限分配
   - 验证权限分配是否符合业务需求
   - 调整不符合要求的权限设置

#### 9.1.2 数据安全管理

1. **数据加密**
   - 实施数据传输加密（SSL/TLS）
   - 考虑实施数据存储加密
   - 确保敏感数据的安全处理

2. **数据备份安全**
   - 确保备份数据的加密存储
   - 限制备份数据的访问权限
   - 验证备份数据的完整性

3. **敏感数据保护**
   - 识别和分类敏感数据
   - 实施敏感数据访问控制
   - 监控敏感数据使用情况

### 9.2 安全监控与审计

#### 9.2.1 安全事件监控

1. **安全日志监控**
   - 收集和分析安全日志
   - 设置安全事件告警
   - 监控异常活动和入侵尝试

2. **入侵检测**
   - 配置入侵检测系统
   - 监控网络和系统活动
   - 及时发现和处理安全威胁

3. **异常行为分析**
   - 分析用户和系统行为模式
   - 识别异常活动
   - 采取适当的响应措施

#### 9.2.2 安全审计

1. **定期安全审计**
   - 执行系统安全审计
   - 审查安全控制措施的有效性
   - 识别安全漏洞和风险

2. **合规性审计**
   - 执行GMP合规性审计
   - 确保系统符合安全法规和标准
   - 记录和解决合规性问题

3. **渗透测试**
   - 定期执行渗透测试
   - 评估系统安全防护能力
   - 修复发现的安全漏洞

### 9.3 安全更新与补丁管理

#### 9.3.1 补丁管理流程

1. **补丁获取与评估**
   - 定期检查安全公告和补丁发布
   - 评估补丁的重要性和适用性
   - 确定补丁安装优先级

2. **补丁测试与部署**
   - 在测试环境测试补丁
   - 制定补丁部署计划
   - 在维护窗口安装补丁

3. **补丁验证与记录**
   - 验证补丁安装效果
   - 记录补丁安装信息
   - 更新系统配置文档

#### 9.3.2 常见安全漏洞防护

1. **操作系统漏洞防护**
   - 及时安装操作系统安全补丁
   - 禁用不必要的服务和端口
   - 配置操作系统安全策略

2. **应用程序漏洞防护**
   - 及时安装应用程序安全补丁
   - 实施Web应用防火墙
   - 定期进行应用程序安全扫描

3. **数据库漏洞防护**
   - 及时安装数据库安全补丁
   - 限制数据库权限
   - 加密敏感数据

## 🔟 维护文档与知识管理

### 10.1 维护文档管理

#### 10.1.1 文档分类与组织

| 文档类别 | 文档名称 | 用途 | 存储位置 |
|----------|----------|------|----------|
| **维护计划** | 人事子系统维护计划 | 规定维护目标、策略、流程和规范 | /docs/hr/maintenance/ |
| **维护手册** | 人事子系统维护手册 | 提供系统维护的详细操作指南 | /docs/hr/maintenance/ |
| **故障处理** | 故障处理流程和记录 | 记录故障处理过程和解决方案 | /docs/hr/maintenance/fault_handling/ |
| **变更管理** | 变更申请和记录 | 记录系统变更的申请和执行情况 | /docs/hr/maintenance/change_management/ |
| **性能监控** | 性能监控报告 | 记录系统性能监控数据和分析 | /docs/hr/maintenance/performance_monitoring/ |
| **合规性文档** | GMP合规性检查记录 | 记录系统合规性检查结果 | /docs/hr/maintenance/compliance/ |
| **知识库** | 常见问题和解决方案 | 提供常见问题的解决方案 | /docs/hr/maintenance/knowledge_base/ |

#### 10.1.2 文档版本控制

- **版本号规则**：主版本号.次版本号.修订号（如v1.0.0）
- **版本管理**：使用文档管理系统进行版本控制
- **版本变更记录**：记录每个版本的变更内容、原因和审批人
- **版本审核**：新版本发布前必须经过相关负责人审核

### 10.2 知识库建设

#### 10.2.1 知识库内容

1. **常见问题解答**
   - 整理用户和维护人员常见问题
   - 提供详细的问题解答和解决方案
   - 定期更新和优化FAQ内容

2. **故障处理案例**
   - 记录典型故障案例和处理过程
   - 分析故障原因和解决方案
   - 提供预防措施和建议

3. **最佳实践文档**
   - 总结系统维护的最佳实践
   - 提供优化建议和性能调优方法
   - 分享成功经验和教训

#### 10.2.2 知识库管理

1. **知识收集**
   - 鼓励维护人员贡献知识内容
   - 从故障处理和系统维护中积累知识
   - 定期组织知识分享和交流活动

2. **知识审核**
   - 确保知识库内容的准确性和实用性
   - 定期审查和更新知识库内容
   - 验证解决方案的有效性

3. **知识分享**
   - 建立知识库访问机制
   - 定期培训和分享知识库内容
   - 鼓励团队成员使用和贡献知识库

## 1️⃣1️⃣ 常见问题与故障排除

### 11.1 应用服务器问题

#### 11.1.1 WebLogic无法启动

**问题症状**：
- WebLogic服务启动失败
- 启动日志中显示错误信息

**可能原因**：
- 端口被占用
- 内存不足
- 配置文件错误
- 数据库连接失败

**解决方案**：
1. 检查端口占用情况：
   ```bash
   netstat -tlnp | grep <端口号>
   ```
2. 增加JVM内存分配：
   ```bash
   # 修改$DOMAIN_HOME/bin/setDomainEnv.sh文件
   export JAVA_OPTS="$JAVA_OPTS -Xms8g -Xmx8g"
   ```
3. 检查配置文件：
   ```bash
   vi $DOMAIN_HOME/config/config.xml
   ```
4. 验证数据库连接：
   ```bash
   # 使用tnsping测试数据库连接
   tnsping orcl
   ```

#### 11.1.2 WebLogic性能下降

**问题症状**：
- 应用响应缓慢
- CPU或内存使用率高
- 连接池耗尽

**可能原因**：
- JVM参数配置不合理
- 连接池配置不足
- 内存泄漏
- 应用程序性能问题

**解决方案**：
1. 优化JVM参数：
   ```bash
   # 修改JVM参数
   export JAVA_OPTS="$JAVA_OPTS -XX:+UseG1GC -XX:MaxGCPauseMillis=200"
   ```
2. 增加连接池大小：
   - 通过WebLogic管理控制台调整连接池参数
3. 检查内存泄漏：
   ```bash
   # 使用jmap生成堆转储
   jmap -dump:format=b,file=heap.bin <进程ID>
   ```
4. 分析应用程序性能：
   - 使用性能分析工具识别性能瓶颈

### 11.2 数据库问题

#### 11.2.1 数据库连接失败

**问题症状**：
- 应用无法连接到数据库
- 数据库连接超时
- 连接错误日志

**可能原因**：
- 数据库服务未启动
- 网络连接问题
- 连接参数配置错误
- 数据库监听未启动

**解决方案**：
1. 检查数据库实例状态：
   ```sql
   SELECT instance_name, status FROM v$instance;
   ```
2. 检查数据库监听状态：
   ```bash
   lsnrctl status
   ```
3. 测试网络连接：
   ```bash
   ping <数据库服务器IP>
   tnsping orcl
   ```
4. 验证连接参数：
   - 检查应用数据源配置

#### 11.2.2 SQL查询性能问题

**问题症状**：
- 查询执行时间长
- 系统响应缓慢
- 数据库负载高

**可能原因**：
- SQL语句编写不优化
- 缺少必要的索引
- 统计信息过时
- 表数据量过大

**解决方案**：
1. 分析慢查询：
   ```sql
   SELECT sql_id, plan_hash_value, executions, elapsed_time/1000000 "Elapsed Time (s)",
          buffer_gets, disk_reads, rows_processed,
          sql_text
   FROM v$sql
   WHERE elapsed_time > 10000000
   ORDER BY elapsed_time DESC;
   ```
2. 创建或优化索引：
   ```sql
   CREATE INDEX emp_name_idx ON employee(employee_name);
   ```
3. 更新统计信息：
   ```sql
   EXEC DBMS_STATS.GATHER_TABLE_STATS('HR', 'EMPLOYEE', CASCADE => TRUE);
   ```
4. 优化SQL语句：
   - 重写低效SQL语句
   - 使用适当的JOIN类型
   - 避免全表扫描

### 11.3 网络问题

#### 11.3.1 网络连接中断

**问题症状**：
- 客户端无法访问服务器
- 系统间通信失败
- 连接超时错误

**可能原因**：
- 网络设备故障
- 网络配置错误
- 防火墙阻断
- 网络拥塞

**解决方案**：
1. 检查网络设备状态：
   ```bash
   ping <网关IP>
   traceroute <目标IP>
   ```
2. 检查防火墙配置：
   ```bash
   iptables -L -n
   ```
3. 检查网络配置：
   ```bash
   ifconfig
   route -n
   ```
4. 重启网络服务：
   ```bash
   systemctl restart network
   ```

#### 11.3.2 网络性能问题

**问题症状**：
- 网络传输速度慢
- 数据包丢失
- 延迟高

**可能原因**：
- 网络带宽不足
- 网络设备性能瓶颈
- 网络配置不合理
- 网络拥塞

**解决方案**：
1. 测试网络带宽：
   ```bash
   iperf -c <服务器IP>
   ```
2. 分析网络流量：
   ```bash
   tcpdump -i eth0 -nn
   ```
3. 优化网络配置：
   - 调整MTU值
   - 优化路由设置
4. 考虑网络升级：
   - 增加带宽
   - 升级网络设备

### 11.4 应用功能问题

#### 11.4.1 用户登录失败

**问题症状**：
- 用户无法登录系统
- 登录页面提示错误
- 认证失败日志

**可能原因**：
- 用户名或密码错误
- 用户账户被锁定
- 认证服务故障
- 权限配置错误

**解决方案**：
1. 验证用户凭据：
   - 确认用户名和密码正确性
2. 检查账户状态：
   ```sql
   SELECT username, account_status FROM dba_users WHERE username = 'HR_USER';
   ```
3. 解锁用户账户：
   ```sql
   ALTER USER hr_user ACCOUNT UNLOCK;
   ```
4. 重置用户密码：
   ```sql
   ALTER USER hr_user IDENTIFIED BY new_password;
   ```

#### 11.4.2 报表生成失败

**问题症状**：
- 报表生成超时
- 报表内容错误
- 报表生成异常日志

**可能原因**：
- 数据源连接问题
- 报表SQL错误
- 数据量大导致超时
- 报表模板问题

**解决方案**：
1. 检查数据源连接：
   - 验证数据库连接是否正常
2. 分析报表SQL：
   - 检查SQL语法和逻辑
3. 优化报表查询：
   - 添加必要的索引
   - 重写复杂查询
4. 增加超时设置：
   - 调整应用服务器超时参数

## 1️⃣2️⃣ 附录

### 12.1 系统架构图

**人事子系统整体架构图**：

```
客户端层
  │
  │ HTTPS/HTTP
  ▼
Web层
  │ Apache/Nginx
  │
  │ HTTP/HTTPS
  ▼
应用层
  │ WebLogic Application Server
  │
  │ JDBC
  ▼
数据层
  │ Oracle Database
  │
  │
  ▼
存储层
    SAN/NAS Storage
```

### 12.2 数据库表结构

**核心表结构概览**：

| 表名 | 描述 | 主键 | 外键 |
|------|------|------|------|
| **EMPLOYEE** | 员工基本信息 | EMPLOYEE_ID | DEPARTMENT_ID, POSITION_ID |
| **DEPARTMENT** | 部门信息 | DEPARTMENT_ID | PARENT_DEPARTMENT_ID |
| **POSITION** | 岗位信息 | POSITION_ID | DEPARTMENT_ID |
| **ATTENDANCE** | 考勤记录 | ATTENDANCE_ID | EMPLOYEE_ID, SCHEDULE_ID |
| **SCHEDULE** | 排班信息 | SCHEDULE_ID | DEPARTMENT_ID |
| **LEAVE** | 请假记录 | LEAVE_ID | EMPLOYEE_ID, LEAVE_TYPE_ID |
| **SALARY_STRUCTURE** | 薪资结构 | STRUCTURE_ID | - |
| **PAYROLL** | 薪资计算结果 | PAYROLL_ID | EMPLOYEE_ID, STRUCTURE_ID |
| **USER** | 系统用户 | USER_ID | EMPLOYEE_ID |
| **ROLE** | 角色信息 | ROLE_ID | - |
| **PERMISSION** | 权限信息 | PERMISSION_ID | - |
| **USER_ROLE** | 用户角色关联 | USER_ID, ROLE_ID | USER_ID, ROLE_ID |
| **ROLE_PERMISSION** | 角色权限关联 | ROLE_ID, PERMISSION_ID | ROLE_ID, PERMISSION_ID |
| **AUDIT_LOG** | 审计日志 | LOG_ID | USER_ID, ACTION_ID |

### 12.3 配置参数参考

#### 12.3.1 WebLogic关键配置参数

| 参数名 | 默认值 | 推荐值 | 说明 |
|--------|--------|--------|------|
| **Heap Size (min/max)** | 512m/1024m | 8g/8g | JVM堆内存大小 |
| **PermGen/Metaspace** | 256m/256m | 256m/512m | 永久代/元空间大小 |
| **Connection Pool Size** | 15/25 | 50/100 | 数据库连接池大小 |
| **Thread Count** | 25 | 50 | 工作线程数量 |
| **Session Timeout** | 3600 | 1800 | 会话超时时间(秒) |
| **JTA Transaction Timeout** | 30 | 60 | JTA事务超时时间(秒) |

#### 12.3.2 Oracle关键配置参数

| 参数名 | 默认值 | 推荐值 | 说明 |
|--------|--------|--------|------|
| **SGA_TARGET** | 自动管理 | 128g | 系统全局区大小 |
| **PGA_AGGREGATE_TARGET** | 自动管理 | 64g | 程序全局区大小 |
| **PROCESSES** | 300 | 1000 | 最大进程数 |
| **OPEN_CURSORS** | 300 | 1000 | 最大打开游标数 |
| **PGA_AGGREGATE_LIMIT** | 自动管理 | 96g | PGA聚合限制 |
| **DB_CACHE_SIZE** | 自动管理 | 64g | 数据库高速缓存大小 |
| **SHARED_POOL_SIZE** | 自动管理 | 16g | 共享池大小 |

### 12.4 常用维护命令

#### 12.4.1 操作系统命令

| 命令 | 用途 | 示例 |
|------|------|------|
| **top** | 实时监控系统资源 | `top -c` |
| **free** | 查看内存使用情况 | `free -h` |
| **df** | 查看磁盘使用情况 | `df -h` |
| **netstat** | 查看网络连接 | `netstat -tlnp` |
| **ps** | 查看进程状态 | `ps -ef | grep java` |
| **vmstat** | 查看虚拟内存统计 | `vmstat 1 10` |
| **iostat** | 查看I/O统计 | `iostat -x 1 10` |
| **tail** | 查看日志文件 | `tail -f /path/to/log/file` |

#### 12.4.2 WebLogic命令

| 命令 | 用途 | 示例 |
|------|------|------|
| **startWebLogic.sh** | 启动WebLogic管理服务器 | `$DOMAIN_HOME/bin/startWebLogic.sh` |
| **stopWebLogic.sh** | 停止WebLogic管理服务器 | `$DOMAIN_HOME/bin/stopWebLogic.sh` |
| **startManagedWebLogic.sh** | 启动WebLogic受管服务器 | `$DOMAIN_HOME/bin/startManagedWebLogic.sh server1` |
| **stopManagedWebLogic.sh** | 停止WebLogic受管服务器 | `$DOMAIN_HOME/bin/stopManagedWebLogic.sh server1` |
| **wlst.sh** | WebLogic脚本工具 | `$WL_HOME/common/bin/wlst.sh script.py` |

#### 12.4.3 Oracle命令

| 命令 | 用途 | 示例 |
|------|------|------|
| **sqlplus** | Oracle SQL命令行工具 | `sqlplus sys/password@orcl as sysdba` |
| **rman** | Oracle备份恢复工具 | `rman target sys/password@orcl` |
| **impdp** | 数据泵导入 | `impdp system/password@orcl schemas=hr dumpfile=hr.dmp` |
| **expdp** | 数据泵导出 | `expdp system/password@orcl schemas=hr dumpfile=hr.dmp` |
| **tnsping** | 测试TNS连接 | `tnsping orcl` |
| **lsnrctl** | 监听控制工具 | `lsnrctl status` |

### 12.5 联系方式

| 角色 | 姓名 | 部门 | 联系电话 | 电子邮箱 |
|------|------|------|----------|----------|
| **IT运维总监** | 李刚 | IT部 | 13800138000 | ligang@company.com |
| **系统管理员** | 张明 | IT部 | 13900139000 | zhangming@company.com |
| **数据库管理员** | 王芳 | IT部 | 13700137000 | wangfang@company.com |
| **网络管理员** | 刘强 | IT部 | 13600136000 | liuqiang@company.com |
| **应用维护工程师** | 赵雪 | IT部 | 13500135000 | zhaoxue@company.com |
| **技术支持热线** | - | IT部 | 400-800-8888 | support@company.com |

---

*本维护手册由GMP环境下人事管理子系统IT运维团队编制

## 1️⃣3️⃣ 文档版本历史

| 版本号 | 修改日期 | 修改内容 | 修改人 | 审核人 |
|--------|----------|----------|--------|--------|
| v1.0.0 | 2025-11-01 | 初始版本 | IT运维团队 | 李刚 |
| v1.0.1 | 2025-11-15 | 更新备份策略和恢复流程 | 张明 | 李刚 |
| v1.1.0 | 2025-12-01 | 添加性能优化章节，更新监控指标 | 王芳 | 李刚 |
| v1.1.1 | 2026-01-10 | 修正系统架构图，更新联系方式 | 刘强 | 李刚 |

## 1️⃣4️⃣ 参考文献

1. 《GMP药品生产质量管理规范》(2010年修订版)
2. 《计算机化系统验证与确认指南》(2020版)
3. 《Oracle数据库管理与维护手册》
4. 《WebLogic Server 管理指南》
5. 《Linux系统管理最佳实践》
6. 《信息安全技术 信息系统安全等级保护基本要求》(GB/T 22239-2019)

## 1️⃣5️⃣ 免责声明

本维护手册仅供GMP环境下人事管理子系统的维护人员参考使用。在执行任何维护操作前，请确保已充分理解相关操作的风险和影响，并严格遵循本手册中的操作步骤和注意事项。对于因未按本手册要求操作或操作不当导致的任何损失，编制单位不承担任何责任。

---

*文档编制完成日期：2025年11月*
*文档生效日期：2025年11月15日*
*文档受控编号：HR-MANUAL-MAINT-v1.0.0*