# 📋 人事子系统维护指南

## 🔍 文档信息

| 文档标题 | 人事子系统维护指南 |
|---------|------------------|
| 文档编号 | HR-GUIDE-MAINT |
| 当前版本 | v1.0.0 |
| 发布日期 | 2025-11-10 |
| 生效日期 | 2025-11-15 |
| 编制部门 | IT运维部 |
| 审核人 | 李刚 |
| 批准人 | 王总 |
| 文档状态 | 受控 |
| 保密级别 | 内部使用 |

## 📝 指南说明

### 目的
本文档旨在为GMP环境下人事管理子系统的维护人员提供全面、详细的操作指南，确保维护工作符合GMP规范和IT运维最佳实践，保障系统稳定、安全、高效运行，同时满足监管合规要求。

### 适用范围
适用于GMP环境下人事管理子系统的所有维护活动，包括日常维护、故障处理、备份恢复、系统升级、性能优化和安全维护等。

### 术语定义
- **GMP**: 药品生产质量管理规范 (Good Manufacturing Practice)
- **系统**: 指GMP环境下人事管理子系统
- **维护人员**: 负责系统日常维护、故障处理和性能监控的IT运维人员
- **变更管理**: 对系统进行的任何修改或调整，包括配置变更、代码修改和数据更新等
- **电子记录**: 系统中存储的各类人事相关记录，如员工档案、考勤记录、培训记录等
- **审计跟踪**: 系统自动记录的用户操作和系统事件日志
- **验证**: 证明系统能够满足预期用途和GMP要求的活动

## 🖥️ 系统概述

### 系统架构
- **数据库**: Oracle 19c
- **应用服务器**: WebLogic Server 14c
- **前端框架**: Angular 15
- **中间件**: Spring Boot 2.7
- **集成接口**: RESTful API, SOAP WebService

### 关键组件与依赖
1. **核心应用组件**：员工管理模块、考勤管理模块、薪资管理模块、培训管理模块、绩效管理模块
2. **基础设施**：数据库服务器、应用服务器、负载均衡器、备份服务器
3. **外部集成**：ERP系统、邮件服务器、短信平台、考勤打卡设备

## 📊 维护活动分类

### 预防性维护
定期执行的维护活动，旨在预防系统故障和性能下降，包括：
- 数据库维护
- 应用服务器维护
- 系统备份
- 安全漏洞扫描
- 性能监控与优化

### 纠正性维护
当系统出现故障或异常时执行的维护活动，包括：
- 故障诊断与修复
- 数据恢复
- 服务重启与恢复

### 适应性维护
为适应业务需求或环境变化而执行的维护活动，包括：
- 系统配置调整
- 接口参数更新
- 报表格式修改

### 完善性维护
为提升系统功能、性能或用户体验而执行的维护活动，包括：
- 功能增强
- 性能优化
- 用户界面改进

## 🔧 日常维护操作

### 每日维护任务
1. **系统状态检查**
   - 检查所有服务器的运行状态和资源使用情况
   - 验证数据库连接和服务可用性
   - 检查应用服务器和Web服务的运行状态
   - 确认备份任务完成情况

2. **日志监控与分析**
   - 审查系统日志中的错误和警告信息
   - 分析数据库性能日志
   - 检查安全日志中的异常访问记录
   - 监控审计跟踪数据的完整性

3. **性能监控**
   - 监控CPU、内存、磁盘空间和网络使用率
   - 监控数据库性能指标
   - 监控应用响应时间和并发用户数

### 每周维护任务
1. **数据备份验证**
   - 随机抽取备份文件进行恢复测试
   - 验证备份数据的完整性和可用性
   - 检查备份日志中的错误信息

2. **安全维护**
   - 检查账户锁定和权限异常情况
   - 审查安全策略执行情况
   - 更新病毒库和入侵检测规则

3. **性能优化**
   - 清理临时文件和日志文件
   - 重新组织数据库索引
   - 优化数据库查询性能

### 每月维护任务
1. **系统健康检查**
   - 执行全面的系统健康检查
   - 评估系统性能趋势和潜在风险
   - 生成月度系统运行报告

2. **数据归档与清理**
   - 按照数据保留策略归档历史数据
   - 清理过期的临时数据和日志文件
   - 优化数据库存储空间

3. **安全审计**
   - 执行安全漏洞扫描
   - 审查用户访问记录和权限变更
   - 更新安全配置和补丁

## 🚨 故障处理流程

### 故障分类与优先级

| 优先级 | 故障类型 | 定义 | 响应时间 | 解决时间 |
|--------|----------|------|----------|----------|
| P0 | 系统瘫痪 | 系统完全不可用 | 立即 | 4小时内 |
| P1 | 严重功能故障 | 核心功能严重受损 | 30分钟内 | 8小时内 |
| P2 | 一般功能故障 | 非核心功能受损或部分用户受影响 | 2小时内 | 24小时内 |
| P3 | 性能问题 | 系统运行缓慢但功能可用 | 4小时内 | 48小时内 |
| P4 | 轻微问题 | 界面异常或非关键功能轻微影响 | 24小时内 | 5个工作日内 |

### 故障报告
当发现系统故障时，维护人员应：
1. 记录故障的详细信息，包括：
   - 故障发生时间
   - 故障现象描述
   - 影响范围和用户数
   - 系统环境和操作步骤
2. 评估故障优先级
3. 通知相关人员（系统管理员、业务负责人等）

### 故障诊断
维护人员应按照以下步骤进行故障诊断：
1. **收集信息**
   - 系统日志（应用日志、数据库日志、操作系统日志）
   - 网络状态信息
   - 资源使用情况（CPU、内存、磁盘、网络）
   - 用户操作记录

2. **隔离故障**
   - 确定故障的具体组件和模块
   - 排除外部因素（网络、硬件等）
   - 重现故障场景

3. **分析根因**
   - 分析日志中的错误信息
   - 检查配置参数和设置
   - 验证数据完整性
   - 检查依赖服务的状态

### 故障解决
1. **制定解决方案**
   - 基于故障根因制定修复方案
   - 评估修复方案的风险和影响
   - 准备回滚计划

2. **执行修复**
   - 在测试环境验证修复方案（如条件允许）
   - 在生产环境执行修复
   - 监控修复过程中的系统状态

3. **验证修复**
   - 确认故障是否完全解决
   - 验证相关功能是否正常
   - 检查系统性能是否恢复正常

### 故障记录与报告
维护人员应详细记录故障处理的全过程：
1. 故障描述和影响范围
2. 故障诊断过程和发现
3. 修复方案和执行过程
4. 验证结果和恢复时间
5. 预防措施和经验教训

月度故障统计报告应包含：
- 故障数量和分类统计
- 平均响应时间和解决时间
- 常见故障类型分析
- 改进建议

## 💾 系统备份与恢复

### 备份策略

| 备份类型 | 备份频率 | 备份内容 | 保留期限 |
|----------|----------|----------|----------|
| 完整备份 | 每周一次 | 整个数据库 | 6个月 |
| 增量备份 | 每天一次 | 自上次备份以来的变更 | 1个月 |
| 事务日志备份 | 每15分钟 | 事务日志 | 2周 |
| 配置备份 | 每次变更 | 应用配置文件 | 1年 |
| 文件备份 | 每周一次 | 应用程序文件 | 3个月 |

### 备份执行
1. **数据库备份**
   ```sql
   -- Oracle RMAN备份命令示例
   BACKUP DATABASE PLUS ARCHIVELOG;
   
   -- 事务日志备份
   BACKUP ARCHIVELOG ALL;
   ```

2. **配置文件备份**
   ```bash
   # 备份WebLogic配置
   tar -czvf /backup/weblogic_config_$(date +%Y%m%d).tar.gz $DOMAIN_HOME/config
   
   # 备份应用配置文件
   tar -czvf /backup/app_config_$(date +%Y%m%d).tar.gz $DOMAIN_HOME/apps/hr/config
   ```

3. **备份验证**
   - 检查备份日志确认备份成功完成
   - 验证备份文件大小和完整性
   - 定期执行备份恢复测试

### 恢复流程

#### 数据库恢复
1. **确定恢复点**
   - 根据故障时间和数据丢失情况确定恢复点
   - 准备相应的备份文件

2. **执行恢复操作**
   ```sql
   -- Oracle数据库恢复命令示例
   RMAN> STARTUP MOUNT;
   RMAN> RESTORE DATABASE FROM TAG 'WEEKLY_FULL';
   RMAN> RECOVER DATABASE USING BACKUP CONTROLFILE UNTIL TIME 'YYYY-MM-DD:HH24:MI:SS';
   RMAN> ALTER DATABASE OPEN RESETLOGS;
   ```

3. **验证恢复结果**
   - 检查数据库连接和服务可用性
   - 验证关键业务数据的完整性
   - 运行数据一致性检查脚本

#### 应用恢复
1. **停止应用服务**
   ```bash
   $DOMAIN_HOME/bin/stopWebLogic.sh
   ```

2. **恢复应用文件和配置**
   ```bash
   # 恢复应用文件
   tar -xzvf /backup/app_files_YYYYMMDD.tar.gz -C $DOMAIN_HOME/apps/
   
   # 恢复配置文件
   tar -xzvf /backup/app_config_YYYYMMDD.tar.gz -C $DOMAIN_HOME/apps/hr/
   ```

3. **启动应用服务**
   ```bash
   $DOMAIN_HOME/bin/startWebLogic.sh
   ```

4. **验证应用功能**
   - 访问应用程序主页验证服务启动
   - 测试关键业务流程和功能
   - 监控应用日志确认正常运行

## 🔄 系统升级与变更

### 变更管理流程
1. **变更申请**
   - 填写变更申请表，包括变更内容、目的、影响范围和风险评估
   - 提交变更申请给变更管理委员会审批

2. **变更计划**
   - 制定详细的实施计划，包括准备工作、执行步骤、回滚计划和验证方法
   - 安排在非工作时间进行系统变更
   - 提前通知相关用户和利益相关者

3. **变更实施**
   - 备份当前系统状态和数据
   - 按照计划执行变更操作
   - 记录实施过程中的所有操作和异常

4. **变更验证**
   - 验证变更是否符合预期
   - 测试相关功能是否正常
   - 确认系统性能和稳定性

5. **变更关闭**
   - 更新变更记录和文档
   - 总结经验教训
   - 关闭变更工单

### 系统升级
1. **升级前准备**
   - 制定详细的升级计划和测试计划
   - 准备升级所需的软件包、补丁和脚本
   - 备份当前系统状态和数据
   - 在测试环境进行升级测试

2. **升级执行**
   - 停止应用服务
   - 升级数据库结构和数据（如有必要）
   - 升级应用程序文件
   - 更新配置文件和参数
   - 启动应用服务

3. **升级后验证**
   - 进行全面的功能测试
   - 执行性能测试和压力测试
   - 验证数据完整性和一致性
   - 检查系统日志中的错误信息

4. **升级后监控**
   - 密切监控系统性能和稳定性
   - 收集用户反馈
   - 准备回滚方案（如有必要）

## 📈 性能优化

### 性能监控指标

| 监控对象 | 关键指标 | 正常阈值 | 告警阈值 |
|----------|----------|----------|----------|
| 服务器CPU | 使用率 | <70% | >85% |
| 服务器内存 | 使用率 | <75% | >90% |
| 磁盘空间 | 使用率 | <80% | >90% |
| 磁盘I/O | 等待时间 | <10ms | >50ms |
| 数据库连接 | 活跃连接数 | <80%最大连接数 | >90%最大连接数 |
| 数据库响应时间 | SQL执行时间 | <1s | >3s |
| 应用响应时间 | 页面加载时间 | <3s | >5s |
| 并发用户数 | 实际用户数 | - | >预期峰值的80% |

### 数据库性能优化
1. **索引优化**
   - 检查执行计划，识别缺少索引的查询
   - 为频繁查询的列创建适当的索引
   - 定期重建和收集索引统计信息

2. **查询优化**
   - 重写低效的SQL查询
   - 避免全表扫描和不必要的连接
   - 使用绑定变量减少解析时间

3. **资源分配**
   - 调整共享池、缓冲区高速缓存和PGA大小
   - 优化I/O分布和表空间设计
   - 配置适当的并行度

### 应用服务器优化
1. **JVM优化**
   - 调整堆内存大小和垃圾回收策略
   - 监控内存使用和GC活动
   - 优化线程池配置

2. **WebLogic优化**
   - 调整连接池和数据源参数
   - 优化会话管理和缓存配置
   - 配置适当的JMS队列和线程池

3. **前端性能优化**
   - 压缩和合并CSS/JavaScript文件
   - 优化图片资源
   - 使用浏览器缓存和CDN

## 🔒 安全维护

### 用户权限管理
1. **用户账户管理**
   - 定期审查用户账户，删除或禁用过期账户
   - 实施最小权限原则
   - 监控权限变更和异常访问

2. **密码策略**
   - 强制密码复杂性和定期更换
   - 实施账户锁定机制
   - 使用多因素认证（关键账户）

### 安全配置
1. **系统加固**
   - 禁用不必要的服务和端口
   - 更新操作系统和应用程序补丁
   - 配置防火墙规则和访问控制列表

2. **加密措施**
   - 使用SSL/TLS加密网络通信
   - 加密敏感数据存储
   - 安全存储加密密钥和证书

### 安全审计
1. **日志审计**
   - 收集和分析安全日志
   - 监控异常登录和操作行为
   - 定期审查用户活动记录

2. **漏洞管理**
   - 定期执行安全漏洞扫描
   - 及时修复发现的安全漏洞
   - 进行渗透测试（每年至少一次）

## 📚 GMP合规性维护

### 电子记录管理
1. **记录完整性**
   - 确保所有关键操作都被记录
   - 防止未授权修改电子记录
   - 保护记录免受意外删除或损坏

2. **记录保留**
   - 按照GMP要求保留电子记录
   - 定期验证记录的可读性和完整性
   - 实施适当的备份和归档策略

### 审计跟踪管理
1. **审计跟踪配置**
   - 配置系统自动记录所有关键操作
   - 确保审计跟踪包含必要的信息（谁、什么、何时、何地、为何）
   - 保护审计跟踪数据的完整性

2. **审计跟踪审查**
   - 定期审查审计跟踪数据
   - 分析异常模式和可疑活动
   - 记录审查结果并报告发现的问题

### 系统验证维护
1. **变更验证**
   - 为重大变更执行验证活动
   - 记录验证测试结果
   - 更新验证文档

2. **定期再验证**
   - 按照预定计划执行系统再验证
   - 验证系统持续符合GMP要求
   - 更新再验证报告

## 💬 沟通与协作

### 维护团队沟通
1. **日常沟通**
   - 维护团队例会（每周一次）
   - 维护工作交接流程和文档
   - 内部知识库和问题跟踪系统

2. **紧急沟通**
   - 建立紧急联系机制和升级流程
   - 使用即时通讯工具进行快速沟通
   - 定期测试紧急响应机制

### 与业务部门协作
1. **需求收集**
   - 定期收集业务部门的系统需求和反馈
   - 参与业务流程改进讨论
   - 评估需求对系统的影响

2. **变更协调**
   - 与业务部门协调系统变更时间
   - 提供变更预告和影响说明
   - 收集变更后的用户反馈

## 📋 常见问题与解决方案

### 数据库相关问题

| 问题描述 | 可能原因 | 解决方案 |
|----------|----------|----------|
| 数据库连接失败 | 数据库服务未启动 | 启动数据库服务 |
| | 连接参数错误 | 检查并修正连接参数 |
| | 连接池耗尽 | 增加连接池大小或优化连接使用 |
| SQL执行缓慢 | 缺少必要索引 | 创建适当的索引 |
| | 查询语句低效 | 优化SQL查询 |
| | 数据库统计信息过时 | 更新统计信息 |
| 数据库空间不足 | 表空间使用率过高 | 扩展表空间或归档历史数据 |
| | 临时表空间过大 | 清理临时表空间 |

### 应用服务器相关问题

| 问题描述 | 可能原因 | 解决方案 |
|----------|----------|----------|
| 应用服务启动失败 | JVM内存不足 | 调整JVM内存参数 |
| | 配置文件错误 | 检查并修正配置文件 |
| | 端口冲突 | 修改端口配置或停止占用端口的进程 |
| 应用响应缓慢 | 线程池配置不当 | 调整线程池大小 |
| | 连接资源泄漏 | 检查并修复资源泄漏问题 |
| | 缓存配置不合理 | 优化缓存策略 |
| 应用崩溃 | 内存溢出 | 分析堆转储，修复内存泄漏 |
| | 代码异常 | 分析错误日志，修复异常处理 |
| | 外部依赖故障 | 检查并恢复外部服务 |

### 网络与安全问题

| 问题描述 | 可能原因 | 解决方案 |
|----------|----------|----------|
| 网络连接中断 | 网络设备故障 | 检查网络设备状态 |
| | 防火墙配置 | 检查防火墙规则和网络ACL |
| | 网络带宽饱和 | 优化网络流量或增加带宽 |
| 用户登录失败 | 密码错误 | 重置用户密码 |
| | 账户锁定 | 解锁用户账户 |
| | 权限配置错误 | 检查用户权限配置 |
| 安全告警 | 可疑登录尝试 | 审查登录日志，更新安全策略 |
| | 病毒或恶意软件 | 执行病毒扫描，更新安全软件 |
| | 系统漏洞 | 应用安全补丁 |

## 📝 附录

### 系统架构图

```
+----------------+     +------------------+     +----------------+
|  客户端浏览器  | <-> |  Web服务器集群   | <-> | 应用服务器集群 |
+----------------+     +------------------+     +----------------+
                                                       |
                                                       v
+----------------+     +------------------+     +----------------+
| 外部系统集成   | <-> |  数据库服务器    | <-> |  文件存储系统  |
+----------------+     +------------------+     +----------------+
                                                       |
                                                       v
+----------------+     +------------------+     +----------------+
|  备份服务器    | <-> |  监控服务器      | <-> |  日志服务器    |
+----------------+     +------------------+     +----------------+
```

### 常用命令参考

#### 数据库管理命令
```sql
-- 连接数据库
CONNECT username/password@database

-- 查看表空间使用情况
SELECT tablespace_name, SUM(bytes)/1024/1024 MB, SUM(maxbytes)/1024/1024 MAX_MB,
       (SUM(bytes)/SUM(maxbytes))*100 PERCENT_USED
FROM dba_data_files
GROUP BY tablespace_name;

-- 查看活跃会话
SELECT username, program, machine, status, COUNT(*) FROM v$session
GROUP BY username, program, machine, status;
```

#### 应用服务器管理命令
```bash
# 启动WebLogic服务器
$DOMAIN_HOME/bin/startWebLogic.sh

# 停止WebLogic服务器
$DOMAIN_HOME/bin/stopWebLogic.sh

# 启动节点管理器
$DOMAIN_HOME/bin/startNodeManager.sh

# 查看JVM状态
jstat -gcutil $JAVA_PID
```

#### 操作系统监控命令
```bash
# 查看CPU和内存使用情况
top

# 查看磁盘使用情况
df -h

# 查看网络连接
netstat -an

# 查看进程
ps -ef | grep java
```

### 维护联系人

| 角色 | 姓名 | 电话 | 邮箱 | 负责范围 |
|------|------|------|------|----------|
| 系统管理员 | 张明 | 13800138001 | zhangming@company.com | 日常维护、故障处理 |
| 数据库管理员 | 王芳 | 13800138002 | wangfang@company.com | 数据库维护、性能优化 |
| 应用开发人员 | 刘强 | 13800138003 | liuqiang@company.com | 应用问题修复、代码优化 |
| 安全专员 | 陈静 | 13800138004 | chenjing@company.com | 安全审计、合规性检查 |
| IT经理 | 李刚 | 13800138005 | ligang@company.com | 维护管理、资源协调 |

### 服务支持信息

| 服务类型 | 支持时间 | 联系方式 | 响应时间 |
|----------|----------|----------|----------|
| 日常维护 | 工作日8:00-18:00 | 内线：8888 | 2小时内 |
| 紧急故障 | 24小时 | 手机：13800138001 | 30分钟内 |
| 应用咨询 | 工作日9:00-17:00 | 邮箱：hr-support@company.com | 4小时内 |
| 供应商支持 | 工作日9:00-18:00 | 电话：400-888-8888 | 4小时内 |

---

*本维护指南由GMP环境下人事管理子系统IT运维团队编制*