# äººäº‹ç®¡ç†å­ç³»ç»Ÿ - å®ç°æ–¹æ¡ˆ

## ğŸ“‹ æ–‡æ¡£ä¿¡æ¯

| å±æ€§ | å€¼ |
|------|---|
| æ–‡æ¡£æ ‡é¢˜ | äººäº‹ç®¡ç†å­ç³»ç»Ÿ - å®ç°æ–¹æ¡ˆ |
| ç‰ˆæœ¬å· | v0.1.0-draft |
| åˆ›å»ºæ—¥æœŸ | 2025å¹´11æœˆ20æ—¥ |
| æ›´æ–°æ—¥æœŸ | 2025å¹´11æœˆ20æ—¥ |
| ä½œè€… | GMPç³»ç»Ÿå¼€å‘å›¢é˜Ÿ |
| çŠ¶æ€ | è‰ç¨¿ |

## 1ï¸âƒ£ æŠ€æœ¯é€‰å‹ä¸æ¶æ„

### 1.1 æŠ€æœ¯æ ˆé€‰æ‹©

| åˆ†ç±» | æŠ€æœ¯/æ¡†æ¶ | ç‰ˆæœ¬ | é€‰å‹ç†ç”± |
|------|----------|------|----------|
| åç«¯æ¡†æ¶ | Spring Boot | 3.2.x | ä¼ä¸šçº§Javaåº”ç”¨å¼€å‘æ¡†æ¶ï¼Œç”Ÿæ€æˆç†Ÿï¼Œæ”¯æŒå¾®æœåŠ¡æ¶æ„ï¼Œå…·æœ‰ä¸°å¯Œçš„ä¸­é—´ä»¶é›†æˆèƒ½åŠ› |
| ORMæ¡†æ¶ | Spring Data JPA | 3.2.x | ç®€åŒ–æ•°æ®åº“æ“ä½œï¼Œæä¾›å¯¹è±¡å…³ç³»æ˜ å°„èƒ½åŠ›ï¼Œæ”¯æŒå¤æ‚æŸ¥è¯¢å’Œäº‹åŠ¡ç®¡ç† |
| æ•°æ®åº“ | PostgreSQL | 14.x | å¼ºå¤§çš„å¼€æºå…³ç³»å‹æ•°æ®åº“ï¼Œæ”¯æŒå¤æ‚æŸ¥è¯¢ã€JSONæ•°æ®ç±»å‹ï¼Œäº‹åŠ¡ä¸€è‡´æ€§å¥½ï¼Œé€‚åˆGMPåˆè§„æ€§è¦æ±‚ |
| ç¼“å­˜ | Redis | 7.x | é«˜æ€§èƒ½å†…å­˜æ•°æ®åº“ï¼Œç”¨äºç¼“å­˜çƒ­ç‚¹æ•°æ®ã€ä¼šè¯ç®¡ç†å’Œåˆ†å¸ƒå¼é”ï¼Œæå‡ç³»ç»Ÿå“åº”é€Ÿåº¦ |
| èº«ä»½è®¤è¯ | Spring Security + JWT | 6.x | æˆç†Ÿçš„å®‰å…¨æ¡†æ¶ï¼Œä¸Spring Bootæ— ç¼é›†æˆï¼Œæ”¯æŒåŸºäºJWTçš„æ— çŠ¶æ€è®¤è¯ |
| APIæ–‡æ¡£ | SpringDoc OpenAPI | 2.2.x | è‡ªåŠ¨ç”ŸæˆAPIæ–‡æ¡£ï¼Œæ”¯æŒåœ¨çº¿æµ‹è¯•ï¼Œä¾¿äºå‰åç«¯åä½œ |
| æ¶ˆæ¯é˜Ÿåˆ— | RabbitMQ | 3.12.x | å¯é çš„æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œç”¨äºå¼‚æ­¥å¤„ç†ã€äº‹ä»¶é©±åŠ¨å’Œç³»ç»Ÿè§£è€¦ |
| å‰ç«¯æ¡†æ¶ | Vue.js | 3.x | è½»é‡çº§ã€é«˜æ€§èƒ½çš„æ¸è¿›å¼å‰ç«¯æ¡†æ¶ï¼Œç»„ä»¶åŒ–å¼€å‘ï¼Œé€‚åˆæ„å»ºå¤æ‚çš„ä¼ä¸šåº”ç”¨ |
| UIç»„ä»¶åº“ | Element Plus | 2.4.x | åŸºäºVue 3çš„ä¼ä¸šçº§UIç»„ä»¶åº“ï¼Œæä¾›ä¸°å¯Œçš„è¡¨å•ã€è¡¨æ ¼ç­‰ç»„ä»¶ |
| çŠ¶æ€ç®¡ç† | Pinia | 2.x | Vue 3æ¨èçš„çŠ¶æ€ç®¡ç†æ–¹æ¡ˆï¼Œç®€åŒ–æ•°æ®æµç®¡ç† |
| å®¹å™¨åŒ– | Docker + Kubernetes | æœ€æ–°ç¨³å®šç‰ˆ | æä¾›æ ‡å‡†åŒ–çš„åº”ç”¨éƒ¨ç½²ç¯å¢ƒï¼Œæ”¯æŒå¼¹æ€§ä¼¸ç¼©å’Œé«˜å¯ç”¨ |

### 1.2 ç³»ç»Ÿæ¶æ„

#### å¾®æœåŠ¡æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     API Gateway     â”‚â”€â”€â”€â”€â–¶â”‚  Authentication &   â”‚     â”‚    Config Server    â”‚
â”‚                     â”‚â—€â”€â”€â”€â”€â”‚  Authorization      â”‚     â”‚                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                           â”‚
            â–¼                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Service Bus     â”‚â—€â”€â”€â”€â”€â”‚   HR Microservice   â”‚â”€â”€â”€â”€â–¶â”‚     Event Bus       â”‚
â”‚                     â”‚â”€â”€â”€â”€â–¶â”‚                     â”‚     â”‚                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                           â”‚
            â–¼                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  File Storage/CDN   â”‚     â”‚    PostgreSQL DB    â”‚     â”‚       Redis         â”‚
â”‚                     â”‚     â”‚                     â”‚     â”‚                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æ¨¡å—åˆ’åˆ†

```
hr-service/              # äººäº‹æœåŠ¡æ ¹ç›®å½•
â”œâ”€â”€ hr-api/             # APIå®šä¹‰æ¨¡å—
â”œâ”€â”€ hr-core/            # æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ employee/       # å‘˜å·¥ç®¡ç†
â”‚   â”œâ”€â”€ department/     # ç»„ç»‡æ¶æ„
â”‚   â”œâ”€â”€ attendance/     # è€ƒå‹¤ç®¡ç†
â”‚   â”œâ”€â”€ training/       # åŸ¹è®­ç®¡ç†
â”‚   â”œâ”€â”€ certificate/    # èµ„è´¨è¯ä¹¦ç®¡ç†
â”‚   â””â”€â”€ integration/    # ç³»ç»Ÿé›†æˆ
â”œâ”€â”€ hr-data/            # æ•°æ®è®¿é—®å±‚
â”œâ”€â”€ hr-security/        # å®‰å…¨ç»„ä»¶
â”œâ”€â”€ hr-common/          # å…¬å…±ç»„ä»¶
â””â”€â”€ hr-web/             # Webæ¥å£
```

## 2ï¸âƒ£ å¼€å‘ä¸éƒ¨ç½²ç¯å¢ƒ

### 2.1 å¼€å‘ç¯å¢ƒ

| ç¯å¢ƒ | é…ç½® | è¯´æ˜ |
|------|------|------|
| JDK | OpenJDK 17+ | å¼€å‘å’Œè¿è¡Œç¯å¢ƒ |
| Maven | 3.9.x | ä¾èµ–ç®¡ç†å’Œæ„å»ºå·¥å…· |
| Node.js | 18.x+ | å‰ç«¯å¼€å‘ç¯å¢ƒ |
| npm | 9.x+ | å‰ç«¯åŒ…ç®¡ç† |
| IDE | IntelliJ IDEA / VS Code | æ¨èå¼€å‘å·¥å…· |
| Docker | æœ€æ–°ç¨³å®šç‰ˆ | å®¹å™¨åŒ–å¼€å‘ |
| Git | 2.x+ | ç‰ˆæœ¬æ§åˆ¶ |

### 2.2 å¼€å‘æµç¨‹

1. **åˆ†æ”¯ç®¡ç†**ï¼š
   - `main`ï¼šä¸»åˆ†æ”¯ï¼Œç¨³å®šç‰ˆæœ¬
   - `develop`ï¼šå¼€å‘åˆ†æ”¯
   - `feature/*`ï¼šåŠŸèƒ½åˆ†æ”¯
   - `bugfix/*`ï¼šbugä¿®å¤åˆ†æ”¯
   - `release/*`ï¼šå‘å¸ƒåˆ†æ”¯

2. **ä»£ç è§„èŒƒ**ï¼š
   - Javaä»£ç éµå¾ªGoogle Java Style Guide
   - å‰ç«¯ä»£ç éµå¾ªVue.jså®˜æ–¹é£æ ¼æŒ‡å—
   - ä»£ç æäº¤å‰è¿›è¡Œé™æ€ä»£ç åˆ†æå’Œå•å…ƒæµ‹è¯•

3. **CI/CDæµç¨‹**ï¼š
   - ä»£ç æäº¤è§¦å‘è‡ªåŠ¨æ„å»º
   - è‡ªåŠ¨è¿è¡Œå•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•
   - æ„å»ºæˆåŠŸåè‡ªåŠ¨éƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒ
   - æ‰‹åŠ¨å®¡æ‰¹åéƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

## 3ï¸âƒ£ å…³é”®åŠŸèƒ½å®ç°æ–¹æ¡ˆ

### 3.1 ç»„ç»‡æ¶æ„ç®¡ç†

#### åŠŸèƒ½æè¿°
å®ç°éƒ¨é—¨ã€å²—ä½ã€èŒçº§çš„å®Œæ•´ç®¡ç†ï¼Œæ”¯æŒå±‚çº§ç»“æ„å’ŒGMPèŒè´£å…³è”ã€‚

#### å®ç°è¦ç‚¹
1. **é€’å½’æ•°æ®ç»“æ„**ï¼šä½¿ç”¨è‡ªå…³è”è¡¨å®ç°éƒ¨é—¨å±‚çº§
2. **æ ‘å½¢ç»“æ„å¤„ç†**ï¼š
   ```java
   @Service
   public class DepartmentServiceImpl implements DepartmentService {
       
       @Autowired
       private DepartmentRepository departmentRepository;
       
       @Override
       public List<DepartmentDTO> getDepartmentTree() {
           List<Department> rootDepts = departmentRepository.findByParentIdIsNull();
           return buildDepartmentTree(rootDepts);
       }
       
       private List<DepartmentDTO> buildDepartmentTree(List<Department> departments) {
           List<DepartmentDTO> result = new ArrayList<>();
           for (Department dept : departments) {
               DepartmentDTO dto = DepartmentMapper.INSTANCE.toDTO(dept);
               List<Department> children = departmentRepository.findByParentId(dept.getId());
               if (!children.isEmpty()) {
                   dto.setChildren(buildDepartmentTree(children));
               }
               result.add(dto);
           }
           return result;
       }
   }
   ```

3. **GMPèŒè´£å…³è”**ï¼šåœ¨éƒ¨é—¨å’Œå²—ä½å®ä½“ä¸­å¢åŠ GMPç›¸å…³å±æ€§
4. **å˜æ›´å®¡è®¡**ï¼šå®ç°ç»„ç»‡å˜æ›´çš„å®Œæ•´å®¡è®¡è®°å½•

### 3.2 å‘˜å·¥ç®¡ç†

#### åŠŸèƒ½æè¿°
å®ç°å‘˜å·¥ä¿¡æ¯çš„å®Œæ•´ç®¡ç†ï¼ŒåŒ…æ‹¬åŸºæœ¬ä¿¡æ¯ã€è”ç³»æ–¹å¼ã€èŒä¸šå‘å±•ç­‰ã€‚

#### å®ç°è¦ç‚¹
1. **æ•°æ®å®‰å…¨**ï¼š
   ```java
   @Service
   public class EmployeeServiceImpl implements EmployeeService {
       
       @Autowired
       private DataMaskingService dataMaskingService;
       
       @Override
       public EmployeeDTO getEmployeeDetail(Long id) {
           Employee employee = employeeRepository.findById(id)
               .orElseThrow(() -> new EntityNotFoundException("å‘˜å·¥ä¸å­˜åœ¨"));
           
           EmployeeDTO dto = EmployeeMapper.INSTANCE.toDTO(employee);
           
           // æ ¹æ®ç”¨æˆ·æƒé™è¿›è¡Œæ•°æ®è„±æ•
           Authentication auth = SecurityContextHolder.getContext().getAuthentication();
           if (auth != null && auth.getAuthorities().stream()
               .noneMatch(a -> a.getAuthority().equals("HR_ADMIN"))) {
               dto.setIdCardNumber(dataMaskingService.maskIdCard(dto.getIdCardNumber()));
               dto.setMobile(dataMaskingService.maskPhone(dto.getMobile()));
           }
           
           return dto;
       }
   }
   ```

2. **çŠ¶æ€æµè½¬**ï¼šä½¿ç”¨çŠ¶æ€æœºå®ç°å‘˜å·¥çŠ¶æ€çš„ä¸¥æ ¼ç®¡æ§
3. **æ•°æ®éªŒè¯**ï¼šä¸¥æ ¼çš„å­—æ®µéªŒè¯å’Œä¸šåŠ¡è§„åˆ™æ£€æŸ¥
4. **å‘˜å·¥ç”»åƒ**ï¼šæ„å»ºå‘˜å·¥360åº¦è§†å›¾ï¼Œæ•´åˆå¤šç»´åº¦ä¿¡æ¯

### 3.3 è€ƒå‹¤ç®¡ç†

#### åŠŸèƒ½æè¿°
å®ç°ç²¾ç¡®çš„è€ƒå‹¤è®°å½•ã€å¼‚å¸¸å¤„ç†å’ŒGMPå…³è”ã€‚

#### å®ç°è¦ç‚¹
1. **å·¥æ—¶è®¡ç®—**ï¼š
   ```java
   @Service
   public class AttendanceServiceImpl implements AttendanceService {
       
       @Override
       public BigDecimal calculateWorkHours(LocalTime checkIn, LocalTime checkOut, ShiftRule shiftRule) {
           // è®¡ç®—å®é™…å·¥ä½œæ—¶é•¿
           Duration duration = Duration.between(checkIn, checkOut);
           BigDecimal totalMinutes = BigDecimal.valueOf(duration.toMinutes());
           
           // å‡å»ä¼‘æ¯æ—¶é—´
           BigDecimal breakMinutes = shiftRule.getBreakTime() != null ? 
               BigDecimal.valueOf(shiftRule.getBreakTime().toMinutes()) : BigDecimal.ZERO;
           
           return totalMinutes.subtract(breakMinutes).divide(BigDecimal.valueOf(60), 2, RoundingMode.HALF_UP);
       }
       
       @Override
       public AttendanceRecordDTO createRecord(AttendanceRecordRequest request) {
           // åˆ›å»ºè®°å½•æ—¶è‡ªåŠ¨å…³è”GMPæ´»åŠ¨
           AttendanceRecord record = new AttendanceRecord();
           // è®¾ç½®è®°å½•å±æ€§...
           
           // å…³è”GMPæ´»åŠ¨ï¼ˆå¦‚æœæœ‰ï¼‰
           if (request.getGmpActivityId() != null) {
               record.setGmpActivityId(request.getGmpActivityId());
               record.setIsGmpRelated(true);
           }
           
           return AttendanceRecordMapper.INSTANCE.toDTO(attendanceRepository.save(record));
       }
   }
   ```

2. **å¼‚å¸¸å¤„ç†æµç¨‹**ï¼šåŸºäºå·¥ä½œæµå¼•æ“çš„å®¡æ‰¹æµç¨‹
3. **ç»Ÿè®¡åˆ†æ**ï¼šå®æ—¶è€ƒå‹¤æ•°æ®ç»Ÿè®¡å’ŒæŠ¥è¡¨ç”Ÿæˆ
4. **ä¸GMPè®°å½•å…³è”**ï¼šå…³é”®æ“ä½œçš„è€ƒå‹¤å…³è”å’Œåˆè§„æ€§è¿½è¸ª

### 3.4 åŸ¹è®­ç®¡ç†

#### åŠŸèƒ½æè¿°
å®ç°GMPåŸ¹è®­è¯¾ç¨‹ç®¡ç†ã€è®¡åˆ’æ‰§è¡Œå’Œæ•ˆæœè¯„ä¼°ã€‚

#### å®ç°è¦ç‚¹
1. **åŸ¹è®­è®¡åˆ’**ï¼š
   ```java
   @Service
   public class TrainingServiceImpl implements TrainingService {
       
       @Scheduled(cron = "0 0 0 1 * ?")  // æ¯æœˆ1æ—¥æ‰§è¡Œ
       public void generateMonthlyTrainingPlan() {
           // è·å–éœ€è¦åŸ¹è®­çš„å‘˜å·¥
           List<Employee> employees = employeeRepository.findByNextTrainingDateBefore(LocalDate.now().plusMonths(1));
           
           for (Employee employee : employees) {
               // åŸºäºå‘˜å·¥å²—ä½å’ŒèŒè´£ç”ŸæˆåŸ¹è®­è®¡åˆ’
               List<Course> requiredCourses = courseRepository.findByRequiredForPositions(employee.getPosition().getId());
               
               for (Course course : requiredCourses) {
                   TrainingPlan plan = new TrainingPlan();
                   plan.setEmployee(employee);
                   plan.setCourse(course);
                   plan.setPlanDate(LocalDate.now());
                   plan.setTargetDate(LocalDate.now().plusWeeks(2));
                   plan.setStatus(TrainingPlanStatus.PENDING);
                   
                   trainingPlanRepository.save(plan);
               }
           }
       }
   }
   ```

2. **åŸ¹è®­æ•ˆæœè¯„ä¼°**ï¼šå¤šç»´åº¦çš„åŸ¹è®­è¯„ä¼°æ¨¡å‹
3. **è¯ä¹¦è‡ªåŠ¨ç”Ÿæˆ**ï¼šåŸ¹è®­åˆæ ¼åçš„è¯ä¹¦è‡ªåŠ¨ç”Ÿæˆå’Œç®¡ç†
4. **åŸ¹è®­è®°å½•åˆè§„æ€§**ï¼šç¡®ä¿åŸ¹è®­è®°å½•æ»¡è¶³GMPå®¡è®¡è¦æ±‚

### 3.5 èµ„è´¨è¯ä¹¦ç®¡ç†

#### åŠŸèƒ½æè¿°
å®ç°è¯ä¹¦å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†å’Œä¸GMPæ“ä½œæƒé™çš„è”åŠ¨ã€‚

#### å®ç°è¦ç‚¹
1. **è¯ä¹¦é¢„è­¦**ï¼š
   ```java
   @Service
   public class CertificateServiceImpl implements CertificateService {
       
       @Autowired
       private NotificationService notificationService;
       
       @Scheduled(cron = "0 0 9 * * ?")  // æ¯å¤©æ—©ä¸Š9ç‚¹æ‰§è¡Œ
       public void checkCertificateExpiry() {
           // æ£€æŸ¥30å¤©å†…åˆ°æœŸçš„è¯ä¹¦
           LocalDate thirtyDaysLater = LocalDate.now().plusDays(30);
           List<Certificate> expiringCertificates = certificateRepository.findByExpiryDateBeforeAndStatus(thirtyDaysLater, CertificateStatus.VALID);
           
           for (Certificate cert : expiringCertificates) {
               // å‘é€é¢„è­¦é€šçŸ¥
               NotificationDTO notification = new NotificationDTO();
               notification.setRecipientId(cert.getEmployee().getUserId());
               notification.setType(NotificationType.CERTIFICATE_EXPIRY_WARNING);
               notification.setTitle("è¯ä¹¦å³å°†åˆ°æœŸæé†’");
               notification.setContent(String.format("æ‚¨çš„è¯ä¹¦ %s å°†äº %s åˆ°æœŸï¼Œè¯·åŠæ—¶åŠç†ç»­æœŸã€‚", 
                   cert.getCertificateType().getTypeName(), cert.getExpiryDate()));
               
               notificationService.send(notification);
               
               // å¦‚æœæ˜¯GMPå…³é”®è¯ä¹¦ï¼ŒåŒæ—¶é€šçŸ¥éƒ¨é—¨è´Ÿè´£äºº
               if (cert.getCertificateType().getIsGmpRequired()) {
                   Long managerId = cert.getEmployee().getDepartment().getManagerId();
                   if (managerId != null) {
                       Employee manager = employeeRepository.findById(managerId).orElse(null);
                       if (manager != null && manager.getUserId() != null) {
                           // å‘é€é€šçŸ¥ç»™éƒ¨é—¨è´Ÿè´£äºº
                           // ...
                       }
                   }
               }
           }
       }
   }
   ```

2. **æƒé™è”åŠ¨**ï¼šè¯ä¹¦çŠ¶æ€å˜æ›´è‡ªåŠ¨è§¦å‘æƒé™æ›´æ–°
3. **æ–‡ä»¶éªŒè¯**ï¼šè¯ä¹¦æ–‡ä»¶çš„å®Œæ•´æ€§å’ŒçœŸå®æ€§éªŒè¯
4. **åˆè§„æ€§æ£€æŸ¥**ï¼šè‡ªåŠ¨æ£€æŸ¥è¯ä¹¦åˆè§„æ€§å¹¶ç”ŸæˆæŠ¥å‘Š

## 4ï¸âƒ£ æ•°æ®è¿ç§»ç­–ç•¥

### 4.1 æ•°æ®è¿ç§»è®¡åˆ’

1. **æ•°æ®å®¡è®¡ä¸æ¸…æ´—**ï¼š
   - å¯¹ç°æœ‰ç³»ç»Ÿæ•°æ®è¿›è¡Œå…¨é¢å®¡è®¡
   - è¯†åˆ«å¹¶ä¿®æ­£æ•°æ®è´¨é‡é—®é¢˜
   - è¡¥å……ç¼ºå¤±çš„GMPç›¸å…³ä¿¡æ¯

2. **åˆ†é˜¶æ®µè¿ç§»**ï¼š
   - ç¬¬1é˜¶æ®µï¼šåŸºç¡€æ•°æ®ï¼ˆç»„ç»‡æ¶æ„ã€å‘˜å·¥åŸºæœ¬ä¿¡æ¯ï¼‰
   - ç¬¬2é˜¶æ®µï¼šä¸šåŠ¡æ•°æ®ï¼ˆè€ƒå‹¤è®°å½•ã€åŸ¹è®­è®°å½•ï¼‰
   - ç¬¬3é˜¶æ®µï¼šGMPç›¸å…³æ•°æ®ï¼ˆèµ„è´¨è¯ä¹¦ã€GMPæ´»åŠ¨ï¼‰

3. **è¿ç§»å·¥å…·**ï¼š
   - å¼€å‘ä¸“ç”¨ETLå·¥å…·è¿›è¡Œæ•°æ®è¿ç§»
   - å®ç°æ•°æ®è½¬æ¢å’Œæ ¡éªŒé€»è¾‘
   - æä¾›è¿ç§»è¿›åº¦ç›‘æ§å’Œå›æ»šæœºåˆ¶

### 4.2 æ•°æ®éªŒè¯

```java
@Service
public class DataMigrationValidationService {
    
    @Autowired
    private DepartmentRepository departmentRepository;
    @Autowired
    private EmployeeRepository employeeRepository;
    @Autowired
    private MigrationLogRepository migrationLogRepository;
    
    public ValidationResult validateDepartments() {
        ValidationResult result = new ValidationResult();
        List<Department> departments = departmentRepository.findAll();
        
        // æ£€æŸ¥éƒ¨é—¨ä»£ç å”¯ä¸€æ€§
        Map<String, Department> codeMap = new HashMap<>();
        for (Department dept : departments) {
            if (codeMap.containsKey(dept.getDepartmentCode())) {
                MigrationLog log = new MigrationLog();
                log.setEntityType("Department");
                log.setEntityId(dept.getId().toString());
                log.setOperationType("Validation");
                log.setStatus("ERROR");
                log.setMessage("éƒ¨é—¨ä»£ç é‡å¤: " + dept.getDepartmentCode());
                migrationLogRepository.save(log);
                
                result.addError(dept.getId(), "éƒ¨é—¨ä»£ç é‡å¤: " + dept.getDepartmentCode());
            } else {
                codeMap.put(dept.getDepartmentCode(), dept);
            }
        }
        
        // æ£€æŸ¥å±‚çº§ç»“æ„å®Œæ•´æ€§
        // ...
        
        return result;
    }
}
```

## 5ï¸âƒ£ ç³»ç»Ÿé›†æˆæ–¹æ¡ˆ

### 5.1 ä¸è®¤è¯ç³»ç»Ÿé›†æˆ

1. **OAuth2/OIDCè®¤è¯æµç¨‹**ï¼š
   - é›†æˆç»Ÿä¸€èº«ä»½è®¤è¯ç³»ç»Ÿ
   - å®ç°SSOå•ç‚¹ç™»å½•
   - JWTä»¤ç‰ŒéªŒè¯å’Œç”¨æˆ·ä¿¡æ¯è·å–

2. **æƒé™æ˜ å°„**ï¼š
   - HRè§’è‰²ä¸è®¤è¯ç³»ç»Ÿæƒé™çš„æ˜ å°„
   - åŸºäºèŒè´£çš„è®¿é—®æ§åˆ¶å®ç°

3. **æ¥å£ç¤ºä¾‹**ï¼š
   ```java
   @Configuration
   @EnableWebSecurity
   public class SecurityConfig {
       
       @Bean
       public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
           http
               .oauth2ResourceServer(config -> config.jwt(jwt -> jwt.decoder(jwtDecoder())))  
               .authorizeHttpRequests(authorize -> authorize
                   .requestMatchers("/api/hr/v1/public/**").permitAll()
                   .anyRequest().authenticated()
               )
               .sessionManagement(session -> session.sessionCreationPolicy(SessionCreationPolicy.STATELESS));
           
           return http.build();
       }
       
       @Bean
       public JwtDecoder jwtDecoder() {
           // é…ç½®JWTè§£ç å™¨ï¼ŒéªŒè¯æ¥è‡ªè®¤è¯ç³»ç»Ÿçš„ä»¤ç‰Œ
           return NimbusJwtDecoder.withPublicKey(rsaPublicKey()).build();
       }
   }
   ```

### 5.2 ä¸GMPç³»ç»Ÿé›†æˆ

1. **APIç½‘å…³é›†æˆ**ï¼š
   - ç»Ÿä¸€APIç½‘å…³ç®¡ç†
   - è¯·æ±‚è·¯ç”±å’Œè´Ÿè½½å‡è¡¡
   - å®‰å…¨ç­–ç•¥å®æ–½

2. **æ•°æ®åŒæ­¥**ï¼š
   - åŸºäºäº‹ä»¶é©±åŠ¨çš„æ•°æ®åŒæ­¥
   - å˜æ›´æ•°æ®æ•è·(CDC)æœºåˆ¶
   - åˆ†å¸ƒå¼äº‹åŠ¡ä¿éšœ

3. **æ¶ˆæ¯é˜Ÿåˆ—é›†æˆ**ï¼š
   ```java
   @Configuration
   public class RabbitMQConfig {
       
       @Bean
       public Queue gmpActivityQueue() {
           return new Queue("gmp.activity.queue");
       }
       
       @Bean
       public TopicExchange gmpExchange() {
           return new TopicExchange("gmp.exchange");
       }
       
       @Bean
       public Binding gmpActivityBinding(Queue gmpActivityQueue, TopicExchange gmpExchange) {
           return BindingBuilder.bind(gmpActivityQueue).to(gmpExchange).with("gmp.activity.*");
       }
   }
   
   @Service
   @RabbitListener(queues = "gmp.activity.queue")
   public class GmpActivityListener {
       
       @Autowired
       private AttendanceService attendanceService;
       
       @RabbitHandler
       public void handleGmpActivity(GmpActivityEvent event) {
           // å¤„ç†GMPæ´»åŠ¨äº‹ä»¶ï¼Œå…³è”è€ƒå‹¤è®°å½•
           attendanceService.linkAttendanceWithGmpActivity(event.getEmployeeId(), event.getActivityId(), event.getActivityTime());
       }
   }
   ```

## 6ï¸âƒ£ å®‰å…¨æ€§ä¸åˆè§„æ€§

### 6.1 æ•°æ®å®‰å…¨

1. **æ•æ„Ÿæ•°æ®ä¿æŠ¤**ï¼š
   - ä¸ªäººèº«ä»½ä¿¡æ¯(PII)åŠ å¯†å­˜å‚¨
   - ä¼ è¾“å±‚åŠ å¯†(HTTPS)
   - æ•°æ®è„±æ•å¤„ç†

2. **è®¿é—®æ§åˆ¶**ï¼š
   - åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶(RBAC)
   - ç»†ç²’åº¦æƒé™ç®¡ç†
   - èŒè´£åˆ†ç¦»åŸåˆ™å®æ–½

3. **å®‰å…¨å®ç°ç¤ºä¾‹**ï¼š
   ```java
   @Component
   public class DataMaskingServiceImpl implements DataMaskingService {
       
       @Override
       public String maskIdCard(String idCard) {
           if (idCard == null || idCard.length() < 8) {
               return idCard;
           }
           
           // ä¿ç•™å‰4ä½å’Œå4ä½
           int length = idCard.length();
           return idCard.substring(0, 4) + "********" + idCard.substring(length - 4);
       }
       
       @Override
       public String maskPhone(String phone) {
           if (phone == null || phone.length() < 7) {
               return phone;
           }
           
           // ä¿ç•™å‰3ä½å’Œå4ä½
           return phone.substring(0, 3) + "****" + phone.substring(phone.length() - 4);
       }
   }
   ```

### 6.2 GMPåˆè§„æ€§

1. **å®¡è®¡è·Ÿè¸ª**ï¼š
   - å…¨é¢çš„æ“ä½œæ—¥å¿—è®°å½•
   - æ•°æ®å˜æ›´å†å²è¿½è¸ª
   - å®¡è®¡æ—¥å¿—ä¿æŠ¤æœºåˆ¶

2. **ç”µå­ç­¾å**ï¼š
   - ç¬¦åˆ21 CFR Part 11çš„ç”µå­ç­¾å
   - ç­¾åæµç¨‹æ§åˆ¶
   - ç­¾åå®¡è®¡å’ŒéªŒè¯

3. **åˆè§„æŠ¥å‘Š**ï¼š
   - è‡ªåŠ¨ç”ŸæˆGMPåˆè§„æŠ¥å‘Š
   - åˆè§„çŠ¶æ€ç›‘æ§
   - å¼‚å¸¸æƒ…å†µå‘Šè­¦

## 7ï¸âƒ£ é¡¹ç›®å®æ–½è®¡åˆ’

### 7.1 å¼€å‘é˜¶æ®µ

| é˜¶æ®µ | æ—¶é—´å‘¨æœŸ | ä¸»è¦ä»»åŠ¡ | è¾“å‡ºç‰© |
|------|----------|----------|--------|
| éœ€æ±‚åˆ†æ | 3å‘¨ | è¯¦ç»†éœ€æ±‚è°ƒç ”ä¸åˆ†æ<br>éœ€æ±‚è§„æ ¼è¯´æ˜ä¹¦ç¼–å†™ | éœ€æ±‚è§„æ ¼è¯´æ˜ä¹¦ |
| ç³»ç»Ÿè®¾è®¡ | 4å‘¨ | æ¶æ„è®¾è®¡<br>æ•°æ®åº“è®¾è®¡<br>APIè®¾è®¡<br>å®‰å…¨è®¾è®¡ | è®¾è®¡æ–‡æ¡£ |
| æ ¸å¿ƒå¼€å‘ | 12å‘¨ | åç«¯æœåŠ¡å¼€å‘<br>å‰ç«¯ç•Œé¢å¼€å‘<br>æ•°æ®åº“å®ç°<br>é›†æˆæ¥å£å¼€å‘ | å¯éƒ¨ç½²ä»£ç  |
| ç³»ç»Ÿé›†æˆ | 3å‘¨ | å†…éƒ¨ç³»ç»Ÿé›†æˆ<br>ä¸å¤–éƒ¨ç³»ç»Ÿå¯¹æ¥<br>é›†æˆæµ‹è¯• | é›†æˆæµ‹è¯•æŠ¥å‘Š |
| æµ‹è¯•éªŒè¯ | 4å‘¨ | åŠŸèƒ½æµ‹è¯•<br>æ€§èƒ½æµ‹è¯•<br>å®‰å…¨æµ‹è¯•<br>GMPåˆè§„æ€§æµ‹è¯• | æµ‹è¯•æŠ¥å‘Š |
| æ•°æ®è¿ç§» | 2å‘¨ | æ•°æ®è¿ç§»å·¥å…·å¼€å‘<br>æ•°æ®æ¸…æ´—ä¸è½¬æ¢<br>æ•°æ®éªŒè¯ | æ•°æ®è¿ç§»æŠ¥å‘Š |
| ä¸Šçº¿å‡†å¤‡ | 2å‘¨ | ç¯å¢ƒå‡†å¤‡<br>ç”¨æˆ·åŸ¹è®­<br>ä¸Šçº¿è®¡åˆ’åˆ¶å®š<br>å›æ»šæ–¹æ¡ˆå‡†å¤‡ | ä¸Šçº¿æ–‡æ¡£ |
| ç³»ç»Ÿä¸Šçº¿ | 1å‘¨ | ç³»ç»Ÿéƒ¨ç½²<br>ç›‘æ§<br>é—®é¢˜ä¿®å¤ | ä¸Šçº¿æŠ¥å‘Š |

### 7.2 é‡Œç¨‹ç¢‘

1. **M1ï¼šéœ€æ±‚å†»ç»“**ï¼ˆç¬¬3å‘¨æœ«ï¼‰
   - å®Œæˆè¯¦ç»†éœ€æ±‚è§„æ ¼è¯´æ˜ä¹¦
   - é€šè¿‡éœ€æ±‚è¯„å®¡

2. **M2ï¼šè®¾è®¡å®Œæˆ**ï¼ˆç¬¬7å‘¨æœ«ï¼‰
   - å®Œæˆæ‰€æœ‰è®¾è®¡æ–‡æ¡£
   - é€šè¿‡è®¾è®¡è¯„å®¡

3. **M3ï¼šæ ¸å¿ƒåŠŸèƒ½å®Œæˆ**ï¼ˆç¬¬19å‘¨æœ«ï¼‰
   - å®Œæˆæ ¸å¿ƒä¸šåŠ¡åŠŸèƒ½å¼€å‘
   - é€šè¿‡åŠŸèƒ½æµ‹è¯•

4. **M4ï¼šç³»ç»Ÿé›†æˆå®Œæˆ**ï¼ˆç¬¬22å‘¨æœ«ï¼‰
   - å®Œæˆç³»ç»Ÿé›†æˆ
   - é›†æˆæµ‹è¯•é€šè¿‡

5. **M5ï¼šéªŒæ”¶æµ‹è¯•é€šè¿‡**ï¼ˆç¬¬26å‘¨æœ«ï¼‰
   - æ‰€æœ‰æµ‹è¯•é€šè¿‡
   - ç”¨æˆ·éªŒæ”¶åˆæ ¼

6. **M6ï¼šç³»ç»Ÿä¸Šçº¿**ï¼ˆç¬¬29å‘¨æœ«ï¼‰
   - ç³»ç»ŸæˆåŠŸä¸Šçº¿
   - è¿è¡Œç¨³å®š

### 7.3 èµ„æºè§„åˆ’

| è§’è‰² | äººæ•° | èŒè´£ |
|------|------|------|
| é¡¹ç›®ç»ç† | 1 | é¡¹ç›®ç®¡ç†ã€åè°ƒæ²Ÿé€š |
| äº§å“ç»ç† | 1 | éœ€æ±‚åˆ†æã€äº§å“è®¾è®¡ |
| ç³»ç»Ÿæ¶æ„å¸ˆ | 1 | ç³»ç»Ÿæ¶æ„è®¾è®¡ã€æŠ€æœ¯é€‰å‹ |
| åç«¯å¼€å‘å·¥ç¨‹å¸ˆ | 3 | åç«¯æœåŠ¡å¼€å‘ã€APIå®ç° |
| å‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆ | 2 | å‰ç«¯ç•Œé¢å¼€å‘ã€äº¤äº’å®ç° |
| æµ‹è¯•å·¥ç¨‹å¸ˆ | 2 | æµ‹è¯•ç”¨ä¾‹ç¼–å†™ã€æµ‹è¯•æ‰§è¡Œ |
| æ•°æ®åº“å·¥ç¨‹å¸ˆ | 1 | æ•°æ®åº“è®¾è®¡ã€æ€§èƒ½ä¼˜åŒ– |
| è´¨é‡ä¿è¯ | 1 | è´¨é‡æ§åˆ¶ã€åˆè§„æ€§æ£€æŸ¥ |
| DevOpså·¥ç¨‹å¸ˆ | 1 | CI/CDå®ç°ã€ç¯å¢ƒç®¡ç† |

## 8ï¸âƒ£ é£é™©ç®¡ç†

### 8.1 ä¸»è¦é£é™©

| é£é™© | å½±å“ | ç¼“è§£æªæ–½ |
|------|------|----------|
| ç°æœ‰æ•°æ®è´¨é‡é—®é¢˜ | é«˜ | æå‰è¿›è¡Œæ•°æ®å®¡è®¡å’Œæ¸…æ´—<br>åˆ¶å®šæ•°æ®ä¿®å¤è®¡åˆ’<br>åŠ å¼ºæ•°æ®éªŒè¯ |
| ç³»ç»Ÿé›†æˆå¤æ‚æ€§ | é«˜ | è¯¦ç»†çš„é›†æˆæ¥å£è®¾è®¡<br>é‡‡ç”¨å¥‘çº¦æµ‹è¯•<br>å»ºç«‹é›†æˆæµ‹è¯•ç¯å¢ƒ |
| GMPåˆè§„æ€§æŒ‘æˆ˜ | é«˜ | é‚€è¯·åˆè§„ä¸“å®¶å‚ä¸è®¾è®¡è¯„å®¡<br>å‚è€ƒè¡Œä¸šæœ€ä½³å®è·µ<br>ä¸¥æ ¼çš„åˆè§„æµ‹è¯• |
| ä¸šåŠ¡è¿ç»­æ€§ä¿éšœ | ä¸­ | åˆ¶å®šè¯¦ç»†çš„è¿‡æ¸¡æ–¹æ¡ˆ<br>åŒç³»ç»Ÿå¹¶è¡Œè¿è¡Œ<br>å»ºç«‹åº”æ€¥é¢„æ¡ˆ |
| ç”¨æˆ·æ¥å—åº¦ | ä¸­ | æå‰è¿›è¡Œç”¨æˆ·åŸ¹è®­<br>æä¾›è¯¦ç»†çš„æ“ä½œæ‰‹å†Œ<br>è®¾ç«‹ç”¨æˆ·åé¦ˆæ¸ é“ |
| æ€§èƒ½ç“¶é¢ˆ | ä¸­ | è¿›è¡Œæ€§èƒ½æµ‹è¯•å’Œä¼˜åŒ–<br>å®æ–½ç¼“å­˜ç­–ç•¥<br>æ•°æ®åº“ç´¢å¼•ä¼˜åŒ– |

### 8.2 åº”å¯¹ç­–ç•¥

1. **å®šæœŸé£é™©è¯„ä¼°**ï¼šæ¯å‘¨è¿›è¡Œé¡¹ç›®é£é™©è¯„ä¼°
2. **é£é™©é¢„è­¦æœºåˆ¶**ï¼šå»ºç«‹é£é™©é¢„è­¦æŒ‡æ ‡å’Œå“åº”æœºåˆ¶
3. **å˜æ›´æ§åˆ¶**ï¼šä¸¥æ ¼çš„å˜æ›´ç®¡ç†æµç¨‹
4. **åº”æ€¥å“åº”**ï¼šåˆ¶å®šè¯¦ç»†çš„åº”æ€¥é¢„æ¡ˆ
5. **æŒç»­ç›‘æ§**ï¼šå®æ—¶ç›‘æ§ç³»ç»Ÿè¿è¡ŒçŠ¶æ€

---

*æ–‡æ¡£ç‰ˆæœ¬ï¼šv0.1.0-draft*
*å®¡æ ¸çŠ¶æ€ï¼šå¾…å®¡æ ¸*
*ä¸‹æ¬¡æ›´æ–°ï¼šè®¾è®¡è¯„å®¡å*