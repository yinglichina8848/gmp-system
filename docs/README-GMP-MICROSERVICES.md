# GMPä¿¡æ¯ç®¡ç†ç³»ç»Ÿ - å¾®æœåŠ¡æ¶æ„

## ğŸš€ é¡¹ç›®æ¦‚è¿°

GMPï¼ˆGood Manufacturing Practiceï¼‰ä¿¡æ¯ç®¡ç†ç³»ç»ŸåŸºäºSpring Cloudå¾®æœåŠ¡æ¶æ„ï¼Œå®ç°è¯å“ç”Ÿäº§å…¨æµç¨‹è´¨é‡ç®¡ç†ã€‚ç³»ç»Ÿé‡‡ç”¨å‰åç«¯åˆ†ç¦»è®¾è®¡ï¼Œæ”¯æŒå¤šç§Ÿæˆ·ã€åˆ†å¸ƒå¼éƒ¨ç½²å’Œé«˜å¯ç”¨æ€§ã€‚

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### å¾®æœåŠ¡æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å‰ç«¯åº”ç”¨å±‚ (Vue.js)                   â”‚
â”‚                http://localhost:3000                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    APIç½‘å…³å±‚ (Gateway)                  â”‚
â”‚                http://localhost:8080                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   QMSæœåŠ¡   â”‚   MESæœåŠ¡   â”‚  LIMSæœåŠ¡   â”‚   EDMSæœåŠ¡  â”‚
        â”‚   8081      â”‚   8082      â”‚   8083      â”‚   8084      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  è®¤è¯æœåŠ¡   â”‚  é…ç½®æœåŠ¡   â”‚  æ¶ˆæ¯æœåŠ¡   â”‚  æ–‡ä»¶æœåŠ¡   â”‚
        â”‚   8085      â”‚   8086      â”‚   8087      â”‚   8088      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 åŸºç¡€è®¾æ–½æœåŠ¡å±‚                          â”‚
â”‚  PostgreSQL  â”‚  Redis  â”‚ RabbitMQ â”‚ MinIO â”‚ Prometheus â”‚
â”‚    5432      â”‚   6379  â”‚   5672   â”‚  9000 â”‚    9090    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **æ¡†æ¶**: Spring Boot 3.2.5 + Spring Cloud 2023.0.0
- **è¯­è¨€**: Java 17
- **æ•°æ®åº“**: PostgreSQL 13
- **ç¼“å­˜**: Redis 7
- **æ¶ˆæ¯é˜Ÿåˆ—**: RabbitMQ 3
- **å¯¹è±¡å­˜å‚¨**: MinIO
- **æœåŠ¡å‘ç°**: Netflix Eureka
- **APIç½‘å…³**: Spring Cloud Gateway
- **ç›‘æ§**: Prometheus + Grafana
- **å®¹å™¨åŒ–**: Docker + Docker Compose

## ğŸ“ é¡¹ç›®ç»“æ„

```
gmp-system/
â”œâ”€â”€ docs/                          # é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ gmp-dependencies/              # ä¾èµ–ç®¡ç†BOM
â”œâ”€â”€ services/                      # å¾®æœåŠ¡æ¨¡å—
â”‚   â”œâ”€â”€ gateway/                   # APIç½‘å…³æœåŠ¡
â”‚   â”œâ”€â”€ qms-service/               # è´¨é‡ç®¡ç†ç³»ç»Ÿ
â”‚   â”œâ”€â”€ mes-service/               # ç”Ÿäº§æ‰§è¡Œç³»ç»Ÿ
â”‚   â”œâ”€â”€ lims-service/              # å®éªŒå®¤ä¿¡æ¯ç®¡ç†ç³»ç»Ÿ
â”‚   â”œâ”€â”€ edms-service/              # ç”µå­æ–‡æ¡£ç®¡ç†ç³»ç»Ÿ
â”‚   â”œâ”€â”€ auth-service/              # è®¤è¯æˆæƒæœåŠ¡
â”‚   â”œâ”€â”€ config-service/            # é…ç½®ä¸­å¿ƒæœåŠ¡
â”‚   â”œâ”€â”€ message-service/           # æ¶ˆæ¯æœåŠ¡
â”‚   â””â”€â”€ file-service/              # æ–‡ä»¶æœåŠ¡
â”œâ”€â”€ infrastructure/                # åŸºç¡€è®¾æ–½é…ç½®
â”‚   â”œâ”€â”€ postgres/                  # PostgreSQLé…ç½®
â”‚   â”œâ”€â”€ redis/                     # Redisé…ç½®
â”‚   â”œâ”€â”€ prometheus/                # ç›‘æ§é…ç½®
â”‚   â””â”€â”€ grafana/                   # å¯è§†åŒ–é…ç½®
â”œâ”€â”€ scripts/                       # éƒ¨ç½²è„šæœ¬
â”‚   â”œâ”€â”€ start-dev.sh              # å¯åŠ¨å¼€å‘ç¯å¢ƒ
â”‚   â””â”€â”€ stop-dev.sh               # åœæ­¢å¼€å‘ç¯å¢ƒ
â”œâ”€â”€ docker-compose.yml            # åŸºç¡€è®¾æ–½ç¼–æ’
â””â”€â”€ pom.xml                       # æ ¹POMæ–‡ä»¶
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- **Docker & Docker Compose**: 20.10+
- **Java**: 17+
- **Maven**: 3.8+
- **å†…å­˜**: è‡³å°‘8GBå¯ç”¨å†…å­˜
- **ç£ç›˜**: è‡³å°‘20GBå¯ç”¨ç©ºé—´

### ä¸€é”®å¯åŠ¨å¼€å‘ç¯å¢ƒ

```bash
# 1. å…‹éš†é¡¹ç›®
git clone <repository-url>
cd gmp-system

# 2. å¯åŠ¨æ‰€æœ‰æœåŠ¡
./scripts/start-dev.sh

# æˆ–è€…æ‰‹åŠ¨å¯åŠ¨
# å¯åŠ¨åŸºç¡€è®¾æ–½æœåŠ¡
docker-compose up -d

# ç¼–è¯‘é¡¹ç›®
mvn clean package -DskipTests

# å¯åŠ¨å¾®æœåŠ¡
mvn spring-boot:run -pl services/gateway &
mvn spring-boot:run -pl services/qms-service &
# ... å¯åŠ¨å…¶ä»–å¾®æœåŠ¡
```

### åœæ­¢ç¯å¢ƒ

```bash
./scripts/stop-dev.sh
```

## ğŸŒ æœåŠ¡è®¿é—®åœ°å€

| æœåŠ¡åç§° | åœ°å€ | è¯´æ˜ | é»˜è®¤è´¦å· |
|----------|------|------|----------|
| **APIç½‘å…³** | http://localhost:8080 | ç»Ÿä¸€APIå…¥å£ | N/A |
| **Eurekaæ³¨å†Œä¸­å¿ƒ** | http://localhost:8761 | æœåŠ¡å‘ç°ç•Œé¢ | N/A |
| **Prometheus** | http://localhost:9090 | ç›‘æ§æŒ‡æ ‡ | N/A |
| **Grafana** | http://localhost:3000 | å¯è§†åŒ–ç›‘æ§ | admin/admin123 |
| **RabbitMQç®¡ç†** | http://localhost:15672 | æ¶ˆæ¯é˜Ÿåˆ—ç®¡ç† | admin/admin123 |
| **MinIOæ§åˆ¶å°** | http://localhost:9001 | å¯¹è±¡å­˜å‚¨ç®¡ç† | gmp_minio_admin/gmp_minio_password_2024 |
| **PostgreSQL** | localhost:5432 | æ•°æ®åº“ | postgres/postgres |

## ğŸ“‹ APIæ¥å£

### ç»Ÿä¸€APIæ ¼å¼

```http
# ç½‘å…³ä»£ç†è®¿é—®
GET http://localhost:8080/api/{service}/{endpoint}

# ä¾‹å¦‚ï¼šè®¿é—®QMSæœåŠ¡çš„åå·®åˆ—è¡¨
GET http://localhost:8080/api/qms/deviations
```

### ä¸»è¦APIæ¥å£

#### è´¨é‡ç®¡ç†ç³»ç»Ÿ (QMS)
```http
# åå·®ç®¡ç†
POST   /api/qms/deviations          # åˆ›å»ºåå·®
GET    /api/qms/deviations          # æŸ¥è¯¢åå·®åˆ—è¡¨
GET    /api/qms/deviations/{id}     # æŸ¥è¯¢åå·®è¯¦æƒ…
PUT    /api/qms/deviations/{id}     # æ›´æ–°åå·®
DELETE /api/qms/deviations/{id}     # åˆ é™¤åå·®

# CAPAç®¡ç†
POST   /api/qms/capas               # åˆ›å»ºCAPA
GET    /api/qms/capas               # æŸ¥è¯¢CAPAåˆ—è¡¨
PUT    /api/qms/capas/{id}/status   # æ›´æ–°CAPAçŠ¶æ€
```

#### ç”Ÿäº§æ‰§è¡Œç³»ç»Ÿ (MES)
```http
# ç”Ÿäº§æ‰¹æ¬¡ç®¡ç†
POST   /api/mes/batches              # åˆ›å»ºç”Ÿäº§æ‰¹æ¬¡
GET    /api/mes/batches              # æŸ¥è¯¢æ‰¹æ¬¡åˆ—è¡¨
GET    /api/mes/batches/{id}         # æŸ¥è¯¢æ‰¹æ¬¡è¯¦æƒ…
PUT    /api/mes/batches/{id}/status  # æ›´æ–°æ‰¹æ¬¡çŠ¶æ€

# è®¾å¤‡ç®¡ç†
GET    /api/mes/equipment            # æŸ¥è¯¢è®¾å¤‡åˆ—è¡¨
PUT    /api/mes/equipment/{id}/status # æ›´æ–°è®¾å¤‡çŠ¶æ€
```

#### å®éªŒå®¤ä¿¡æ¯ç®¡ç†ç³»ç»Ÿ (LIMS)
```http
# æ ·å“ç®¡ç†
POST   /api/lims/samples             # åˆ›å»ºæ ·å“
GET    /api/lims/samples             # æŸ¥è¯¢æ ·å“åˆ—è¡¨
GET    /api/lims/samples/{id}        # æŸ¥è¯¢æ ·å“è¯¦æƒ…
PUT    /api/lims/samples/{id}/status # æ›´æ–°æ ·å“çŠ¶æ€

# æµ‹è¯•ç»“æœ
POST   /api/lims/test-results        # å½•å…¥æµ‹è¯•ç»“æœ
GET    /api/lims/test-results/{sampleId} # æŸ¥è¯¢æµ‹è¯•ç»“æœ
```

## ğŸ”§ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°çš„å¾®æœåŠ¡

1. **åˆ›å»ºæœåŠ¡æ¨¡å—**
```bash
mkdir -p services/{service-name}/src/main/{java/com/gmp/{service-name},resources}
```

2. **é…ç½®POMæ–‡ä»¶**
```xml
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <parent>
        <groupId>com.gmp</groupId>
        <artifactId>gmp-system</artifactId>
        <version>1.0.0-SNAPSHOT</version>
    </parent>

    <artifactId>{service-name}</artifactId>
    <name>GMP {Service Name} Service</name>
    <description>{Service Description}</description>

    <!-- ä¾èµ–é…ç½® -->
</project>
```

3. **é…ç½®ç½‘å…³è·¯ç”±**
åœ¨ `services/gateway/src/main/resources/application.yml` ä¸­æ·»åŠ è·¯ç”±ï¼š
```yaml
spring:
  cloud:
    gateway:
      routes:
        - id: {service-name}
          uri: lb://{service-name}
          predicates:
            - Path=/api/{service-name}/**
          filters:
            - StripPrefix=1
```

### æ•°æ®åº“è®¾è®¡

æ¯ä¸ªå¾®æœåŠ¡ä½¿ç”¨ç‹¬ç«‹çš„æ•°æ®åº“ï¼Œå‘½åè§„èŒƒï¼š
- `{service_name}_db` (ä¾‹å¦‚: qms_db, mes_db)

æ•°æ®åº“è¿ç§»æ–‡ä»¶æ”¾åœ¨ `services/{service-name}/src/main/resources/db/migration/` ç›®å½•ä¸‹ã€‚

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

### åº”ç”¨ç¨‹åºç›‘æ§

ä½¿ç”¨Spring Boot Actuatoræš´éœ²ç›‘æ§æŒ‡æ ‡ï¼š
- **å¥åº·æ£€æŸ¥**: `/actuator/health`
- **åº”ç”¨ä¿¡æ¯**: `/actuator/info`
- **æ€§èƒ½æŒ‡æ ‡**: `/actuator/metrics`
- **Prometheus**: `/actuator/prometheus`
- **æ—¥å¿—çº§åˆ«**: `/actuator/loggers`

### ç³»ç»Ÿç›‘æ§

- **Prometheus**: æ”¶é›†å’Œå­˜å‚¨æŒ‡æ ‡æ•°æ®
- **Grafana**: å¯è§†åŒ–ç›‘æ§é¢æ¿
- **ELK Stack**: æ—¥å¿—èšåˆå’Œåˆ†æ (å¯é€‰)

## ğŸ”’ å®‰å…¨é…ç½®

### JWTè®¤è¯
- é»˜è®¤JWTè¿‡æœŸæ—¶é—´: 24å°æ—¶
- åˆ·æ–°ä»¤ç‰Œè¿‡æœŸæ—¶é—´: 7å¤©
- æ”¯æŒå¤šç§Ÿæˆ·è®¤è¯

### å¯†ç ç­–ç•¥
- å¯†ç å¼ºåº¦è¦æ±‚
- å®šæœŸæ›´æ¢æé†’
- BCryptåŠ å¯†å­˜å‚¨

### APIå®‰å…¨
- åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ (RBAC)
- è¯·æ±‚é™æµå’Œç†”æ–­
- CORSè·¨åŸŸé…ç½®

## ğŸ”„ CI/CD æµç¨‹

### å¼€å‘åˆ†æ”¯
```bash
# å¼€å‘åˆ†æ”¯
git checkout develop

# åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
git checkout -b feature/your-feature-name

# æäº¤ä»£ç 
git add .
git commit -m "feat: add your feature"
git push origin feature/your-feature-name

# åˆ›å»ºPull Request
```

### ç”Ÿäº§éƒ¨ç½²
```bash
# æ„å»ºDockeré•œåƒ
mvn clean package -DskipTests
docker build -t gmp-system:latest .

# éƒ¨ç½²åˆ°Kubernetes
kubectl apply -f k8s/

# æˆ–ä½¿ç”¨Docker Compose (ç”Ÿäº§ç¯å¢ƒ)
docker-compose -f docker-compose.prod.yml up -d
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æ‰“å¼€ Pull Request

## ğŸ“ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·è”ç³»æŠ€æœ¯æ”¯æŒå›¢é˜Ÿæˆ–åˆ›å»º Issueã€‚

---

**ç‰ˆæœ¬**: 1.0.0-SNAPSHOT
**æ›´æ–°æ—¥æœŸ**: 2024å¹´11æœˆ
**ç»´æŠ¤è€…**: GMPå¼€å‘å›¢é˜Ÿ
