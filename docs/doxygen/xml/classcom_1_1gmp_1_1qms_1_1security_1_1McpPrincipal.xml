<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.8" xml:lang="en-US">
  <compounddef id="classcom_1_1gmp_1_1qms_1_1security_1_1McpPrincipal" kind="class" language="Java" prot="public">
    <compoundname>com::gmp::qms::security::McpPrincipal</compoundname>
    <sectiondef kind="private-attrib">
      <memberdef kind="variable" id="classcom_1_1gmp_1_1qms_1_1security_1_1McpPrincipal_1af44f99f35f5ab74bfd1466cf9d044aa3" prot="private" static="no" mutable="no">
        <type>final String</type>
        <definition>final String com.gmp.qms.security.McpPrincipal.clientId</definition>
        <argsstring></argsstring>
        <name>clientId</name>
        <qualifiedname>com.gmp.qms.security.McpPrincipal.clientId</qualifiedname>
        <briefdescription>
<para>客户端唯一标识 </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="qms-service/src/main/java/com/gmp/qms/security/McpPrincipal.java" line="24" column="26" bodyfile="qms-service/src/main/java/com/gmp/qms/security/McpPrincipal.java" bodystart="24" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="classcom_1_1gmp_1_1qms_1_1security_1_1McpPrincipal_1a5a4705cbaa04d4ebbad1a14181f52193" prot="private" static="no" mutable="no">
        <type>final String</type>
        <definition>final String com.gmp.qms.security.McpPrincipal.clientType</definition>
        <argsstring></argsstring>
        <name>clientType</name>
        <qualifiedname>com.gmp.qms.security.McpPrincipal.clientType</qualifiedname>
        <briefdescription>
<para>客户端类型（如：AI模型、系统服务等） </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="qms-service/src/main/java/com/gmp/qms/security/McpPrincipal.java" line="29" column="26" bodyfile="qms-service/src/main/java/com/gmp/qms/security/McpPrincipal.java" bodystart="29" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="classcom_1_1gmp_1_1qms_1_1security_1_1McpPrincipal_1a4d7190a1c765da423090e23a826de61b" prot="private" static="no" mutable="no">
        <type>final Claims</type>
        <definition>final Claims com.gmp.qms.security.McpPrincipal.claims</definition>
        <argsstring></argsstring>
        <name>claims</name>
        <qualifiedname>com.gmp.qms.security.McpPrincipal.claims</qualifiedname>
        <briefdescription>
<para>原始JWT声明，包含所有认证信息 </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="qms-service/src/main/java/com/gmp/qms/security/McpPrincipal.java" line="34" column="26" bodyfile="qms-service/src/main/java/com/gmp/qms/security/McpPrincipal.java" bodystart="34" bodyend="-1"/>
        <referencedby refid="classcom_1_1gmp_1_1qms_1_1security_1_1McpPrincipal_1af4e96faefe5767df7e7046f0380a3753" compoundref="McpPrincipal_8java" startline="87" endline="89">com.gmp.qms.security.McpPrincipal.getClaim</referencedby>
        <referencedby refid="classcom_1_1gmp_1_1qms_1_1security_1_1McpPrincipal_1a6c64e925acccb55a0940cf5cdaf7a37e" compoundref="McpPrincipal_8java" startline="62" endline="68">com.gmp.qms.security.McpPrincipal.getContext</referencedby>
        <referencedby refid="classcom_1_1gmp_1_1qms_1_1security_1_1McpPrincipal_1a740294526fe9ab1c5c6e0053327f7e72" compoundref="McpPrincipal_8java" startline="50" endline="56">com.gmp.qms.security.McpPrincipal.getPermissions</referencedby>
        <referencedby refid="classcom_1_1gmp_1_1qms_1_1security_1_1McpPrincipal_1a74331d4c7c013f08734f2415dfca3965" compoundref="McpPrincipal_8java" startline="39" endline="45">com.gmp.qms.security.McpPrincipal.getRoles</referencedby>
        <referencedby refid="classcom_1_1gmp_1_1qms_1_1security_1_1McpPrincipal_1a889aba8197b9c0e8606b276ac3b6b5b6" compoundref="McpPrincipal_8java" startline="94" endline="98">com.gmp.qms.security.McpPrincipal.isExpired</referencedby>
      </memberdef>
    </sectiondef>
    <sectiondef kind="public-func">
      <memberdef kind="function" id="classcom_1_1gmp_1_1qms_1_1security_1_1McpPrincipal_1a74331d4c7c013f08734f2415dfca3965" prot="public" static="no" const="no" explicit="no" inline="yes" virt="non-virtual">
        <type>Set&lt; String &gt;</type>
        <definition>Set&lt; String &gt; com.gmp.qms.security.McpPrincipal.getRoles</definition>
        <argsstring>()</argsstring>
        <name>getRoles</name>
        <qualifiedname>com.gmp.qms.security.McpPrincipal.getRoles</qualifiedname>
        <briefdescription>
<para>获取客户端的角色列表 </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="qms-service/src/main/java/com/gmp/qms/security/McpPrincipal.java" line="39" column="16" bodyfile="qms-service/src/main/java/com/gmp/qms/security/McpPrincipal.java" bodystart="39" bodyend="45"/>
        <references refid="classcom_1_1gmp_1_1qms_1_1security_1_1McpPrincipal_1a4d7190a1c765da423090e23a826de61b" compoundref="McpPrincipal_8java" startline="34">com.gmp.qms.security.McpPrincipal.claims</references>
        <referencedby refid="classcom_1_1gmp_1_1qms_1_1security_1_1McpPrincipal_1afc1f9435fd0a19f40f1e2ee9f83e5d51" compoundref="McpPrincipal_8java" startline="73" endline="75">com.gmp.qms.security.McpPrincipal.hasRole</referencedby>
      </memberdef>
      <memberdef kind="function" id="classcom_1_1gmp_1_1qms_1_1security_1_1McpPrincipal_1a740294526fe9ab1c5c6e0053327f7e72" prot="public" static="no" const="no" explicit="no" inline="yes" virt="non-virtual">
        <type>Set&lt; String &gt;</type>
        <definition>Set&lt; String &gt; com.gmp.qms.security.McpPrincipal.getPermissions</definition>
        <argsstring>()</argsstring>
        <name>getPermissions</name>
        <qualifiedname>com.gmp.qms.security.McpPrincipal.getPermissions</qualifiedname>
        <briefdescription>
<para>获取客户端的权限列表 </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="qms-service/src/main/java/com/gmp/qms/security/McpPrincipal.java" line="50" column="16" bodyfile="qms-service/src/main/java/com/gmp/qms/security/McpPrincipal.java" bodystart="50" bodyend="56"/>
        <references refid="classcom_1_1gmp_1_1qms_1_1security_1_1McpPrincipal_1a4d7190a1c765da423090e23a826de61b" compoundref="McpPrincipal_8java" startline="34">com.gmp.qms.security.McpPrincipal.claims</references>
        <referencedby refid="classcom_1_1gmp_1_1qms_1_1security_1_1McpPrincipal_1a1ecb8583ec6d2744eec1d435d9d403fc" compoundref="McpPrincipal_8java" startline="80" endline="82">com.gmp.qms.security.McpPrincipal.hasPermission</referencedby>
      </memberdef>
      <memberdef kind="function" id="classcom_1_1gmp_1_1qms_1_1security_1_1McpPrincipal_1a6c64e925acccb55a0940cf5cdaf7a37e" prot="public" static="no" const="no" explicit="no" inline="yes" virt="non-virtual">
        <type>Map&lt; String, Object &gt;</type>
        <definition>Map&lt; String, Object &gt; com.gmp.qms.security.McpPrincipal.getContext</definition>
        <argsstring>()</argsstring>
        <name>getContext</name>
        <qualifiedname>com.gmp.qms.security.McpPrincipal.getContext</qualifiedname>
        <briefdescription>
<para>获取客户端的上下文信息 </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="qms-service/src/main/java/com/gmp/qms/security/McpPrincipal.java" line="62" column="16" bodyfile="qms-service/src/main/java/com/gmp/qms/security/McpPrincipal.java" bodystart="62" bodyend="68"/>
        <references refid="classcom_1_1gmp_1_1qms_1_1security_1_1McpPrincipal_1a4d7190a1c765da423090e23a826de61b" compoundref="McpPrincipal_8java" startline="34">com.gmp.qms.security.McpPrincipal.claims</references>
      </memberdef>
      <memberdef kind="function" id="classcom_1_1gmp_1_1qms_1_1security_1_1McpPrincipal_1afc1f9435fd0a19f40f1e2ee9f83e5d51" prot="public" static="no" const="no" explicit="no" inline="yes" virt="non-virtual">
        <type>boolean</type>
        <definition>boolean com.gmp.qms.security.McpPrincipal.hasRole</definition>
        <argsstring>(String role)</argsstring>
        <name>hasRole</name>
        <qualifiedname>com.gmp.qms.security.McpPrincipal.hasRole</qualifiedname>
        <param>
          <type>String</type>
          <declname>role</declname>
        </param>
        <briefdescription>
<para>检查客户端是否有指定的角色 </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="qms-service/src/main/java/com/gmp/qms/security/McpPrincipal.java" line="73" column="20" bodyfile="qms-service/src/main/java/com/gmp/qms/security/McpPrincipal.java" bodystart="73" bodyend="75"/>
        <references refid="classcom_1_1gmp_1_1qms_1_1security_1_1McpPrincipal_1a74331d4c7c013f08734f2415dfca3965" compoundref="McpPrincipal_8java" startline="39" endline="45">com.gmp.qms.security.McpPrincipal.getRoles</references>
        <referencedby refid="classcom_1_1gmp_1_1qms_1_1security_1_1McpPermissionEvaluator_1a04e3ea111059b7be66beb0ff19ec3936" compoundref="McpPermissionEvaluator_8java" startline="128" endline="179">com.gmp.qms.security.McpPermissionEvaluator.hasResourcePermission</referencedby>
        <referencedby refid="classcom_1_1gmp_1_1qms_1_1security_1_1McpPermissionEvaluator_1a210f879be952f663018eb64132fd63cd" compoundref="McpPermissionEvaluator_8java" startline="76" endline="123">com.gmp.qms.security.McpPermissionEvaluator.hasToolPermission</referencedby>
      </memberdef>
      <memberdef kind="function" id="classcom_1_1gmp_1_1qms_1_1security_1_1McpPrincipal_1a1ecb8583ec6d2744eec1d435d9d403fc" prot="public" static="no" const="no" explicit="no" inline="yes" virt="non-virtual">
        <type>boolean</type>
        <definition>boolean com.gmp.qms.security.McpPrincipal.hasPermission</definition>
        <argsstring>(String permission)</argsstring>
        <name>hasPermission</name>
        <qualifiedname>com.gmp.qms.security.McpPrincipal.hasPermission</qualifiedname>
        <param>
          <type>String</type>
          <declname>permission</declname>
        </param>
        <briefdescription>
<para>检查客户端是否有指定的权限 </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="qms-service/src/main/java/com/gmp/qms/security/McpPrincipal.java" line="80" column="20" bodyfile="qms-service/src/main/java/com/gmp/qms/security/McpPrincipal.java" bodystart="80" bodyend="82"/>
        <references refid="classcom_1_1gmp_1_1qms_1_1security_1_1McpPrincipal_1a740294526fe9ab1c5c6e0053327f7e72" compoundref="McpPrincipal_8java" startline="50" endline="56">com.gmp.qms.security.McpPrincipal.getPermissions</references>
        <referencedby refid="classcom_1_1gmp_1_1qms_1_1security_1_1McpPermissionEvaluator_1a04e3ea111059b7be66beb0ff19ec3936" compoundref="McpPermissionEvaluator_8java" startline="128" endline="179">com.gmp.qms.security.McpPermissionEvaluator.hasResourcePermission</referencedby>
        <referencedby refid="classcom_1_1gmp_1_1qms_1_1security_1_1McpPermissionEvaluator_1a210f879be952f663018eb64132fd63cd" compoundref="McpPermissionEvaluator_8java" startline="76" endline="123">com.gmp.qms.security.McpPermissionEvaluator.hasToolPermission</referencedby>
      </memberdef>
      <memberdef kind="function" id="classcom_1_1gmp_1_1qms_1_1security_1_1McpPrincipal_1a889aba8197b9c0e8606b276ac3b6b5b6" prot="public" static="no" const="no" explicit="no" inline="yes" virt="non-virtual">
        <type>boolean</type>
        <definition>boolean com.gmp.qms.security.McpPrincipal.isExpired</definition>
        <argsstring>()</argsstring>
        <name>isExpired</name>
        <qualifiedname>com.gmp.qms.security.McpPrincipal.isExpired</qualifiedname>
        <briefdescription>
<para>检查令牌是否过期 </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="qms-service/src/main/java/com/gmp/qms/security/McpPrincipal.java" line="94" column="20" bodyfile="qms-service/src/main/java/com/gmp/qms/security/McpPrincipal.java" bodystart="94" bodyend="98"/>
        <references refid="classcom_1_1gmp_1_1qms_1_1security_1_1McpPrincipal_1a4d7190a1c765da423090e23a826de61b" compoundref="McpPrincipal_8java" startline="34">com.gmp.qms.security.McpPrincipal.claims</references>
      </memberdef>
    </sectiondef>
    <sectiondef kind="package-func">
      <memberdef kind="function" id="classcom_1_1gmp_1_1qms_1_1security_1_1McpPrincipal_1af4e96faefe5767df7e7046f0380a3753" prot="package" static="no" const="no" explicit="no" inline="yes" virt="non-virtual">
        <type>public&lt; T &gt; T</type>
        <definition>public&lt; T &gt; T com.gmp.qms.security.McpPrincipal.getClaim</definition>
        <argsstring>(String key, Class&lt; T &gt; valueType)</argsstring>
        <name>getClaim</name>
        <qualifiedname>com.gmp.qms.security.McpPrincipal.getClaim</qualifiedname>
        <param>
          <type>String</type>
          <declname>key</declname>
        </param>
        <param>
          <type>Class&lt; T &gt;</type>
          <declname>valueType</declname>
        </param>
        <briefdescription>
<para>获取声明中的自定义属性 </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="qms-service/src/main/java/com/gmp/qms/security/McpPrincipal.java" line="87" column="15" bodyfile="qms-service/src/main/java/com/gmp/qms/security/McpPrincipal.java" bodystart="87" bodyend="89"/>
        <references refid="classcom_1_1gmp_1_1qms_1_1security_1_1McpPrincipal_1a4d7190a1c765da423090e23a826de61b" compoundref="McpPrincipal_8java" startline="34">com.gmp.qms.security.McpPrincipal.claims</references>
      </memberdef>
    </sectiondef>
    <briefdescription>
<para>MCP主体，存储MCP客户端的身份信息和相关上下文数据 </para>
    </briefdescription>
    <detaileddescription>
<para><simplesect kind="author"><para>GMP系统开发团队 </para>
</simplesect>
</para>
    </detaileddescription>
    <collaborationgraph>
      <node id="2">
        <label>String</label>
      </node>
      <node id="1">
        <label>com.gmp.qms.security.McpPrincipal</label>
        <link refid="classcom_1_1gmp_1_1qms_1_1security_1_1McpPrincipal"/>
        <childnode refid="2" relation="usage">
          <edgelabel>clientId</edgelabel>
          <edgelabel>clientType</edgelabel>
        </childnode>
        <childnode refid="3" relation="usage">
          <edgelabel>claims</edgelabel>
        </childnode>
      </node>
      <node id="3">
        <label>final Claims</label>
      </node>
    </collaborationgraph>
    <location file="qms-service/src/main/java/com/gmp/qms/security/McpPrincipal.java" line="19" column="7" bodyfile="qms-service/src/main/java/com/gmp/qms/security/McpPrincipal.java" bodystart="19" bodyend="99"/>
    <listofallmembers>
      <member refid="classcom_1_1gmp_1_1qms_1_1security_1_1McpPrincipal_1a4d7190a1c765da423090e23a826de61b" prot="private" virt="non-virtual"><scope>com::gmp::qms::security::McpPrincipal</scope><name>claims</name></member>
      <member refid="classcom_1_1gmp_1_1qms_1_1security_1_1McpPrincipal_1af44f99f35f5ab74bfd1466cf9d044aa3" prot="private" virt="non-virtual"><scope>com::gmp::qms::security::McpPrincipal</scope><name>clientId</name></member>
      <member refid="classcom_1_1gmp_1_1qms_1_1security_1_1McpPrincipal_1a5a4705cbaa04d4ebbad1a14181f52193" prot="private" virt="non-virtual"><scope>com::gmp::qms::security::McpPrincipal</scope><name>clientType</name></member>
      <member refid="classcom_1_1gmp_1_1qms_1_1security_1_1McpPrincipal_1af4e96faefe5767df7e7046f0380a3753" prot="package" virt="non-virtual"><scope>com::gmp::qms::security::McpPrincipal</scope><name>getClaim</name></member>
      <member refid="classcom_1_1gmp_1_1qms_1_1security_1_1McpPrincipal_1a6c64e925acccb55a0940cf5cdaf7a37e" prot="public" virt="non-virtual"><scope>com::gmp::qms::security::McpPrincipal</scope><name>getContext</name></member>
      <member refid="classcom_1_1gmp_1_1qms_1_1security_1_1McpPrincipal_1a740294526fe9ab1c5c6e0053327f7e72" prot="public" virt="non-virtual"><scope>com::gmp::qms::security::McpPrincipal</scope><name>getPermissions</name></member>
      <member refid="classcom_1_1gmp_1_1qms_1_1security_1_1McpPrincipal_1a74331d4c7c013f08734f2415dfca3965" prot="public" virt="non-virtual"><scope>com::gmp::qms::security::McpPrincipal</scope><name>getRoles</name></member>
      <member refid="classcom_1_1gmp_1_1qms_1_1security_1_1McpPrincipal_1a1ecb8583ec6d2744eec1d435d9d403fc" prot="public" virt="non-virtual"><scope>com::gmp::qms::security::McpPrincipal</scope><name>hasPermission</name></member>
      <member refid="classcom_1_1gmp_1_1qms_1_1security_1_1McpPrincipal_1afc1f9435fd0a19f40f1e2ee9f83e5d51" prot="public" virt="non-virtual"><scope>com::gmp::qms::security::McpPrincipal</scope><name>hasRole</name></member>
      <member refid="classcom_1_1gmp_1_1qms_1_1security_1_1McpPrincipal_1a889aba8197b9c0e8606b276ac3b6b5b6" prot="public" virt="non-virtual"><scope>com::gmp::qms::security::McpPrincipal</scope><name>isExpired</name></member>
    </listofallmembers>
  </compounddef>
</doxygen>
