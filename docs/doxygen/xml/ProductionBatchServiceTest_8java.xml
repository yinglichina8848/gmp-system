<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.8" xml:lang="en-US">
  <compounddef id="ProductionBatchServiceTest_8java" kind="file" language="Java">
    <compoundname>ProductionBatchServiceTest.java</compoundname>
    <includes local="no">com.gmp.mes.entity.ProductionBatch</includes>
    <incdepgraph>
      <node id="1">
        <label>mes-service/src/test/java/com/gmp/mes/service/ProductionBatchServiceTest.java</label>
        <link refid="ProductionBatchServiceTest_8java"/>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="2">
        <label>com.gmp.mes.entity.ProductionBatch</label>
      </node>
    </incdepgraph>
    <innerclass refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest" prot="package">com::gmp::mes::service::ProductionBatchServiceTest</innerclass>
    <innernamespace refid="namespacecom_1_1gmp_1_1mes_1_1service">com::gmp::mes::service</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="keyword">package<sp/></highlight><highlight class="normal">com.gmp.mes.service;</highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>com.gmp.mes.entity.ProductionBatch;</highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>com.gmp.mes.entity.ProductionOrder;</highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>com.gmp.mes.repository.ProductionBatchRepository;</highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>org.junit.jupiter.api.BeforeEach;</highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>org.junit.jupiter.api.Test;</highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>org.mockito.InjectMocks;</highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>org.mockito.Mock;</highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>org.mockito.MockitoAnnotations;</highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.time.LocalDateTime;</highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.*;</highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>org.junit.jupiter.api.Assertions.*;</highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>org.mockito.ArgumentMatchers.any;</highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>org.mockito.Mockito.*;</highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight></codeline>
<codeline lineno="24" refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest" kindref="compound">ProductionBatchServiceTest</ref><sp/>{</highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"><sp/><sp/><sp/><sp/>@Mock</highlight></codeline>
<codeline lineno="27" refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>ProductionBatchRepository<sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" kindref="member">productionBatchRepository</ref>;</highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight></codeline>
<codeline lineno="29"><highlight class="normal"><sp/><sp/><sp/><sp/>@Mock</highlight></codeline>
<codeline lineno="30" refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1aca5529d92b793aad4bb59ac5c5acbde6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionOrderService" kindref="compound">ProductionOrderService</ref><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1aca5529d92b793aad4bb59ac5c5acbde6" kindref="member">productionOrderService</ref>;</highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"><sp/><sp/><sp/><sp/>@InjectMocks</highlight></codeline>
<codeline lineno="33" refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a30e815008f08a6d043f37a70f1119162" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchService" kindref="compound">ProductionBatchService</ref><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a30e815008f08a6d043f37a70f1119162" kindref="member">productionBatchService</ref>;</highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight></codeline>
<codeline lineno="35" refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>ProductionBatch<sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>;</highlight></codeline>
<codeline lineno="36" refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1aba2254b4190bb3f50b9f465beec8b343" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>ProductionOrder<sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1aba2254b4190bb3f50b9f465beec8b343" kindref="member">testOrder</ref>;</highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/><sp/><sp/>@BeforeEach</highlight></codeline>
<codeline lineno="39" refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1ac47928fb83b477a902e71c1aa610e1bc" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1ac47928fb83b477a902e71c1aa610e1bc" kindref="member">setUp</ref>()<sp/>{</highlight></codeline>
<codeline lineno="40"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MockitoAnnotations.openMocks(</highlight><highlight class="keyword">this</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>创建测试订单</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1aba2254b4190bb3f50b9f465beec8b343" kindref="member">testOrder</ref><sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>ProductionOrder();</highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1aba2254b4190bb3f50b9f465beec8b343" kindref="member">testOrder</ref>.setId(1L);</highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1aba2254b4190bb3f50b9f465beec8b343" kindref="member">testOrder</ref>.setOrderNumber(</highlight><highlight class="stringliteral">&quot;ORD-2024-001&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>创建测试批次</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref><sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>ProductionBatch();</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>.setId(1L);</highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>.setBatchNumber(</highlight><highlight class="stringliteral">&quot;BATCH-2024-001&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>.setOrderId(1L);</highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>.setOrder(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1aba2254b4190bb3f50b9f465beec8b343" kindref="member">testOrder</ref>);</highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>.setProductId(</highlight><highlight class="stringliteral">&quot;PROD-001&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>.setProductName(</highlight><highlight class="stringliteral">&quot;Test<sp/>Product&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>.setEquipmentId(</highlight><highlight class="stringliteral">&quot;EQP-001&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>.setEquipmentName(</highlight><highlight class="stringliteral">&quot;Test<sp/>Equipment&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>.setPlanQuantity(100);</highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>.setActualQuantity(0);</highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>.setStatus(ProductionBatch.BatchStatus.PENDING);</highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>.setOperator(</highlight><highlight class="stringliteral">&quot;操作员1&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="62"><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/>@Test</highlight></codeline>
<codeline lineno="64" refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1acbe266cc1e27e085594d39f25e1ecd7a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1acbe266cc1e27e085594d39f25e1ecd7a" kindref="member">testCreateProductionBatch</ref>()<sp/>{</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>when(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1aca5529d92b793aad4bb59ac5c5acbde6" kindref="member">productionOrderService</ref>.<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionOrderService_1a15a522691cac698dbc2da42a2e82bfe5" kindref="member">getProductionOrderById</ref>(1L)).thenReturn(Optional.of(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1aba2254b4190bb3f50b9f465beec8b343" kindref="member">testOrder</ref>));</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>when(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" kindref="member">productionBatchRepository</ref>.save(any(ProductionBatch.class))).thenReturn(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>);</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ProductionBatch<sp/>createdBatch<sp/>=<sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a30e815008f08a6d043f37a70f1119162" kindref="member">productionBatchService</ref>.<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchService_1a10456f0481d52152cb01ad7488d590bd" kindref="member">createProductionBatch</ref>(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>);</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assertNotNull(createdBatch);</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assertEquals(</highlight><highlight class="stringliteral">&quot;BATCH-2024-001&quot;</highlight><highlight class="normal">,<sp/>createdBatch.getBatchNumber());</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assertEquals(ProductionBatch.BatchStatus.PENDING,<sp/>createdBatch.getStatus());</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>verify(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" kindref="member">productionBatchRepository</ref>,<sp/>times(1)).save(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>);</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="75"><highlight class="normal"></highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/>@Test</highlight></codeline>
<codeline lineno="77" refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1ace1c391f922b6419f2d9133374b291b7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1ace1c391f922b6419f2d9133374b291b7" kindref="member">testGetProductionBatchById</ref>()<sp/>{</highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>when(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" kindref="member">productionBatchRepository</ref>.findById(1L)).thenReturn(Optional.of(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>));</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Optional&lt;ProductionBatch&gt;<sp/>foundBatch<sp/>=<sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a30e815008f08a6d043f37a70f1119162" kindref="member">productionBatchService</ref>.<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchService_1ac6086b710ebc6108f2b9d83052f11fa4" kindref="member">getProductionBatchById</ref>(1L);</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assertTrue(foundBatch.isPresent());</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assertEquals(</highlight><highlight class="stringliteral">&quot;BATCH-2024-001&quot;</highlight><highlight class="normal">,<sp/>foundBatch.get().getBatchNumber());</highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>verify(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" kindref="member">productionBatchRepository</ref>,<sp/>times(1)).findById(1L);</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/>@Test</highlight></codeline>
<codeline lineno="88" refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1abcb98246e557d5431651f10117e7dd77" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1abcb98246e557d5431651f10117e7dd77" kindref="member">testGetProductionBatchByBatchNumber</ref>()<sp/>{</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>when(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" kindref="member">productionBatchRepository</ref>.findByBatchNumber(</highlight><highlight class="stringliteral">&quot;BATCH-2024-001&quot;</highlight><highlight class="normal">)).thenReturn(Optional.of(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>));</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Optional&lt;ProductionBatch&gt;<sp/>foundBatch<sp/>=<sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a30e815008f08a6d043f37a70f1119162" kindref="member">productionBatchService</ref>.<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchService_1a6874b63b5243771834f7e7f133574b14" kindref="member">getProductionBatchByBatchNumber</ref>(</highlight><highlight class="stringliteral">&quot;BATCH-2024-001&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assertTrue(foundBatch.isPresent());</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assertEquals(1L,<sp/>foundBatch.get().getId());</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>verify(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" kindref="member">productionBatchRepository</ref>,<sp/>times(1)).findByBatchNumber(</highlight><highlight class="stringliteral">&quot;BATCH-2024-001&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="97"><highlight class="normal"></highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/>@Test</highlight></codeline>
<codeline lineno="99" refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a2f7a51f942bbc24c7350711ce6a002bb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a2f7a51f942bbc24c7350711ce6a002bb" kindref="member">testGetAllProductionBatches</ref>()<sp/>{</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>List&lt;ProductionBatch&gt;<sp/>batches<sp/>=<sp/>Arrays.asList(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>);</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>when(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" kindref="member">productionBatchRepository</ref>.findAll()).thenReturn(batches);</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>List&lt;ProductionBatch&gt;<sp/>allBatches<sp/>=<sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a30e815008f08a6d043f37a70f1119162" kindref="member">productionBatchService</ref>.<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchService_1a329e49b0ba9eb2511d915470d1ece85f" kindref="member">getAllProductionBatches</ref>();</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assertNotNull(allBatches);</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assertEquals(1,<sp/>allBatches.size());</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>verify(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" kindref="member">productionBatchRepository</ref>,<sp/>times(1)).findAll();</highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="109"><highlight class="normal"></highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/>@Test</highlight></codeline>
<codeline lineno="111" refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1aaf80d469af670ea806c25ddc0175dc82" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1aaf80d469af670ea806c25ddc0175dc82" kindref="member">testGetProductionBatchesByOrderId</ref>()<sp/>{</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>List&lt;ProductionBatch&gt;<sp/>batches<sp/>=<sp/>Arrays.asList(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>);</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>when(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" kindref="member">productionBatchRepository</ref>.findByOrderId(1L)).thenReturn(batches);</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>List&lt;ProductionBatch&gt;<sp/>orderBatches<sp/>=<sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a30e815008f08a6d043f37a70f1119162" kindref="member">productionBatchService</ref>.<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchService_1aa4be78d5038bc64d0d2bfc07442bb3e3" kindref="member">getProductionBatchesByOrderId</ref>(1L);</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assertNotNull(orderBatches);</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assertEquals(1,<sp/>orderBatches.size());</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>verify(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" kindref="member">productionBatchRepository</ref>,<sp/>times(1)).findByOrderId(1L);</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="121"><highlight class="normal"></highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/>@Test</highlight></codeline>
<codeline lineno="123" refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1ac79583edc7e51910feb795f0be18b5f9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1ac79583edc7e51910feb795f0be18b5f9" kindref="member">testUpdateProductionBatch</ref>()<sp/>{</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>when(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" kindref="member">productionBatchRepository</ref>.findById(1L)).thenReturn(Optional.of(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>));</highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>when(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" kindref="member">productionBatchRepository</ref>.save(any(ProductionBatch.class))).thenReturn(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>);</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>.setPlanQuantity(150);</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>.setRemark(</highlight><highlight class="stringliteral">&quot;Updated<sp/>batch&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ProductionBatch<sp/>updatedBatch<sp/>=<sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a30e815008f08a6d043f37a70f1119162" kindref="member">productionBatchService</ref>.<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchService_1af900202f4af4d696e44460e4c5ac1bdc" kindref="member">updateProductionBatch</ref>(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>);</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assertNotNull(updatedBatch);</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assertEquals(150,<sp/>updatedBatch.getPlanQuantity());</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assertEquals(</highlight><highlight class="stringliteral">&quot;Updated<sp/>batch&quot;</highlight><highlight class="normal">,<sp/>updatedBatch.getRemark());</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>verify(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" kindref="member">productionBatchRepository</ref>,<sp/>times(1)).save(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>);</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="137"><highlight class="normal"></highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/>@Test</highlight></codeline>
<codeline lineno="139" refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a551313ae1db5d4e70061c1bb4ae6eb58" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a551313ae1db5d4e70061c1bb4ae6eb58" kindref="member">testDeleteProductionBatch</ref>()<sp/>{</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>when(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" kindref="member">productionBatchRepository</ref>.existsById(1L)).thenReturn(</highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>doNothing().when(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" kindref="member">productionBatchRepository</ref>).deleteById(1L);</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a30e815008f08a6d043f37a70f1119162" kindref="member">productionBatchService</ref>.<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchService_1a78582844fc969d605b0cf85897272309" kindref="member">deleteProductionBatch</ref>(1L);</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>verify(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" kindref="member">productionBatchRepository</ref>,<sp/>times(1)).existsById(1L);</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>verify(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" kindref="member">productionBatchRepository</ref>,<sp/>times(1)).deleteById(1L);</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="148"><highlight class="normal"></highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/>@Test</highlight></codeline>
<codeline lineno="150" refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a9f4564aab76fb4007957317d8c18fd05" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a9f4564aab76fb4007957317d8c18fd05" kindref="member">testStartProductionBatch</ref>()<sp/>{</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>when(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" kindref="member">productionBatchRepository</ref>.findById(1L)).thenReturn(Optional.of(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>));</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>when(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" kindref="member">productionBatchRepository</ref>.save(any(ProductionBatch.class))).thenReturn(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>);</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ProductionBatch<sp/>startedBatch<sp/>=<sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a30e815008f08a6d043f37a70f1119162" kindref="member">productionBatchService</ref>.<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchService_1af8e0b3ab0b7b7e5155dc71f06e3f78cd" kindref="member">startProductionBatch</ref>(1L);</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assertEquals(ProductionBatch.BatchStatus.IN_PROGRESS,<sp/>startedBatch.getStatus());</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assertNotNull(startedBatch.getActualStartTime());</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>verify(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" kindref="member">productionBatchRepository</ref>,<sp/>times(1)).save(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>);</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="160"><highlight class="normal"></highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/>@Test</highlight></codeline>
<codeline lineno="162" refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1af724cc10ee290e76759090d890d3eb5c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1af724cc10ee290e76759090d890d3eb5c" kindref="member">testCompleteProductionBatch</ref>()<sp/>{</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>.setStatus(ProductionBatch.BatchStatus.IN_PROGRESS);</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>.setPlanQuantity(100);</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>.setActualQuantity(100);</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>when(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" kindref="member">productionBatchRepository</ref>.findById(1L)).thenReturn(Optional.of(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>));</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>when(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" kindref="member">productionBatchRepository</ref>.save(any(ProductionBatch.class))).thenReturn(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>);</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ProductionBatch<sp/>completedBatch<sp/>=<sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a30e815008f08a6d043f37a70f1119162" kindref="member">productionBatchService</ref>.<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchService_1ad3f92275e6fc9681664b525ce61f5f15" kindref="member">completeProductionBatch</ref>(1L);</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assertEquals(ProductionBatch.BatchStatus.COMPLETED,<sp/>completedBatch.getStatus());</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assertNotNull(completedBatch.getActualEndTime());</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>verify(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" kindref="member">productionBatchRepository</ref>,<sp/>times(1)).save(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>);</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="175"><highlight class="normal"></highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/>@Test</highlight></codeline>
<codeline lineno="177" refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a1e89b229d844bf4ce531abc553628894" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a1e89b229d844bf4ce531abc553628894" kindref="member">testPauseProductionBatch</ref>()<sp/>{</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>.setStatus(ProductionBatch.BatchStatus.IN_PROGRESS);</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>when(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" kindref="member">productionBatchRepository</ref>.findById(1L)).thenReturn(Optional.of(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>));</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>when(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" kindref="member">productionBatchRepository</ref>.save(any(ProductionBatch.class))).thenReturn(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>);</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ProductionBatch<sp/>pausedBatch<sp/>=<sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a30e815008f08a6d043f37a70f1119162" kindref="member">productionBatchService</ref>.<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchService_1a1b7a44bdccabfa68ce44908969445924" kindref="member">pauseProductionBatch</ref>(1L,<sp/></highlight><highlight class="stringliteral">&quot;设备维护&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assertEquals(ProductionBatch.BatchStatus.PAUSED,<sp/>pausedBatch.getStatus());</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assertTrue(pausedBatch.getRemark().contains(</highlight><highlight class="stringliteral">&quot;设备维护&quot;</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>verify(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" kindref="member">productionBatchRepository</ref>,<sp/>times(1)).save(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>);</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="188"><highlight class="normal"></highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/>@Test</highlight></codeline>
<codeline lineno="190" refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a907bc5263a6b27704ef67c9a6c8f070d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a907bc5263a6b27704ef67c9a6c8f070d" kindref="member">testResumeProductionBatch</ref>()<sp/>{</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>.setStatus(ProductionBatch.BatchStatus.PAUSED);</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>when(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" kindref="member">productionBatchRepository</ref>.findById(1L)).thenReturn(Optional.of(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>));</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>when(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" kindref="member">productionBatchRepository</ref>.save(any(ProductionBatch.class))).thenReturn(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>);</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ProductionBatch<sp/>resumedBatch<sp/>=<sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a30e815008f08a6d043f37a70f1119162" kindref="member">productionBatchService</ref>.<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchService_1a3a722f02e06a20ca3bd6892316302927" kindref="member">resumeProductionBatch</ref>(1L);</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assertEquals(ProductionBatch.BatchStatus.IN_PROGRESS,<sp/>resumedBatch.getStatus());</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>verify(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" kindref="member">productionBatchRepository</ref>,<sp/>times(1)).save(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>);</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="200"><highlight class="normal"></highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/>@Test</highlight></codeline>
<codeline lineno="202" refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1ad48d114b16ed89a8f5acf9ca7769f592" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1ad48d114b16ed89a8f5acf9ca7769f592" kindref="member">testMarkProductionBatchFailed</ref>()<sp/>{</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>.setStatus(ProductionBatch.BatchStatus.IN_PROGRESS);</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>when(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" kindref="member">productionBatchRepository</ref>.findById(1L)).thenReturn(Optional.of(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>));</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>when(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" kindref="member">productionBatchRepository</ref>.save(any(ProductionBatch.class))).thenReturn(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>);</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ProductionBatch<sp/>failedBatch<sp/>=<sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a30e815008f08a6d043f37a70f1119162" kindref="member">productionBatchService</ref>.markProductionBatchFailed(1L,<sp/></highlight><highlight class="stringliteral">&quot;质量问题&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;操作员2&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assertEquals(ProductionBatch.BatchStatus.FAILED,<sp/>failedBatch.getStatus());</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assertTrue(failedBatch.getRemark().contains(</highlight><highlight class="stringliteral">&quot;质量问题&quot;</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assertEquals(</highlight><highlight class="stringliteral">&quot;操作员2&quot;</highlight><highlight class="normal">,<sp/>failedBatch.getLastOperator());</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>verify(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" kindref="member">productionBatchRepository</ref>,<sp/>times(1)).save(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>);</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="214"><highlight class="normal"></highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/>@Test</highlight></codeline>
<codeline lineno="216" refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a408479cce6159cf0da259d9052c403f0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a408479cce6159cf0da259d9052c403f0" kindref="member">testFindProductionBatchesByStatus</ref>()<sp/>{</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>List&lt;ProductionBatch&gt;<sp/>batches<sp/>=<sp/>Arrays.asList(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>);</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>when(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" kindref="member">productionBatchRepository</ref>.findByStatus(ProductionBatch.BatchStatus.PENDING)).thenReturn(batches);</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>List&lt;ProductionBatch&gt;<sp/>foundBatches<sp/>=<sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a30e815008f08a6d043f37a70f1119162" kindref="member">productionBatchService</ref>.findProductionBatchesByStatus(ProductionBatch.BatchStatus.PENDING);</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assertNotNull(foundBatches);</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assertEquals(1,<sp/>foundBatches.size());</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>verify(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" kindref="member">productionBatchRepository</ref>,<sp/>times(1)).findByStatus(ProductionBatch.BatchStatus.PENDING);</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="226"><highlight class="normal"></highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/>@Test</highlight></codeline>
<codeline lineno="228" refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1ab91f0666adbd4704e5439359d469c832" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1ab91f0666adbd4704e5439359d469c832" kindref="member">testGenerateBatchNumber</ref>()<sp/>{</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>String<sp/>batchNumber<sp/>=<sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a30e815008f08a6d043f37a70f1119162" kindref="member">productionBatchService</ref>.<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchService_1a08dcc8ef40db4808a311f6bc9e635b9a" kindref="member">generateBatchNumber</ref>();</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assertNotNull(batchNumber);</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assertTrue(batchNumber.startsWith(</highlight><highlight class="stringliteral">&quot;BATCH-&quot;</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assertTrue(batchNumber.length()<sp/>&gt;<sp/>12);</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="235"><highlight class="normal"></highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/>@Test</highlight></codeline>
<codeline lineno="237" refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a928ac9423c1c02588b4a8f8a11b58764" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a928ac9423c1c02588b4a8f8a11b58764" kindref="member">testUpdateBatchQuantity</ref>()<sp/>{</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>when(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" kindref="member">productionBatchRepository</ref>.findById(1L)).thenReturn(Optional.of(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>));</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>when(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" kindref="member">productionBatchRepository</ref>.save(any(ProductionBatch.class))).thenReturn(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>);</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ProductionBatch<sp/>updatedBatch<sp/>=<sp/><ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a30e815008f08a6d043f37a70f1119162" kindref="member">productionBatchService</ref>.updateBatchQuantity(1L,<sp/>50);</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assertEquals(50,<sp/>updatedBatch.getActualQuantity());</highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>verify(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a6bee17ba54f478407d0c159c2a6ec32e" kindref="member">productionBatchRepository</ref>,<sp/>times(1)).save(<ref refid="classcom_1_1gmp_1_1mes_1_1service_1_1ProductionBatchServiceTest_1a8e5e7534b5a1d8a68684a60f4296b5de" kindref="member">testBatch</ref>);</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="246"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="mes-service/src/test/java/com/gmp/mes/service/ProductionBatchServiceTest.java"/>
  </compounddef>
</doxygen>
