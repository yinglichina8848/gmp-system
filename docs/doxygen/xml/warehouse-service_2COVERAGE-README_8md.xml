<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.8" xml:lang="en-US">
  <compounddef id="warehouse-service_2COVERAGE-README_8md" kind="file" language="Markdown">
    <compoundname>COVERAGE-README.md</compoundname>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline><highlight class="normal">#<sp/>GMP仓库管理子系统<sp/>-<sp/>代码覆盖率测试指南</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">##<sp/>📊<sp/>概述</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">本文档介绍如何使用JaCoCo代码覆盖率工具测试GMP仓库管理子系统的代码覆盖率，确保代码质量符合企业标准。</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">##<sp/>🎯<sp/>覆盖率目标</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">|<sp/>指标<sp/>|<sp/>目标值<sp/>|<sp/>说明<sp/>|</highlight></codeline>
<codeline><highlight class="normal">|------|--------|------|</highlight></codeline>
<codeline><highlight class="normal">|<sp/>行覆盖率<sp/>|<sp/>≥80%<sp/>|<sp/>代码行的执行覆盖率<sp/>|</highlight></codeline>
<codeline><highlight class="normal">|<sp/>分支覆盖率<sp/>|<sp/>≥70%<sp/>|<sp/>条件分支的覆盖率<sp/>|</highlight></codeline>
<codeline><highlight class="normal">|<sp/>类覆盖率<sp/>|<sp/>≥90%<sp/>|<sp/>类的覆盖率<sp/>|</highlight></codeline>
<codeline><highlight class="normal">|<sp/>方法覆盖率<sp/>|<sp/>≥80%<sp/>|<sp/>方法的覆盖率<sp/>|</highlight></codeline>
<codeline><highlight class="normal">|<sp/>指令覆盖率<sp/>|<sp/>≥75%<sp/>|<sp/>字节码指令的覆盖率<sp/>|</highlight></codeline>
<codeline><highlight class="normal">|<sp/>圈复杂度覆盖率<sp/>|<sp/>≥70%<sp/>|<sp/>复杂条件的覆盖率<sp/>|</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">##<sp/>🛠️<sp/>环境配置</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">###<sp/>技术栈</highlight></codeline>
<codeline><highlight class="normal">-<sp/>**JaCoCo**:<sp/>0.8.8<sp/>-<sp/>代码覆盖率工具</highlight></codeline>
<codeline><highlight class="normal">-<sp/>**JUnit<sp/>5**:<sp/>单元测试框架</highlight></codeline>
<codeline><highlight class="normal">-<sp/>**AssertJ**:<sp/>流畅断言库</highlight></codeline>
<codeline><highlight class="normal">-<sp/>**H2<sp/>Database**:<sp/>测试内存数据库</highlight></codeline>
<codeline><highlight class="normal">-<sp/>**Redis**:<sp/>测试缓存数据库（DB<sp/>15）</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">###<sp/>配置说明</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">####<sp/>测试配置文件</highlight></codeline>
<codeline><highlight class="normal">-<sp/>`src/test/resources/application-test.yml`:<sp/>测试环境配置</highlight></codeline>
<codeline><highlight class="normal">-<sp/>`src/test/resources/jacoco-rules.properties`:<sp/>覆盖率质量阈值</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">####<sp/>Maven插件配置</highlight></codeline>
<codeline><highlight class="normal">-<sp/>JaCoCo插件:<sp/>自动注入覆盖率代理</highlight></codeline>
<codeline><highlight class="normal">-<sp/>Surefire插件:<sp/>执行单元测试</highlight></codeline>
<codeline><highlight class="normal">-<sp/>Failsafe插件:<sp/>执行集成测试</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">##<sp/>🚀<sp/>运行测试</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">###<sp/>方法1:<sp/>使用自动化脚本（推荐）</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">```bash</highlight></codeline>
<codeline><highlight class="normal">#<sp/>从项目根目录运行</highlight></codeline>
<codeline><highlight class="normal">./scripts/run-coverage-tests.sh</highlight></codeline>
<codeline><highlight class="normal">```</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">###<sp/>方法2:<sp/>手动运行Maven命令</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">```bash</highlight></codeline>
<codeline><highlight class="normal">#<sp/>进入warehouse-service目录</highlight></codeline>
<codeline><highlight class="normal">cd<sp/>/home/liying/gmp-system/services/warehouse-service</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">#<sp/>运行单元测试并生成覆盖率报告</highlight></codeline>
<codeline><highlight class="normal">mvn<sp/>clean<sp/>test<sp/>jacoco:report</highlight></codeline>
<codeline><highlight class="normal">```</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">###<sp/>方法3:<sp/>运行特定测试类</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">```bash</highlight></codeline>
<codeline><highlight class="normal">#<sp/>运行特定测试类</highlight></codeline>
<codeline><highlight class="normal">mvn<sp/>test<sp/>-Dtest=WarehouseServiceImplTest</highlight></codeline>
<codeline><highlight class="normal">```</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">##<sp/>📈<sp/>查看覆盖率报告</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">运行测试后，覆盖率报告将生成在以下目录：</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">```</highlight></codeline>
<codeline><highlight class="normal">/home/liying/gmp-system/services/warehouse-service/target/site/jacoco/</highlight></codeline>
<codeline><highlight class="normal">```</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">打开`index.html`文件即可查看详细的覆盖率报告。</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">##<sp/>📋<sp/>覆盖率报告说明</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">###<sp/>报告结构</highlight></codeline>
<codeline><highlight class="normal">-<sp/>**项目总览**:<sp/>显示整体覆盖率指标</highlight></codeline>
<codeline><highlight class="normal">-<sp/>**包覆盖率**:<sp/>按包查看覆盖率</highlight></codeline>
<codeline><highlight class="normal">-<sp/>**类覆盖率**:<sp/>按类查看覆盖率</highlight></codeline>
<codeline><highlight class="normal">-<sp/>**源代码覆盖率**:<sp/>查看具体源代码的覆盖情况</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">###<sp/>覆盖率指标说明</highlight></codeline>
<codeline><highlight class="normal">-<sp/>**行覆盖率**:<sp/>已执行的代码行数占总代码行数的百分比</highlight></codeline>
<codeline><highlight class="normal">-<sp/>**分支覆盖率**:<sp/>已执行的条件分支占总分支数的百分比</highlight></codeline>
<codeline><highlight class="normal">-<sp/>**类覆盖率**:<sp/>已执行的类占总类数的百分比</highlight></codeline>
<codeline><highlight class="normal">-<sp/>**方法覆盖率**:<sp/>已执行的方法占总方法数的百分比</highlight></codeline>
<codeline><highlight class="normal">-<sp/>**指令覆盖率**:<sp/>已执行的字节码指令占总指令数的百分比</highlight></codeline>
<codeline><highlight class="normal">-<sp/>**圈复杂度覆盖率**:<sp/>已执行的独立路径占总独立路径数的百分比</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">##<sp/>🔍<sp/>提高覆盖率的策略</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">1.<sp/>**单元测试优先**:<sp/>为每个类和方法编写单元测试</highlight></codeline>
<codeline><highlight class="normal">2.<sp/>**边界条件测试**:<sp/>测试边界值、空值、异常情况</highlight></codeline>
<codeline><highlight class="normal">3.<sp/>**分支覆盖**:<sp/>确保所有条件分支都被测试</highlight></codeline>
<codeline><highlight class="normal">4.<sp/>**集成测试**:<sp/>测试组件间的交互</highlight></codeline>
<codeline><highlight class="normal">5.<sp/>**参数化测试**:<sp/>使用不同的参数组合测试方法</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">##<sp/>⚠️<sp/>常见问题与解决方案</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">###<sp/>1.<sp/>覆盖率报告为空</highlight></codeline>
<codeline><highlight class="normal">-<sp/>**问题**:<sp/>运行测试后没有生成覆盖率数据</highlight></codeline>
<codeline><highlight class="normal">-<sp/>**解决方案**:<sp/>检查JaCoCo插件配置是否正确，确保测试正常运行</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">###<sp/>2.<sp/>特定类/方法未被覆盖</highlight></codeline>
<codeline><highlight class="normal">-<sp/>**问题**:<sp/>某些类或方法在覆盖率报告中显示为0%覆盖</highlight></codeline>
<codeline><highlight class="normal">-<sp/>**解决方案**:<sp/>检查测试是否正确调用了这些类和方法，可能需要添加额外的测试用例</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">###<sp/>3.<sp/>覆盖率低于阈值</highlight></codeline>
<codeline><highlight class="normal">-<sp/>**问题**:<sp/>运行`mvn<sp/>jacoco:check`时失败，提示覆盖率低于阈值</highlight></codeline>
<codeline><highlight class="normal">-<sp/>**解决方案**:<sp/>查看覆盖率报告，针对未覆盖的代码添加测试用例</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">###<sp/>4.<sp/>测试环境配置问题</highlight></codeline>
<codeline><highlight class="normal">-<sp/>**问题**:<sp/>测试在本地运行正常，但在CI环境中失败</highlight></codeline>
<codeline><highlight class="normal">-<sp/>**解决方案**:<sp/>确保测试环境配置与CI环境一致，特别是数据库和Redis连接配置</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">##<sp/>📝<sp/>测试最佳实践</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">1.<sp/>**测试命名规范**:<sp/>使用清晰的命名，如`testMethodName_Scenario_ExpectedResult`</highlight></codeline>
<codeline><highlight class="normal">2.<sp/>**测试隔离**:<sp/>每个测试方法应独立，不依赖于其他测试方法的状态</highlight></codeline>
<codeline><highlight class="normal">3.<sp/>**模拟依赖**:<sp/>使用Mockito等工具模拟外部依赖</highlight></codeline>
<codeline><highlight class="normal">4.<sp/>**断言精确**:<sp/>使用具体的断言，避免使用过于宽泛的断言</highlight></codeline>
<codeline><highlight class="normal">5.<sp/>**测试可读性**:<sp/>编写清晰、简洁的测试代码，添加适当的注释</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">##<sp/>📊<sp/>覆盖率趋势跟踪</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">建议定期运行覆盖率测试，跟踪覆盖率的变化趋势。可以将覆盖率报告集成到CI/CD流程中，确保覆盖率不会随着代码的更新而下降。</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">##<sp/>📋<sp/>附录:<sp/>覆盖率检查命令</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">```bash</highlight></codeline>
<codeline><highlight class="normal">#<sp/>运行覆盖率检查</highlight></codeline>
<codeline><highlight class="normal">mvn<sp/>jacoco:check</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">#<sp/>生成详细的覆盖率报告</highlight></codeline>
<codeline><highlight class="normal">mvn<sp/>jacoco:report</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">#<sp/>运行测试并生成覆盖率报告</highlight></codeline>
<codeline><highlight class="normal">mvn<sp/>clean<sp/>test<sp/>jacoco:report</highlight></codeline>
<codeline><highlight class="normal">```</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">##<sp/>🚀<sp/>附录:<sp/>示例测试代码</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">```java</highlight></codeline>
<codeline><highlight class="normal">@SpringBootTest</highlight></codeline>
<codeline><highlight class="normal">@ActiveProfiles(&quot;test&quot;)</highlight></codeline>
<codeline><highlight class="normal">class<sp/>WarehouseServiceImplTest<sp/>{</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>@Autowired</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>private<sp/>WarehouseService<sp/>warehouseService;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>@MockBean</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>private<sp/>MaterialRepository<sp/>materialRepository;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>@Test</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>void<sp/>testGetMaterialById()<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>Given</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Long<sp/>materialId<sp/>=<sp/>1L;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Material<sp/>material<sp/>=<sp/>new<sp/>Material();</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>material.setId(materialId);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>material.setName(&quot;Test<sp/>Material&quot;);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>when(materialRepository.findById(materialId)).thenReturn(Optional.of(material));</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>When</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Material<sp/>result<sp/>=<sp/>warehouseService.getMaterialById(materialId);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>Then</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assertNotNull(result);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assertEquals(&quot;Test<sp/>Material&quot;,<sp/>result.getName());</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>verify(materialRepository).findById(materialId);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline><highlight class="normal">```</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">---</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">通过定期运行代码覆盖率测试，可以持续监控和提高代码质量，确保仓库管理子系统的稳定性和可靠性。</highlight></codeline>
    </programlisting>
    <location file="warehouse-service/COVERAGE-README.md"/>
  </compounddef>
</doxygen>
