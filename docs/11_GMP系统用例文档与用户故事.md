# GMP系统用例文档与用户故事

## 1. 质量管理系统（QMS）用例文档

### 1.1 偏差管理用例

#### 用例ID：UC-QMS-001
#### 用例名称：偏差事件记录与处理
#### 参与者：生产操作员、质量工程师、质量经理
#### 前置条件：用户已登录系统并具有相应权限
#### 基本流程：
1. 生产操作员发现偏差并进入偏差管理模块
2. 系统显示偏差记录表单
3. 生产操作员填写偏差事件描述、发生时间、地点等基本信息
4. 生产操作员提交偏差记录
5. 质量工程师接收到偏差通知
6. 质量工程师进行偏差分级和初步调查
7. 质量工程师提交偏差调查结果
8. 质量经理审批偏差调查结果
9. 系统根据调查结果生成CAPA计划
10. 质量经理审批CAPA计划
11. 相关部门执行CAPA计划并定期更新进度
12. 质量部门验证CAPA效果
13. 质量经理确认后关闭偏差

#### 异常流程：
- 如偏差描述不完整，系统提示补充必要信息
- 如偏差分级不合理，质量经理可驳回重新评估
- 如CAPA计划未按时完成，系统自动发送提醒

#### 后置条件：偏差事件状态更新为"已关闭"，相关记录完整保存

### 1.2 CAPA管理用例

#### 用例ID：UC-QMS-002
#### 用例名称：CAPA计划制定与跟踪
#### 参与者：质量工程师、质量经理、责任部门负责人
#### 前置条件：偏差调查已完成并获批
#### 基本流程：
1. 质量工程师基于偏差调查结果制定CAPA计划
2. 系统生成CAPA计划表单
3. 质量工程师填写纠正措施、预防措施、责任人、完成期限
4. 质量工程师提交CAPA计划
5. 质量经理审核CAPA计划
6. 审核通过后，系统向责任人发送任务通知
7. 责任人定期更新CAPA执行进度
8. 系统定期提醒即将到期的CAPA任务
9. CAPA任务完成后，责任人提交完成报告
10. 质量部门验证CAPA效果
11. 质量经理确认后关闭CAPA

#### 异常流程：
- 如CAPA计划不充分，质量经理可要求重新制定
- 如责任人无法按期完成，需提交延期申请并说明原因
- 如验证结果不理想，需重新评估CAPA措施

#### 后置条件：CAPA状态更新为"已关闭"，相关验证记录完整保存

## 2. 生产执行系统（MES）用例文档

### 2.1 生产订单执行用例

#### 用例ID：UC-MES-001
#### 用例名称：生产订单执行与批记录管理
#### 参与者：生产计划员、生产经理、生产操作员、质量审核员
#### 前置条件：生产订单已创建并获批
#### 基本流程：
1. 生产计划员在系统中创建生产订单
2. 生产经理审批生产订单
3. 系统基于生产订单自动生成电子批记录（eBPR）
4. 生产操作员登录系统并选择待执行的生产订单
5. 系统显示当前生产步骤和工艺参数要求
6. 生产操作员确认物料和设备状态
7. 生产操作员开始生产操作
8. 系统自动采集工艺参数数据
9. 生产操作员记录必要的手动操作步骤
10. 每完成一个工序，生产操作员提交工序记录
11. 生产完成后，生产操作员提交完整的批记录
12. 质量审核员审核批记录
13. 审核通过后，系统更新生产订单状态为"已完成"

#### 异常流程：
- 如参数超出允许范围，系统自动报警并要求处理
- 如发现异常事件，生产操作员需记录异常并通知质量部门
- 如批记录审核不通过，需返回修改并重新提交

#### 后置条件：生产订单和批记录归档，相关数据可追溯查询

### 2.2 工艺参数监控用例

#### 用例ID：UC-MES-002
#### 用例名称：工艺参数实时监控与报警
#### 参与者：生产操作员、工艺工程师
#### 前置条件：生产设备已与系统连接，工艺参数阈值已设置
#### 基本流程：
1. 生产开始后，系统自动连接生产设备
2. 系统实时采集工艺参数数据（温度、压力、时间等）
3. 系统显示参数实时值和趋势图
4. 系统将实时值与预设阈值进行比较
5. 如参数在正常范围内，继续监控
6. 如参数超出阈值，系统立即触发报警
7. 生产操作员收到报警通知
8. 生产操作员根据SOP处理异常情况
9. 系统记录报警事件和处理结果
10. 工艺工程师可查看历史报警记录和参数趋势分析

#### 异常流程：
- 如数据采集中断，系统提示连接异常
- 如多次报警未处理，系统升级报警级别并通知管理人员
- 如参数严重偏离，系统可自动触发设备停机（根据设置）

#### 后置条件：所有工艺参数数据和报警记录完整保存，可用于趋势分析和改进

## 3. 实验室信息管理系统（LIMS）用例文档

### 3.1 样品测试用例

#### 用例ID：UC-LIMS-001
#### 用例名称：样品接收与测试流程
#### 参与者：送样人员、实验室管理员、实验室技术员、审核员
#### 前置条件：样品已准备就绪，测试方法已在系统中定义
#### 基本流程：
1. 送样人员提交样品测试申请
2. 实验室管理员接收样品并确认样品信息
3. 实验室管理员在系统中登记样品（生成样品编号、记录样品状态）
4. 实验室管理员分配测试任务给实验室技术员
5. 实验室技术员接收测试任务
6. 实验室技术员准备测试仪器和试剂
7. 实验室技术员执行测试操作
8. 系统自动采集或手动录入测试数据
9. 系统自动计算测试结果并与标准比较
10. 实验室技术员提交测试结果
11. 审核员审核测试结果和原始数据
12. 审核通过后，系统生成测试报告
13. 测试报告发送给相关部门

#### 异常流程：
- 如样品状态异常，实验室管理员可拒收样品
- 如测试数据异常，系统提示重新测试
- 如审核不通过，测试结果需重新提交

#### 后置条件：样品测试完成，测试报告归档，相关数据可追溯

### 3.2 测试结果审核用例

#### 用例ID：UC-LIMS-002
#### 用例名称：测试结果审核与判定
#### 参与者：实验室技术员、审核员、质量负责人
#### 前置条件：测试数据已录入系统并初步计算完成
#### 基本流程：
1. 实验室技术员提交测试结果供审核
2. 审核员在系统中查看测试结果详情
3. 审核员检查原始数据的完整性和准确性
4. 审核员比对测试结果与标准要求
5. 审核员执行数据完整性检查
6. 审核员进行电子签名确认
7. 对于不合格结果，系统自动标记并通知质量负责人
8. 质量负责人对不合格结果进行最终判定
9. 系统根据判定结果更新样品状态
10. 系统生成正式测试报告

#### 异常流程：
- 如发现数据异常，审核员可驳回测试结果
- 如标准不明确，审核员可暂停审核并请求澄清
- 如不合格结果存在争议，可启动偏差调查流程

#### 后置条件：测试结果正式生效，审核记录完整保存

## 4. 电子文档管理系统（EDMS）用例文档

### 4.1 文档创建与审批用例

#### 用例ID：UC-EDMS-001
#### 用例名称：文档创建、审批与发布
#### 参与者：文档创建者、审核员、批准人、文档管理员
#### 前置条件：文档模板已在系统中定义，审批流程已配置
#### 基本流程：
1. 文档创建者登录系统并选择文档模板
2. 文档创建者基于模板创建新文档
3. 文档创建者填写文档内容并保存
4. 文档创建者提交文档进入审批流程
5. 系统自动按照预设流程发送审批任务
6. 审核员审核文档内容和格式
7. 如审核通过，文档流转至批准人
8. 批准人进行最终批准并电子签名
9. 文档状态更新为"已批准"
10. 文档管理员发布文档
11. 系统通知相关人员查看最新文档
12. 系统自动废止旧版文档（如有）

#### 异常流程：
- 如审核不通过，文档返回给创建者修改
- 如需多人同时审核，系统支持并行审批流程
- 如文档内容需要紧急更新，可启动快速审批流程

#### 后置条件：文档成功发布，版本历史完整记录，相关人员已通知

### 4.2 文档检索与访问用例

#### 用例ID：UC-EDMS-002
#### 用例名称：文档检索与受控访问
#### 参与者：系统用户
#### 前置条件：用户已登录系统并具有文档访问权限
#### 基本流程：
1. 用户登录系统并进入文档管理模块
2. 用户通过关键词、文档类型、编号等条件搜索文档
3. 系统显示搜索结果列表
4. 用户选择需要查看的文档
5. 系统验证用户权限
6. 如权限验证通过，系统显示文档内容
7. 用户可查看文档详情、版本历史
8. 用户可下载或打印文档（根据权限设置）
9. 系统记录文档访问日志

#### 异常流程：
- 如用户无权限访问，系统显示权限不足提示
- 如文档已废止，系统显示废止状态并提供最新版本链接
- 如搜索无结果，系统提示无匹配文档

#### 后置条件：用户成功访问所需文档，访问记录完整保存

## 5. 中成药特色功能用例文档

### 5.1 中药材鉴别与质量等级管理用例

#### 用例ID：UC-CHINESE-001
#### 用例名称：中药材鉴别与质量等级评定
#### 参与者：仓库管理员、质量检验员、质量经理
#### 前置条件：中药材已到货，鉴别标准已在系统中设置
#### 基本流程：
1. 仓库管理员接收中药材并在系统中登记基本信息
2. 质量检验员取样并在系统中创建鉴别任务
3. 质量检验员进行性状鉴别并记录特征
4. 质量检验员进行显微鉴别并上传显微照片
5. 质量检验员进行薄层色谱鉴别并上传图谱
6. 质量检验员进行含量测定并记录数据
7. 系统根据预设标准自动评估鉴别结果
8. 质量检验员根据鉴别结果评定质量等级
9. 质量经理审核鉴别结果和等级评定
10. 系统更新中药材批次的鉴别记录和等级信息
11. 仓库管理员根据质量等级进行分类存储

#### 异常流程：
- 如鉴别结果不符合标准，系统自动标记为不合格
- 如需专家复核，可提交给高级检验员进行审核
- 如质量等级存在争议，可启动特殊评审流程

#### 后置条件：中药材鉴别完成，质量等级确定，相关记录完整保存

### 5.2 指纹图谱分析用例

#### 用例ID：UC-CHINESE-002
#### 用例名称：中成药指纹图谱分析与比对
#### 参与者：实验室技术员、质量工程师、质量负责人
#### 前置条件：样品已制备好，标准指纹图谱已在系统中存储
#### 基本流程：
1. 实验室技术员创建指纹图谱分析任务
2. 实验室技术员选择分析方法和参数
3. 实验室技术员执行色谱/光谱分析
4. 系统自动采集指纹图谱原始数据
5. 系统对原始数据进行处理（基线校正、峰匹配等）
6. 系统将样品指纹图谱与标准指纹图谱进行比对
7. 系统计算相似度并生成比对报告
8. 质量工程师审核比对结果
9. 对于相似度不达标样品，系统自动标记并通知质量负责人
10. 质量负责人进行最终判定
11. 系统记录判定结果并更新样品状态

#### 异常流程：
- 如仪器数据采集失败，需重新分析
- 如相似度异常，可执行平行实验验证
- 如标准图谱需要更新，可启动标准更新流程

#### 后置条件：指纹图谱分析完成，比对结果记录完整，可用于质量控制

## 6. 用户故事

### 6.1 质量管理相关用户故事

1. **作为质量经理**，我希望系统能够自动汇总质量事件统计数据，以便我能够及时了解质量趋势并做出决策。

2. **作为质量工程师**，我希望系统能够提供偏差调查模板，以便我能够标准化地记录调查过程和结果。

3. **作为生产操作员**，我希望在发现偏差时能够快速上报并获得处理指导，以便及时控制质量风险。

### 6.2 生产管理相关用户故事

1. **作为生产经理**，我希望能够在一个界面查看所有生产订单的进度和状态，以便合理安排生产资源。

2. **作为生产操作员**，我希望系统能够自动提示下一步操作和工艺参数要求，以便减少操作失误。

3. **作为工艺工程师**，我希望能够查看历史批次的工艺参数趋势，以便优化生产工艺。

### 6.3 实验室管理相关用户故事

1. **作为实验室技术员**，我希望测试数据能够自动计算和判定，以便减少手动计算错误和提高工作效率。

2. **作为实验室管理员**，我希望能够跟踪所有样品的测试进度，以便及时发现和解决延误问题。

3. **作为质量检验员**，我希望系统能够提供标准操作规程(SOP)的在线查询，以便在测试过程中随时参考。

### 6.4 文档管理相关用户故事

1. **作为文件管理员**，我希望能够批量导入和更新文档，以便高效地管理大量文档。

2. **作为文档创建者**，我希望在文档审批过程中能够查看审批意见和修改建议，以便及时调整文档内容。

3. **作为系统用户**，我希望能够通过关键词快速找到所需文档，以便提高工作效率。

### 6.5 中成药特色功能相关用户故事

1. **作为中药材采购员**，我希望系统能够记录和追溯中药材的产地信息，以便确保药材质量和合规性。

2. **作为中药材炮制操作员**，我希望系统能够提供不同药材的炮制工艺参数指导，以便准确执行炮制操作。

3. **作为质量控制主管**，我希望系统能够自动比对中成药指纹图谱并计算相似度，以便客观评价产品质量一致性。

4. **作为研发人员**，我希望能够查询历史批次的多成分含量数据，以便进行处方和工艺优化。

5. **作为GMP审计员**，我希望系统能够提供中药材从种植到使用的完整追溯链，以便满足监管要求。

## 7. 验收标准

### 7.1 质量管理系统验收标准

1. **偏差管理功能验收标准**
   - 系统应支持偏差事件的完整记录、分级、调查、审批和关闭流程
   - 偏差记录应包含所有关键信息（描述、时间、地点、人员等）
   - 系统应能根据偏差等级自动调整审批流程
   - 偏差报告生成功能应准确反映偏差处理全过程
   - 系统应保留所有偏差历史记录，支持多维度查询

2. **CAPA管理功能验收标准**
   - CAPA计划应可与偏差、投诉等质量事件关联
   - 系统应支持CAPA任务的分配、提醒、跟踪和验证
   - 超期未完成的CAPA任务应触发自动提醒
   - CAPA有效性验证结果应可记录和审核
   - 系统应提供CAPA完成率和时效性的统计分析

### 7.2 生产执行系统验收标准

1. **生产订单管理功能验收标准**
   - 系统应支持生产订单的创建、审批、调度和跟踪
   - 生产订单应与产品、工艺、物料、设备等信息关联
   - 系统应提供生产订单状态的实时更新
   - 生产完成后应自动更新库存和相关记录
   - 系统应支持生产订单的查询、统计和报表生成

2. **批记录管理功能验收标准**
   - 系统应能基于生产订单自动生成电子批记录
   - 批记录应包含所有必要的生产信息和工艺参数
   - 系统应支持批记录的在线填写、审核和批准
   - 批记录审核应支持多级审批和电子签名
   - 已批准的批记录应不可随意修改，修改需通过变更控制

### 7.3 实验室信息管理系统验收标准

1. **样品管理功能验收标准**
   - 系统应支持样品的接收、登记、编号和跟踪
   - 样品信息应包含来源、类型、数量、状态等关键数据
   - 系统应支持样品位置管理和存储条件记录
   - 样品测试进度应可实时查询
   - 样品历史记录应完整保存，支持追溯查询

2. **测试结果管理功能验收标准**
   - 系统应支持测试数据的自动采集和手动录入
   - 测试结果应自动计算并与标准进行比较
   - 不合格结果应自动标记并触发相应流程
   - 测试报告应包含所有必要信息并支持自定义格式
   - 系统应保留所有原始测试数据，确保数据完整性

### 7.4 中成药特色功能验收标准

1. **中药材管理特色功能验收标准**
   - 系统应支持中药材的性状、显微、薄层色谱等鉴别方法
   - 中药材质量等级评定应依据预设标准自动或手动进行
   - 产地追溯功能应记录从种植到使用的完整信息链
   - 炮制管理应支持不同炮制方法的参数设置和过程监控
   - 系统应提供中药材质量统计分析和趋势报告

2. **中成药质量控制特色功能验收标准**
   - 指纹图谱分析应支持多种色谱/光谱数据格式
   - 相似度计算算法应符合行业标准要求
   - 系统应支持多成分同时检测和含量计算
   - 传统鉴别方法应能与现代分析方法结果整合
   - 安全性检测数据应能生成符合法规要求的报告

### 7.5 系统集成与性能验收标准

1. **系统集成验收标准**
   - 各子系统之间应实现无缝集成，数据自动流转
   - 系统应支持与外部系统(如ERP、设备系统)的数据交换
   - 接口应符合安全标准，保证数据传输的保密性和完整性
   - 集成点应具备异常处理和恢复机制
   - 系统应提供集成状态监控和日志记录

2. **性能验收标准**
   - 系统应支持至少1000个并发用户的访问
   - 页面加载时间应小于2秒
   - 数据查询响应时间应小于3秒
   - 批量数据处理时间应在可接受范围内
   - 系统应保持99.9%的可用性(计划维护除外)