# GitHub Actions 自动化配置文档

## 配置概述

本仓库配置了GitHub Actions自动化工作流，实现以下功能：

- 当代码推送到main分支时，自动运行Doxygen生成API文档
- 将生成的文档部署到gh-pages分支
- 运行auth-service模块的自动化测试
- 生成并上传代码覆盖率报告

## 工作流程

工作流文件位于：`.github/workflows/build-and-deploy.yml`

主要步骤包括：

1. **检出代码** - 获取最新的代码仓库内容
2. **设置JDK环境** - 配置Java 17开发环境
3. **安装Doxygen** - 用于生成API文档
4. **运行自动化测试** - 执行auth-service模块的测试用例
5. **生成覆盖率报告** - 使用JaCoCo生成代码覆盖率数据
6. **上传测试结果** - 保存测试报告供后续查看
7. **上传覆盖率数据** - 将覆盖率报告上传到Codecov并保存为构建制品
8. **生成Doxygen文档** - 根据Doxyfile配置生成API文档
9. **部署到GitHub Pages** - 将生成的文档发布到gh-pages分支

## 使用说明

### 代码提交规范

提交代码到main分支时，请确保：

- 遵循项目的代码风格和规范
- 确保auth-service模块的测试用例能够通过
- 添加必要的代码注释以生成完整的API文档

### Doxygen文档规范

请在代码中使用以下Doxygen注释格式：

- 类注释：在类定义前使用`/** */`格式添加详细说明
- 方法注释：在方法定义前添加参数说明、返回值说明和功能描述
- 变量注释：为重要的成员变量添加简短说明

### 代码覆盖率要求

- 尽量保持较高的代码覆盖率，特别是核心功能模块
- 为新增功能编写相应的单元测试

## 故障排除

### 常见问题

1. **构建失败**：检查测试是否通过，查看GitHub Actions的构建日志
2. **文档生成不完整**：确保代码中有足够的Doxygen格式注释
3. **覆盖率报告问题**：检查JaCoCo配置是否正确

### 查看报告

- 测试结果和覆盖率报告可在GitHub Actions构建页面的"Artifacts"部分下载
- 生成的API文档可在GitHub Pages页面查看

## 安全注意事项

- 本配置使用GitHub Secrets存储敏感信息（如CODECOV_TOKEN）
- 请不要在代码中硬编码任何敏感信息
- 定期检查和更新依赖版本，确保安全性

## 最佳实践

1. **持续集成**：保持频繁提交，让自动化工作流及早发现问题
2. **代码审查**：在合并PR前进行代码审查，确保质量
3. **文档同步**：代码更改时同步更新相关文档
4. **定期清理**：定期清理不再需要的构建制品和缓存